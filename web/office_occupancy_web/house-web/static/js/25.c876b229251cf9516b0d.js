webpackJsonp([25],{"19WN":function(t,e){},"m+9V":function(t,e,a){"use strict";e.d=function(t,e,a,i){return new s.a(function(s,o){r.a.post(n.f+"/floorDrawing/messageFilesList",{currentPage:t,pageSize:e,buildIdList:a,yardIdList:i}).then(function(t){s(t)},function(t){o(t)})})},e.g=function(t,e,a,i){return new s.a(function(s,o){r.a.post(n.f+"/repairApply/repairFilesList",{currentPage:t,pageSize:e,buildIdList:a,yardIdList:i}).then(function(t){s(t)},function(t){o(t)})})},e.a=function(t,e,a){return new s.a(function(i,s){r.a.post(n.f+"/repairApply/buildRepairApplyList",{buildId:t,startTime:e,endTime:a}).then(function(t){i(t)},function(t){s(t)})})},e.f=function(t){return new s.a(function(e,a){r.a.post(n.f+"/repairApply/repairApplyFiles",{id:t}).then(function(t){e(t)},function(t){a(t)})})},e.e=function(t,e){return new s.a(function(a,i){r.a.post(n.f+"/tree/messageFloorTree",{yardId:t,buildId:e}).then(function(t){a(t)},function(t){i(t)})})},e.c=function(t,e){return new s.a(function(a,i){r.a.post(n.f+"/floorDrawing/floorData",{buildId:t,floorName:e}).then(function(t){a(t)},function(t){i(t)})})},e.b=function(t){return new s.a(function(e,a){r.a.post(n.f+"/repairApply/dbAllFiles",{id:t}).then(function(t){e(t)},function(t){a(t)})})};var i=a("//Fk"),s=a.n(i),r=a("eOoE"),n=a("u3Mf")},rJL5:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("vr0i"),s={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"infoRecord"}},[a("div",{staticClass:"query-box",attrs:{id:"queryBox"}},[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"query-item"},[a("div",{staticClass:"query-title"},[t._v("位置：")]),t._v(" "),a("div",{staticClass:"query-input"},[a("search-tree-select",{attrs:{showSelectTree:t.showSelectTree,inputHeight:"32px",inputWidth:"100%",placeholderText:"请选择位置",isMultipleSelect:!0,checkStrictly:!1,treeName:"recordSearchTree"},on:{"select-tree-checked":t.searchTreeChecked}})],1)]),t._v(" "),a("div",{staticClass:"query-btn"},[a("search-btn",{on:{clickBtn:t.search}}),t._v(" "),a("reset-btn",{on:{clickBtn:t.reset}})],1)])]),t._v(" "),a("div",{staticClass:"table-box"},[a("table-component",{attrs:{tableData:t.tableData,tableHeight:t.tableHeight},on:{select:t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"yardName",label:"院落名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"buildName",label:"楼座名称",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"yardAdministrativeRegion",label:"行政区划",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"unitName",label:"所属产权",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"structureType",label:"结构类型",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"buildDate",label:"建成时间",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{"show-overflow-tooltip":!0,prop:"buildArea",label:"建筑面积(m²)",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("single-btn-group",{attrs:{isShowAlter:!1,isShowDelete:!1,isRecord:!0},on:{recordViewClick:function(a){t.recordView(e.row)}}})]}}])})],1),t._v(" "),a("div",{staticClass:"table-operate-box",attrs:{id:"operateBox"}},[a("div",{staticClass:"operate-pager"},[a("table-pagination",{attrs:{currentPage:t.currentPage,pageSize:t.pageSize,total:t.total},on:{"size-change":t.changeSize,"page-change":t.changePage}})],1)])],1),t._v(" "),a("el-dialog",{attrs:{visible:t.dialogVisible,"close-on-click-modal":!1,width:"1100px",center:!0},on:{"update:visible":function(e){t.dialogVisible=e},closed:t.dialogClosed}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[a("span",[t._v(t._s(t.dialogTitle))])]),t._v(" "),a("div",{staticClass:"dialog-content"},[a("div",{staticClass:"content-left"},[a("div",{staticClass:"content-title"},[a("span",[t._v("信息清单")]),t._v(" "),a("span",{staticClass:"line"})]),t._v(" "),a("div",{staticClass:"tree-box"},[t.showYardTree?a("el-tree",{ref:"tree",attrs:{data:t.treeData,props:t.defaultProps,"current-node-key":t.currentNodeKey,"node-key":"id","highlight-current":"","default-expand-all":""},on:{"node-click":t.handleNodeClick}}):t._e()],1)]),t._v(" "),a("div",{staticClass:"content-right"},[a("div",{staticClass:"base-info-box"},[a("div",{staticClass:"content-title"},[a("span",[t._v("基础信息")]),t._v(" "),a("span",{staticClass:"line"})]),t._v(" "),0===t.showInfoType?a("div",{staticClass:"yard-base-info"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("院落名称：")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.yardForm.yardName,placement:"top-start"}},[a("span",[t._v(t._s(t.yardForm.yardName))])])],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("行政区划：")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.yardForm.yardAdministrativeRegion,placement:"top-start"}},[a("span",[t._v(t._s(t.yardForm.yardAdministrativeRegion))])])],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("院落地址：")]),t._v(" "),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.yardForm.yardPosition,placement:"top-start"}},[a("span",[t._v(t._s(t.yardForm.yardPosition))])])],1)])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("经度(°)：")]),t._v(" "),a("span",[t._v(t._s(t.yardForm.yardLongitude))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("纬度(°)：")]),t._v(" "),a("span",[t._v(t._s(t.yardForm.yardLatitude))])])])],1)],1):t._e(),t._v(" "),1===t.showInfoType?a("div",{staticClass:"build-base-info"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("院落名称：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.yardName))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("楼座名称：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.buildName))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("建筑面积：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.buildArea)+"m²")])])])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("建成时间：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.buildDate))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("地上楼层：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.overgroundFloor)+"层")])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("地下楼层：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.undergroundFloor)+"层")])])])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("结构类型：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.structureType))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("电梯数量：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.elevatorNum)+"台")])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("产权所属单位：")]),t._v(" "),a("span",[t._v(t._s(t.buildForm.propertyUnitName))])])])],1)],1):t._e(),t._v(" "),2===t.showInfoType?a("div",{staticClass:"floor-base-info"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("房间数量：")]),t._v(" "),a("span",[t._v(t._s(t.floorForm.houseNum))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("房间总面积：")]),t._v(" "),a("span",[t._v(t._s(t.floorForm.sumHouseArea)+"m²")])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("使用人数：")]),t._v(" "),a("span",[t._v(t._s(t.floorForm.useNum)+"人")])])])],1),t._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("办公用房数量：")]),t._v(" "),a("span",[t._v(t._s(t.floorForm.officeNum))])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("办公用房面积：")]),t._v(" "),a("span",[t._v(t._s(t.floorForm.officeArea)+"m²")])])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content"},[a("span",[t._v("领导人数：")]),t._v(" "),a("span",[t._v(t._s(t.floorForm.leaderNum)+"人")])])])],1)],1):t._e()]),t._v(" "),1===t.showInfoType||2===t.showInfoType?a("div",{staticClass:"file-downLoad-box"},[a("div",{staticClass:"content-title"},[a("span",[t._v("文件下载")]),t._v(" "),a("span",{staticClass:"line"})]),t._v(" "),0===t.allDownLoadFileList.length?a("div",{staticClass:"file-tips"},[t._v("该"+t._s(t.tipsType)+"暂无信息档案")]):t._e(),t._v(" "),t.allDownLoadFileList.length>0?a("div",{staticClass:"file-downLoad"},[a("el-checkbox-group",{model:{value:t.fileDownLoadCheckedList,callback:function(e){t.fileDownLoadCheckedList=e},expression:"fileDownLoadCheckedList"}},t._l(t.allDownLoadFileList,function(e,i){return a("div",{key:i,staticClass:"file-download-item"},[a("el-checkbox",{attrs:{label:e.floordrawingId}},[t._v(t._s(e.floordrawingFileName))])],1)})),t._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.fileDownLoad}},[t._v("下载")])],1):t._e()]):t._e()])])])],1)},staticRenderFns:[]};var r=function(t){a("19WN")},n=a("VU/8")(i.a,s,!1,r,null,null);e.default=n.exports},vr0i:function(t,e,a){"use strict";(function(t){var i=a("BO1k"),s=a.n(i),r=a("fZjL"),n=a.n(r),o=a("m+9V"),l=a("Oizb"),d=a("os9D"),c=a("yzMb"),u=a("uSev"),p=a("dO4M"),v=a("FAvH"),f=a("GR1E"),h=a("fYBn"),g=a("02tb"),m=a("5kkW"),b=a("3a1n"),y=a("6wPb");e.a={components:{singleBtnGroup:p.a,tableBtnGroup:v.a,tablePagination:f.a,tableComponent:u.a,cancelBtn:h.a,confirmBtn:g.a,searchBtn:m.a,resetBtn:b.a,searchTreeSelect:y.a},data:function(){return{buildIdList:[],yardIdList:[],currentPage:1,pageSize:15,total:0,loading:null,tableHeight:0,selectData:[],tableData:[],dialogTitle:"档案信息",operateType:"add",dialogVisible:!1,options:[],yardForm:{yardAdministrativeRegion:"",yardLatitude:null,yardLongitude:null,yardName:"",yardPosition:""},buildForm:{yardId:"",yardName:"",buildName:"",buildArea:"",buildDate:"",builder:"",overgroundFloor:"",undergroundFloor:"",buildNature:"",coveredArea:"",registerUse:"",structureType:"",elevatorNum:"",propertyUnitId:"",propertyUnitName:""},floorForm:{houseNum:"",sumHouseArea:"",useNum:"",officeNum:"",officeArea:"",leaderNum:""},defaultProps:{children:"children",label:"name"},showInfoType:null,allDownLoadFileList:[],fileDownLoadCheckedList:[],yardOptions:[],unitOptions:[],treeData:[],showYardTree:!1,firstLoad:!0,currentBuildId:null,currentYardId:null,currentNodeKey:null,showSelectTree:!0,tipsType:""}},methods:{loadingStart:function(t){this.loading||(this.loading=this.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",target:t,customClass:"loading-box"}))},loadingEnd:function(){this.loading&&(this.loading.close(),this.loading=null)},changeSize:function(t){this.pageSize=t,this.getList()},changePage:function(t){this.currentPage=t,this.getList()},getList:function(){var t=this;this.loadingStart(".table-box"),Object(o.d)(this.currentPage,this.pageSize,this.buildIdList,this.yardIdList).then(function(e){t.tableData=e.records,t.tableData.forEach(function(e){e.yardName=e.yardName?e.yardName:"-",e.buildName=e.buildName?e.buildName:"-",e.yardAdministrativeRegion=e.yardAdministrativeRegion?e.yardAdministrativeRegion:"-",e.unitName=e.unitName?e.unitName:"-",e.structureType=e.structureType?e.structureType:"-",e.buildArea=e.buildArea?e.buildArea:"-",e.buildDate=e.buildDate?t.formatDate(e.buildDate):"-"}),t.total=e.total,t.loadingEnd()}).catch(function(e){t.loadingEnd();var a=e.result?e.result:"信息档案信息获取失败";t.$message({message:a,type:"error"})})},search:function(){this.currentPage=1,this.getList()},reset:function(){var t=this;this.buildIdList=[],this.yardIdList=[],this.currentPage=1,this.showSelectTree=!1,c.a.$emit("clearRecordPosition"),setTimeout(function(){t.showSelectTree=!0},1e3),this.getList()},getYardDic:function(){var t=this;Object(l.d)(1).then(function(e){t.yardOptions=e}).catch(function(e){var a=e.result?e.result:"院落获取失败";t.$message({message:a,type:"error"})})},getUnitDic:function(){var t=this;Object(l.c)().then(function(e){t.unitOptions=e}).catch(function(e){var a=e.result?e.result:"单位获取失败";t.$message({message:a,type:"error"})})},handleSelectionChange:function(t){this.selectData=t},recordView:function(t){var e=this;this.dialogVisible=!0,this.showYardTree=!0,this.currentBuildId=t.buildId,this.currentYardId=t.yardId,this.currentNodeKey=t.yardId+":"+t.buildId,Object(o.e)(t.yardId,t.buildId).then(function(t){e.treeData=t,e.$nextTick(function(){var t=e.$refs.tree.getNode(e.currentNodeKey);e.showInfoType=t.data.type,1===e.showInfoType?e.tipsType="楼座":2===e.showInfoType&&(e.tipsType="楼层"),Object(d.m)(t.data.value).then(function(t){if(t){for(var a in e.buildForm)e.buildForm[a]=t[a];e.buildForm.buildDate=e.formatDate(e.buildForm.buildDate);for(var i=0;i<e.yardOptions.length;i++)if(e.yardOptions[i].yardId===e.buildForm.yardId){e.buildForm.yardName=e.yardOptions[i].yardName;break}for(var s=0;s<e.unitOptions.length;s++)if(e.unitOptions[s].unitId===e.buildForm.propertyUnitId){e.buildForm.propertyUnitName=e.unitOptions[s].unitName;break}}}).catch(function(t){var a=t.result?t.result:"楼座详情获取失败";e.$message({message:a,type:"error"})}),Object(d.E)(t.data.value).then(function(t){t&&t.length>0?e.allDownLoadFileList=t:e.allDownLoadFileList=[]}).catch(function(t){e.allDownLoadFileList=[];var a=t.result?t.result:"CAD获取失败";e.$message({message:a,type:"error"})})})}).catch(function(t){var a=t.result?t.result:"树获取失败";e.$message({message:a,type:"error"})})},searchTreeChecked:function(t){var e=this;this.yardIdList=[],this.buildIdList=[],t&&t.length>0&&t.forEach(function(t){1===t.type?e.yardIdList.push(t.value):2===t.type&&e.buildIdList.push(t.value)})},renderContent:function(t,e){e.node;var a=e.data;e.store;return 1===a.type?t("span",{class:"custom-tree-node"},[t("span",{class:"iconfont"},[""]),t("span",{class:"show-ellipsis"},[a.text])]):2===a.type?t("span",{class:"custom-tree-node"},[t("span",{class:"iconfont"},[""]),t("span",{class:"show-ellipsis"},[a.text])]):t("span",{class:"custom-tree-node"},[t("span",{class:"show-ellipsis"},[a.text])])},handleNodeClick:function(t,e){var a=this;this.showInfoType=t.type,this.fileDownLoadCheckedList=[],0===t.type?(this.clearForm(this.yardForm),Object(d.A)(t.value).then(function(t){if(t)for(var e in a.yardForm)a.yardForm[e]=t[e]}).catch(function(t){var e=t.result?t.result:"楼座详情获取失败";a.$message({message:e,type:"error"})})):1===t.type?(this.tipsType="楼座",this.clearForm(this.buildForm),Object(d.m)(t.value).then(function(t){if(t){for(var e in a.buildForm)a.buildForm[e]=t[e];a.buildForm.buildDate=a.formatDate(a.buildForm.buildDate);for(var i=0;i<a.yardOptions.length;i++)if(a.yardOptions[i].yardId===a.buildForm.yardId){a.buildForm.yardName=a.yardOptions[i].yardName;break}for(var s=0;s<a.unitOptions.length;s++)if(a.unitOptions[s].unitId===a.buildForm.propertyUnitId){a.buildForm.propertyUnitName=a.unitOptions[s].unitName;break}}}).catch(function(t){var e=t.result?t.result:"楼座详情获取失败";a.$message({message:e,type:"error"})}),Object(d.E)(t.value).then(function(t){t&&t.length>0?a.allDownLoadFileList=t:a.allDownLoadFileList=[]}).catch(function(t){a.allDownLoadFileList=[];var e=t.result?t.result:"CAD获取失败";a.$message({message:e,type:"error"})})):2===t.type&&(this.tipsType="楼层",this.clearForm(this.floorForm),Object(o.c)(this.currentBuildId,t.value).then(function(t){if(t)for(var e in a.floorForm)t[e]?a.floorForm[e]=t[e]:a.floorForm[e]=0}).catch(function(t){var e=t.result?t.result:"楼座详情获取失败";a.$message({message:e,type:"error"})}),Object(d.E)(this.currentBuildId,t.value).then(function(t){t&&t.length>0?a.allDownLoadFileList=t:a.allDownLoadFileList=[]}).catch(function(t){a.allDownLoadFileList=[];var e=t.result?t.result:"CAD获取失败";a.$message({message:e,type:"error"})}))},fileDownLoad:function(){var t=this;if(0===this.fileDownLoadCheckedList.length)return this.$message({message:"请先选中一个文件",type:"warning"}),!1;var e={};e.floorDrawingIdList=this.fileDownLoadCheckedList,e.buildId=this.currentBuildId,Object(d.k)(e).then(function(t){a("3UNf")(t,decodeURIComponent(sessionStorage.getItem("CADdownloadFileName")))}).catch(function(e){var a=e.result?e.result:"CAD下载失败";t.$message({message:a,type:"error"})})},clearForm:function(t){for(var e in t){var a=this.getDataType(t[e]);if("String"===a)t[e]="";else if("Array"===a)t[e]=[];else if("Object"===a){n()(t[e]).length>0?this.clearForm(t[e]):t[e]={}}else t[e]=null}},dialogClosed:function(){this.showYardTree=!1,this.firstLoad=!0,this.showInfoType=null,this.currentBuildId=null,this.allDownLoadFileList=[],this.fileDownLoadCheckedList=[],this.treeData=null,this.currentNodeKey=null,this.clearForm(this.buildForm),this.clearForm(this.floorForm)},getDataType:function(t){var e=!0,a=!1,i=void 0;try{for(var r,n=s()(["String","Object","Number","Array","Function"]);!(e=(r=n.next()).done);e=!0){var o=r.value;if(Object.prototype.toString.call(t)==="[object "+o+"]")return o}}catch(t){a=!0,i=t}finally{try{!e&&n.return&&n.return()}finally{if(a)throw i}}},limitFloat:function(t,e){this.Form[t]=this.Form[t].replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,""),e&&""!==this.Form[t]&&(this.Form[t]=(this.Form[t]-0).toFixed(2))},formatDate:function(t,e){var a=new Date(t),i=e||"yyyy-MM-dd",s={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};for(var r in/(y+)/.test(i)&&(i=i.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length))),s)new RegExp("("+r+")").test(i)&&(i=i.replace(RegExp.$1,1==RegExp.$1.length?s[r]:("00"+s[r]).substr((""+s[r]).length)));return i}},mounted:function(){var e=this;this.getList(),this.getYardDic(),this.getUnitDic(),setTimeout(function(){var a=t("#mainDiv").height(),i=t("#queryBox").outerHeight(!0),s=t("#operateBox").height();e.tableHeight=a-i-s},1)}}}).call(e,a("7t+N"))}});
//# sourceMappingURL=25.c876b229251cf9516b0d.js.map