webpackJsonp([33],{"7/WI":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("ypwu"),r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"user"}},[a("div",{staticClass:"query-box",attrs:{id:"queryBox"}},[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"query-item"},[a("div",{staticClass:"query-title"},[e._v("用户姓名：")]),e._v(" "),a("div",{staticClass:"query-input"},[a("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],attrs:{placeholder:"请输入用户姓名"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1)]),e._v(" "),a("div",{staticClass:"query-item",staticStyle:{"margin-left":"50px"}},[a("div",{staticClass:"query-title"},[e._v("登录名：")]),e._v(" "),a("div",{staticClass:"query-input"},[a("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],attrs:{placeholder:"请输入登录名"},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1)]),e._v(" "),a("div",{staticClass:"query-btn"},[a("search-btn",{on:{clickBtn:e.search}}),e._v(" "),a("reset-btn",{on:{clickBtn:e.reset}})],1)])]),e._v(" "),a("div",{staticClass:"table-box"},[a("table-component",{attrs:{tableData:e.tableData,tableHeight:e.tableHeight},on:{select:e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"用户姓名",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"登录名",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"sexName",label:"性别",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"FreezeStatus",label:"是否冻结",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("single-btn-group",{attrs:{isShowDetail:!0},on:{deleteClick:function(a){e.singleDetle(t.row)},updateClick:function(a){e.singleUpdate(t.row)},detailClick:function(a){e.singleDetail(t.row)}}})]}}])})],1),e._v(" "),a("div",{staticClass:"table-operate-box",attrs:{id:"operateBox"}},[a("div",{staticClass:"operate-btn"},[a("table-btn-group",{on:{batchDeleteClick:e.batchDelete,addClick:e.add}})],1),e._v(" "),a("div",{staticClass:"operate-pager"},[a("table-pagination",{attrs:{currentPage:e.currentPage,pageSize:e.pageSize,total:e.total},on:{"size-change":e.changeSize,"page-change":e.changePage}})],1)])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,width:"780px",center:!0},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.dialogClosed,open:e.dialogOpen}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[a("span",[e._v(e._s(e.dialogTitle))])]),e._v(" "),a("el-form",{ref:"Form",attrs:{inline:!0,model:e.Form,rules:e.rules}},[a("el-form-item",{attrs:{label:"detail"===e.operateType?"用户姓名:":"用户姓名","label-width":"120px",prop:"name"}},["detail"!==e.operateType?a("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],attrs:{placeholder:"请输入用户姓名"},model:{value:e.Form.name,callback:function(t){e.$set(e.Form,"name",t)},expression:"Form.name"}}):e._e(),e._v(" "),"detail"===e.operateType?a("span",[e._v(e._s(e.Form.name))]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"detail"===e.operateType?"登录名:":"登录名","label-width":"120px",prop:"username"}},["detail"!==e.operateType?a("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],attrs:{placeholder:"请输入登录名"},model:{value:e.Form.username,callback:function(t){e.$set(e.Form,"username",t)},expression:"Form.username"}}):e._e(),e._v(" "),"detail"===e.operateType?a("span",[e._v(e._s(e.Form.username))]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"detail"===e.operateType?"手机号:":"手机号","label-width":"120px",prop:"phoneNum"}},["detail"!==e.operateType?a("el-input",{attrs:{placeholder:"手机号"},on:{blur:function(t){e.limitInt("phoneNum")}},nativeOn:{keyup:function(t){e.limitInt("phoneNum")}},model:{value:e.Form.phoneNum,callback:function(t){e.$set(e.Form,"phoneNum",t)},expression:"Form.phoneNum"}}):e._e(),e._v(" "),"detail"===e.operateType?a("span",[e._v(e._s(e.Form.phoneNum))]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"detail"===e.operateType?"性别:":"性别","label-width":"120px",prop:"sex"}},["detail"!==e.operateType?a("el-radio",{attrs:{label:0,name:"sex"},model:{value:e.Form.sex,callback:function(t){e.$set(e.Form,"sex",t)},expression:"Form.sex"}},[e._v("男")]):e._e(),e._v(" "),"detail"!==e.operateType?a("el-radio",{attrs:{label:1,name:"sex"},model:{value:e.Form.sex,callback:function(t){e.$set(e.Form,"sex",t)},expression:"Form.sex"}},[e._v("女")]):e._e(),e._v(" "),"detail"===e.operateType?a("span",[e._v(e._s(0===e.Form.sex?"男":"女"))]):e._e()],1),e._v(" "),a("el-form-item",{attrs:{label:"detail"===e.operateType?"是否冻结:":"是否冻结","label-width":"120px",prop:"isFreeze"}},["detail"!==e.operateType?a("el-radio",{attrs:{label:1,name:"isFreeze"},model:{value:e.Form.isFreeze,callback:function(t){e.$set(e.Form,"isFreeze",t)},expression:"Form.isFreeze"}},[e._v("是")]):e._e(),e._v(" "),"detail"!==e.operateType?a("el-radio",{attrs:{label:0,name:"isFreeze"},model:{value:e.Form.isFreeze,callback:function(t){e.$set(e.Form,"isFreeze",t)},expression:"Form.isFreeze"}},[e._v("否")]):e._e(),e._v(" "),"detail"===e.operateType?a("span",[e._v(e._s(1===e.Form.isFreeze?"冻结":"非冻结"))]):e._e()],1),e._v(" "),a("el-form-item",{staticClass:"longer",attrs:{label:"detail"===e.operateType?"所属单位:":"所属单位","label-width":"120px",prop:"unitId"}},["detail"!==e.operateType?a("el-select",{staticStyle:{width:"535px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:e.Form.unitId,callback:function(t){e.$set(e.Form,"unitId",t)},expression:"Form.unitId"}},e._l(e.unitOpts,function(e){return a("el-option",{key:e.unitId,attrs:{label:e.unitName,value:e.unitId}})})):e._e(),e._v(" "),"detail"===e.operateType?a("span",{staticStyle:{display:"block",width:"100%"}},[e._v(e._s(e.unitSeletedVal))]):e._e()],1),e._v(" "),a("el-form-item",{staticClass:"longer",attrs:{label:"detail"===e.operateType?"用户角色:":"用户角色","label-width":"120px",prop:"roleIdList"}},["detail"!==e.operateType?a("el-select",{staticStyle:{width:"535px"},attrs:{multiple:"",filterable:"",placeholder:"请选择"},model:{value:e.Form.roleIdList,callback:function(t){e.$set(e.Form,"roleIdList",t)},expression:"Form.roleIdList"}},e._l(e.roleOptions,function(e){return a("el-option",{key:e.roleId,attrs:{label:e.roleName,value:e.roleId}})})):e._e(),e._v(" "),"detail"===e.operateType?a("span",{staticStyle:{display:"block",width:"100%"}},[e._v(e._s(e.roleIdListVal))]):e._e()],1),e._v(" "),e.showRepair?a("el-form-item",{staticClass:"longer",attrs:{label:"detail"===e.operateType?"维修流程:":"维修流程","label-width":"120px"}},["detail"!==e.operateType?a("el-select",{staticStyle:{width:"535px"},attrs:{multiple:"",filterable:"",placeholder:"请选择"},model:{value:e.Form.repairIdList,callback:function(t){e.$set(e.Form,"repairIdList",t)},expression:"Form.repairIdList"}},e._l(e.repairOpts,function(e){return a("el-option",{key:e.value,attrs:{label:e.key,value:e.value}})})):e._e(),e._v(" "),"detail"===e.operateType?a("span",{staticStyle:{display:"block",width:"100%"}},[e._v(e._s(e.repairSeletedVal))]):e._e()],1):e._e(),e._v(" "),e.showDispose?a("el-form-item",{staticClass:"longer",attrs:{label:"detail"===e.operateType?"处置流程:":"处置流程","label-width":"120px"}},["detail"!==e.operateType?a("el-select",{staticStyle:{width:"535px"},attrs:{multiple:"",filterable:"",placeholder:"请选择"},model:{value:e.Form.handleIdList,callback:function(t){e.$set(e.Form,"handleIdList",t)},expression:"Form.handleIdList"}},e._l(e.handleOpts,function(e){return a("el-option",{key:e.value,attrs:{label:e.key,value:e.value}})})):e._e(),e._v(" "),"detail"===e.operateType?a("span",{staticStyle:{display:"block",width:"100%"}},[e._v(e._s(e.handleSeletedVal))]):e._e()],1):e._e(),e._v(" "),e.showConfig?a("el-form-item",{staticClass:"longer",attrs:{label:"detail"===e.operateType?"配置流程:":"配置流程","label-width":"120px"}},["detail"!==e.operateType?a("el-select",{staticStyle:{width:"535px"},attrs:{multiple:"",filterable:"",placeholder:"请选择"},model:{value:e.Form.configIdList,callback:function(t){e.$set(e.Form,"configIdList",t)},expression:"Form.configIdList"}},e._l(e.configOpts,function(e){return a("el-option",{key:e.value,attrs:{label:e.key,value:e.value}})})):e._e(),e._v(" "),"detail"===e.operateType?a("span",{staticStyle:{display:"block",width:"100%"}},[e._v(e._s(e.configSeletedVal))]):e._e()],1):e._e()],1),e._v(" "),"detail"!==e.operateType?a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("cancel-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.dialogVisible=!1}}}),e._v(" "),a("confirm-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.submitForm("Form")}}})],1):e._e()],1)],1)},staticRenderFns:[]};var s=function(e){a("boI3")},o=a("VU/8")(i.a,r,!1,s,null,null);t.default=o.exports},boI3:function(e,t){},ypwu:function(e,t,a){"use strict";(function(e){var i=a("BO1k"),r=a.n(i),s=a("fZjL"),o=a.n(s),l=a("mvHQ"),n=a.n(l),c=a("4YAr"),d=a("Oizb"),u=(a("yzMb"),a("uSev")),p=a("dO4M"),m=a("FAvH"),h=a("GR1E"),g=a("fYBn"),f=a("02tb"),v=a("5kkW"),b=a("3a1n");t.a={components:{singleBtnGroup:p.a,tableBtnGroup:m.a,tablePagination:h.a,tableComponent:u.a,cancelBtn:g.a,confirmBtn:f.a,searchBtn:v.a,resetBtn:b.a},data:function(){var e=this;return{name:"",username:"",currentPage:1,pageSize:15,total:0,loading:null,tableHeight:0,selectData:[],tableData:[],dialogTitle:"",operateType:"add",dialogVisible:!1,roleOptions:[],repairOpts:[],handleOpts:[],configOpts:[],unitOpts:[],oldRepairIdList:[],oldRoleIdList:[],oldHanleList:[],oldConfigList:[],unitSeletedVal:"",roleIdListVal:"",repairSeletedVal:"暂无",handleSeletedVal:"暂无",configSeletedVal:"暂无",showRepair:!1,showDispose:!1,showConfig:!1,Form:{userId:"",name:"",username:"",password:"",sex:0,isFreeze:0,unitId:"",roleIdList:[],repairIdList:[],handleIdList:[],configIdList:[],phoneNum:""},rules:{username:[{required:!0,validator:function(t,a,i){""===a||null===a?i(new Error("登录名不能为空")):/^[\u4e00-\u9fa5]+$/.test(a)?i(new Error("登录名只能是英文，数字或符号")):Object(c.J)(e.Form.username,e.Form.userId).then(function(e){i()}).catch(function(e){i(new Error("登录名不能重复"))})},trigger:"blur"}],name:[{required:!0,message:"用户姓名不能为空",trigger:"blur"}],sex:[{required:!0,message:"请选择性别",trigger:"change"}],isFreeze:[{required:!0,message:"请选择是否冻结",trigger:"change"}],unitId:[{required:!0,message:"请选择所属单位",trigger:"change"}],roleIdList:[{required:!0,message:"请选择用户角色",trigger:"change"}],phoneNum:[{required:!0,validator:function(t,a,i){""===a||null===a?i(new Error("手机号不能为空")):/^1[3456789]\d{9}$/.test(a)?Object(c.E)(a,e.Form.userId).then(function(e){i()}).catch(function(e){i(new Error("手机号不能重复"))}):i(new Error("手机号有误"))},trigger:"blur"}]}}},methods:{loadingStart:function(e){this.loading||(this.loading=this.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",target:e,customClass:"loading-box"}))},loadingEnd:function(){this.loading&&(this.loading.close(),this.loading=null)},changeSize:function(e){this.pageSize=e,this.getList()},changePage:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this;this.loadingStart(".table-box"),Object(c.y)(this.currentPage,this.pageSize,this.name,this.username).then(function(t){e.tableData=t.records,e.total=t.total,e.tableData.forEach(function(e){0===e.isFreeze?e.FreezeStatus="非冻结":e.FreezeStatus="冻结",0===e.sex?e.sexName="男":e.sexName="女"}),e.loadingEnd()}).catch(function(t){var a=t.result?t.result:"角色信息获取失败";e.$message({message:a,type:"error"}),e.loadingEnd()})},search:function(){this.currentPage=1,this.getList()},reset:function(){this.currentPage=1,this.name="",this.username="",this.search()},add:function(){this.dialogVisible=!0,this.dialogTitle="新增用户信息",this.operateType="add",this.Form.password="123456"},singleDetle:function(e){var t=this;this.$confirm("此操作将永久删除用户"+e.name+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(c.j)(parseInt(e.userId)).then(function(e){t.$message({message:"删除用户信息成功!",type:"success"}),t.currentPage=1,t.getList()}).catch(function(e){var a=e.result?e.result:"删除用户信息失败";t.$message({message:a,type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},batchDelete:function(){var e=this,t=[];this.selectData.forEach(function(e,a){t.push(e.userId)}),this.$confirm("此操作将永久删除这些用户信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(0===t.length)return e.$message({message:"请先勾选删除项！",type:"warning"}),!1;Object(c.e)(t).then(function(t){e.$message({message:"批量删除用户信息成功!",type:"success"}),e.currentPage=1,e.getList()}).catch(function(t){var a=t.result?t.result:"批量删除用户信息失败";e.$message({message:a,type:"error"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},singleUpdate:function(e){var t=this;this.dialogVisible=!0,this.dialogTitle="修改用户信息",this.operateType="edit",Object(c.n)(e.userId).then(function(e){t.Form.userId=e.user.userId,t.Form.isFreeze=e.user.isFreeze,t.Form.name=e.user.name,t.Form.sex=e.user.sex,t.Form.username=e.user.username,t.Form.unitId=e.user.unitId,t.Form.phoneNum=e.user.phoneNum,t.Form.repairIdList=e.repairIdList||[],t.Form.handleIdList=e.handleIdList||[],t.Form.configIdList=e.configIdList||[],e.roleList&&e.roleList.length>0&&e.roleList.forEach(function(e){t.Form.roleIdList.push(e.roleId)}),t.oldRepairIdList=JSON.parse(n()(t.Form.repairIdList))||[],t.oldHanleList=JSON.parse(n()(t.Form.handleIdList))||[],t.oldConfigList=JSON.parse(n()(t.Form.configIdList))||[],t.oldRoleIdList=t.Form.roleIdList}).catch(function(e){var a=e.result?e.result:"用户信息获取失败";t.$message({message:a,type:"error"})})},singleDetail:function(e){var t=this;this.dialogVisible=!0,this.dialogTitle="用户详情",this.operateType="detail";var a=[],i=[],r=[],s=[];Object(c.n)(e.userId).then(function(e){t.Form.userId=e.user.userId,t.Form.isFreeze=e.user.isFreeze,t.Form.name=e.user.name,t.Form.sex=e.user.sex,t.Form.username=e.user.username,t.Form.userRoleIdList=e.userRoleIdList,t.Form.phoneNum=e.user.phoneNum,e.roleList.forEach(function(e){i.push(e.roleName)}),t.roleIdListVal=i.join("、"),e.repairIdList&&e.repairIdList.length>0&&(e.repairIdList.forEach(function(e){t.repairOpts.forEach(function(t){t.value===e&&a.push(t.key)})}),t.repairSeletedVal=a.join("、")),e.handleIdList&&e.handleIdList.length>0&&(e.handleIdList.forEach(function(e){t.handleOpts.forEach(function(t){t.value===e&&r.push(t.key)})}),t.handleSeletedVal=r.join("、")),e.configIdList&&e.configIdList.length>0&&(e.configIdList.forEach(function(e){t.configOpts.forEach(function(t){t.value===e&&s.push(t.key)})}),t.configSeletedVal=s.join("、")),t.unitOpts.forEach(function(a){a.unitId===e.user.unitId&&(t.unitSeletedVal=a.unitName)})}).catch(function(e){var a=e.result?e.result:"用户详情获取失败";t.$message({message:a,type:"error"})})},handleSelectionChange:function(e){this.selectData=e},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;"edit"===t.operateType?(t.Form.deleteRepairRight=[],t.Form.addRepairRight=[],t.Form.deleteRoleRight=[],t.Form.addRoleRight=[],t.Form.addHandleRight=[],t.Form.deleteHandleRight=[],t.Form.addConfigRight=[],t.Form.deleteConfigRight=[],t.oldRepairIdList.forEach(function(e){-1===t.Form.repairIdList.indexOf(e)&&t.Form.deleteRepairRight.push(e)}),t.Form.repairIdList.forEach(function(e){-1===t.oldRepairIdList.indexOf(e)&&t.Form.addRepairRight.push(e)}),t.oldHanleList.forEach(function(e){-1===t.Form.handleIdList.indexOf(e)&&t.Form.deleteHandleRight.push(e)}),t.Form.handleIdList.forEach(function(e){-1===t.oldHanleList.indexOf(e)&&t.Form.addHandleRight.push(e)}),t.oldConfigList.forEach(function(e){-1===t.Form.configIdList.indexOf(e)&&t.Form.deleteConfigRight.push(e)}),t.Form.configIdList.forEach(function(e){-1===t.oldConfigList.indexOf(e)&&t.Form.addConfigRight.push(e)}),t.oldRoleIdList.forEach(function(e){-1===t.Form.roleIdList.indexOf(e)&&t.Form.deleteRoleRight.push(e)}),t.Form.roleIdList.forEach(function(e){-1===t.oldRoleIdList.indexOf(e)&&t.Form.addRoleRight.push(e)}),delete t.Form.password):"add"===t.operateType&&(t.Form.addRepairRight=t.Form.repairIdList,t.Form.addRoleRight=t.Form.roleIdList,t.Form.addHandleRight=t.Form.handleIdList),"add"===t.operateType?Object(c.d)(t.Form).then(function(e){t.$message({message:"新增用户成功",type:"success"}),t.dialogVisible=!1,t.getList()}).catch(function(e){var a=e.result?e.result:"新增用户失败";t.$message({message:a,type:"error"})}):Object(c.I)(t.Form).then(function(e){t.$message({message:"修改用户成功",type:"success"}),t.Form.password="",t.dialogVisible=!1,t.getList()}).catch(function(e){var a=e.result?e.result:"修改用户失败";t.$message({message:a,type:"error"}),t.Form.password=""})})},clearForm:function(e){for(var t in e){var a=this.getDataType(e[t]);if("String"===a)e[t]="";else if("Array"===a)e[t]=[];else if("Object"===a){o()(e[t]).length>0?this.clearForm(e[t]):e[t]={}}else e[t]=null}},dialogOpen:function(){var e=this;this.$nextTick(function(){e.$refs.Form.clearValidate()})},dialogClosed:function(){this.clearForm(this.Form),this.Form.sex=0,this.Form.isFreeze=0,this.oldRepairIdList=[],this.oldRoleIdList=[],this.oldHanleList=[],this.oldConfigList=[],this.repairSeletedVal="暂无",this.handleSeletedVal="暂无",this.configSeletedVal="暂无"},limitInt:function(e){this.Form[e]=this.Form[e].replace(/[^0-9]/g,"")},getDataType:function(e){var t=!0,a=!1,i=void 0;try{for(var s,o=r()(["String","Object","Number","Array","Function"]);!(t=(s=o.next()).done);t=!0){var l=s.value;if(Object.prototype.toString.call(e)==="[object "+l+"]")return l}}catch(e){a=!0,i=e}finally{try{!t&&o.return&&o.return()}finally{if(a)throw i}}}},mounted:function(){var t=this;this.getList(),setTimeout(function(){var a=e("#mainDiv").height(),i=e("#queryBox").outerHeight(!0),r=e("#operateBox").height();t.tableHeight=a-i-r},1),Object(c.u)().then(function(e){t.repairOpts=e}).catch(function(e){var a=e.result?e.result:"维修流程下拉选项获取失败";t.$message({message:a,type:"error"})}),Object(c.w)().then(function(e){t.roleOptions=e}).catch(function(e){var a=e.result?e.result:"用户角色下拉选项获取失败";t.$message({message:a,type:"error"})}),Object(c.z)().then(function(e){t.handleOpts=e}).catch(function(e){var a=e.result?e.result:"处置流程下拉选项获取失败";t.$message({message:a,type:"error"})}),Object(c.o)().then(function(e){t.configOpts=e}).catch(function(e){var a=e.result?e.result:"配置流程下拉选项获取失败";t.$message({message:a,type:"error"})}),Object(d.c)().then(function(e){t.unitOpts=e}).catch(function(e){var a=e.result?e.result:"所属单位下拉选项获取失败";t.$message({message:a,type:"error"})}),Object(d.i)().then(function(e){for(var a=0;a<e.length;a++){var i=e[a].key;e[a].children;"repairManagement"===i&&(t.showRepair=!0),"disposeManagement"===i&&(t.showDispose=!0),"configManagement"===i&&(t.showConfig=!0)}}).catch(function(e){var a=e.result?e.result:"路由信息获取失败！";t.$message({message:a,type:"error"})})}}}).call(t,a("7t+N"))}});
//# sourceMappingURL=33.ad092fd0b81dbab879b8.js.map