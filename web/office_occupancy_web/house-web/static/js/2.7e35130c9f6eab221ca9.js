webpackJsonp([2],{"/sA3":function(e,t,i){"use strict";i.d(t,"a",function(){return s});const s={wheel(e){if(!e.target)return;let t=e.callback||function(){},i=e.target,s=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel";document.attachEvent?document.attachEvent("on"+s,function(e){e.target.parentElement==i&&t(e,e.wheelDelta)}):document.addEventListener(s,function(e){e=e||window.event,t(e)})}}},"0Xel":function(e,t,i){e.exports=i.p+"static/img/door_susan3.d693900.jpg"},"0oGA":function(e,t,i){var s={"./door-bottom-canvas.svg":"4rPh","./door-left-canvas.svg":"M7Mp","./door-right-canvas.svg":"HbZC","./door-top-canvas.svg":"iPHX"};function o(e){return i(a(e))}function a(e){var t=s[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}o.keys=function(){return Object.keys(s)},o.resolve=a,e.exports=o,o.id="0oGA"},"26Lr":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNTkgNjAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDU5IDYwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1taXRlcmxpbWl0OjEwO30NCjwvc3R5bGU+DQo8Zz4NCgk8cG9seWdvbiBjbGFzcz0ic3QwIiBwb2ludHM9IjE3LDExIDguNywxMSA4LjcsNy40IDQuOCw3LjQgNC44LDU1LjkgNTUuMiw1NS45IDU1LjIsNy40IDUxLjMsNy40IDUxLjMsMTEgNTAuMiwxMSA1MC4yLDE0LjIgDQoJCTUxLjUsMTQuMiA1MS41LDUxLjggOC43LDUxLjggOC43LDE0LjcgMTcsMTQuNyAJIi8+DQoJPHJlY3QgeD0iMzQuOSIgeT0iMTEiIGNsYXNzPSJzdDAiIHdpZHRoPSI5LjkiIGhlaWdodD0iMy42Ii8+DQoJPHJlY3QgeD0iNDUiIHk9IjExLjIiIGNsYXNzPSJzdDAiIHdpZHRoPSI1LjIiIGhlaWdodD0iMy40Ii8+DQoJPHJlY3QgeD0iMTEuOCIgeT0iMTYuOCIgY2xhc3M9InN0MCIgd2lkdGg9IjI4IiBoZWlnaHQ9IjI3LjIiLz4NCgk8bGluZSBjbGFzcz0ic3QwIiB4MT0iMTciIHkxPSIxMi42IiB4Mj0iNTIuOCIgeTI9IjEyLjYiLz4NCgk8bGluZSBjbGFzcz0ic3QwIiB4MT0iMTIuNiIgeTE9IjE3LjMiIHgyPSIzOC44IiB5Mj0iNDMuNSIvPg0KCTxsaW5lIGNsYXNzPSJzdDAiIHgxPSIzOS4zIiB5MT0iMTcuMyIgeDI9IjEzLjEiIHkyPSI0My41Ii8+DQoJPHJlY3QgeD0iMTcuNSIgeT0iNDYuNiIgY2xhc3M9InN0MCIgd2lkdGg9IjE3LjYiIGhlaWdodD0iMi45Ii8+DQoJPGxpbmUgY2xhc3M9InN0MCIgeDE9IjI3LjkiIHkxPSI1NS45IiB4Mj0iMjcuOSIgeTI9IjU4Ii8+DQoJPGxpbmUgY2xhc3M9InN0MCIgeDE9IjMyLjMiIHkxPSI1NS45IiB4Mj0iMzIuMyIgeTI9IjU4Ii8+DQoJPGxpbmUgY2xhc3M9InN0MCIgeDE9IjQyLjIiIHkxPSIxNC43IiB4Mj0iNDIuMiIgeTI9IjUxLjgiLz4NCgk8bGluZSBjbGFzcz0ic3QwIiB4MT0iNDUuOCIgeTE9IjE0LjciIHgyPSI0NS44IiB5Mj0iNTEuOCIvPg0KCTxsaW5lIGNsYXNzPSJzdDAiIHgxPSI2LjciIHkxPSIxOC4zIiB4Mj0iNi43IiB5Mj0iNTMuMyIvPg0KCTxsaW5lIGNsYXNzPSJzdDAiIHgxPSI1LjQiIHkxPSI1My44IiB4Mj0iMTAuNSIgeTI9IjUzLjgiLz4NCgk8bGluZSBjbGFzcz0ic3QwIiB4MT0iMTcuNSIgeTE9IjUzLjgiIHgyPSI1Mi44IiB5Mj0iNTMuOCIvPg0KCTxsaW5lIGNsYXNzPSJzdDAiIHgxPSI1My4zIiB5MT0iMTguMyIgeDI9IjUzLjMiIHkyPSI1My4zIi8+DQoJPGxpbmUgY2xhc3M9InN0MCIgeDE9IjYuNyIgeTE9IjcuNyIgeDI9IjYuNyIgeTI9IjEyLjkiLz4NCgk8bGluZSBjbGFzcz0ic3QwIiB4MT0iOS44IiB5MT0iMTIuNiIgeDI9IjYuNyIgeTI9IjEyLjYiLz4NCgk8bGluZSBjbGFzcz0ic3QwIiB4MT0iNTMuMyIgeTE9IjcuNyIgeDI9IjUzLjMiIHkyPSIxMC4zIi8+DQoJPGxpbmUgY2xhc3M9InN0MCIgeDE9IjE3IiB5MT0iMTQuNyIgeDI9IjM1LjIiIHkyPSIxNC43Ii8+DQoJPHJlY3QgeD0iMTciIHk9IjE1LjIiIGNsYXNzPSJzdDAiIHdpZHRoPSI4LjYiIGhlaWdodD0iMC44Ii8+DQoJPHJlY3QgeD0iMjYuMSIgeT0iMTUuMiIgY2xhc3M9InN0MCIgd2lkdGg9IjguNiIgaGVpZ2h0PSIwLjgiLz4NCgk8Zz4NCgkJPHBvbHlsaW5lIGNsYXNzPSJzdDAiIHBvaW50cz0iNi43LDcuNCA2LjcsNi4xIDcuNCw2LjEgNy40LDYuOSAyMyw2LjkgMjMsNi4xIDguMiw2LjEgOC4yLDYuOSAJCSIvPg0KCQk8cG9seWxpbmUgY2xhc3M9InN0MCIgcG9pbnRzPSIxNy44LDYuMSAxNy44LDUuMyAyMC43LDUuMyAyMC43LDUuOSAJCSIvPg0KCQk8cG9seWxpbmUgY2xhc3M9InN0MCIgcG9pbnRzPSIxNy44LDYuOSAxNy44LDcuNCAyMC43LDcuNCAyMC43LDYuOSAJCSIvPg0KCQk8cG9seWxpbmUgY2xhc3M9InN0MCIgcG9pbnRzPSIyMyw2LjIgMjMsMyAyMi43LDMgCQkiLz4NCgk8L2c+DQoJPGc+DQoJCTxwb2x5bGluZSBjbGFzcz0ic3QwIiBwb2ludHM9IjUzLjMsNy40IDUzLjMsNi4xIDUyLjYsNi4xIDUyLjYsNi45IDM3LDYuOSAzNyw2LjEgNTEuOCw2LjEgNTEuOCw2LjkgCQkiLz4NCgkJPHBvbHlsaW5lIGNsYXNzPSJzdDAiIHBvaW50cz0iNDIuMiw2LjEgNDIuMiw1LjMgMzkuMyw1LjMgMzkuMyw1LjkgCQkiLz4NCgkJPHBvbHlsaW5lIGNsYXNzPSJzdDAiIHBvaW50cz0iNDIuMiw2LjkgNDIuMiw3LjQgMzkuMyw3LjQgMzkuMyw2LjkgCQkiLz4NCgkJPHBvbHlsaW5lIGNsYXNzPSJzdDAiIHBvaW50cz0iMzcsNi4xIDM3LDMgMzcuMywzIAkJIi8+DQoJPC9nPg0KPC9nPg0KPC9zdmc+DQo="},"4rPh":function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMjEgMjEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIxIDIxOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1taXRlcmxpbWl0OjEwO30NCjwvc3R5bGU+DQo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjAuNSwyMWMwLTAuMiwwLTAuNSwwLTAuN2MwLTEwLjktOC43LTE5LjgtMTkuNC0xOS44VjIxIi8+DQo8L3N2Zz4NCg=="},"6Fgi":function(e,t){},"7kC7":function(e,t){},BYiG:function(e,t,i){"use strict";var s=i("HSQo"),o=i.n(s),a=i("OvRC"),n=i.n(a);THREE.OrbitControls=function(e,t){var i,s,o,a,n;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:THREE.MOUSE.LEFT,MIDDLE:THREE.MOUSE.MIDDLE,RIGHT:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return g.phi},this.getAzimuthalAngle=function(){return g.theta},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(l),r.update(),h=u.NONE},this.update=(i=new THREE.Vector3,s=(new THREE.Quaternion).setFromUnitVectors(e.up,new THREE.Vector3(0,1,0)),o=s.clone().inverse(),a=new THREE.Vector3,n=new THREE.Quaternion,function(){var e=r.object.position;return i.copy(e).sub(r.target),i.applyQuaternion(s),g.setFromVector3(i),r.autoRotate&&h===u.NONE&&H(2*Math.PI/60/60*r.autoRotateSpeed),g.theta+=p.theta,g.phi+=p.phi,g.theta=Math.max(r.minAzimuthAngle,Math.min(r.maxAzimuthAngle,g.theta)),g.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,g.phi)),g.makeSafe(),g.radius*=m,g.radius=Math.max(r.minDistance,Math.min(r.maxDistance,g.radius)),r.target.add(v),i.setFromSpherical(g),i.applyQuaternion(o),e.copy(r.target).add(i),r.object.lookAt(r.target),!0===r.enableDamping?(p.theta*=1-r.dampingFactor,p.phi*=1-r.dampingFactor,v.multiplyScalar(1-r.dampingFactor)):(p.set(0,0,0),v.set(0,0,0)),m=1,!!(I||a.distanceToSquared(r.object.position)>f||8*(1-n.dot(r.object.quaternion))>f)&&(r.dispatchEvent(l),a.copy(r.object.position),n.copy(r.object.quaternion),I=!1,!0)}),this.dispose=function(){r.domElement.removeEventListener("contextmenu",Y,!1),r.domElement.removeEventListener("mousedown",U,!1),r.domElement.removeEventListener("wheel",z,!1),r.domElement.removeEventListener("touchstart",G,!1),r.domElement.removeEventListener("touchend",B,!1),r.domElement.removeEventListener("touchmove",W,!1),document.removeEventListener("mousemove",R,!1),document.removeEventListener("mouseup",P,!1),window.removeEventListener("keydown",V,!1)};var r=this,l={type:"change"},c={type:"start"},d={type:"end"},u={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},h=u.NONE,f=1e-6,g=new THREE.Spherical,p=new THREE.Spherical,m=1,v=new THREE.Vector3,I=!1,b=new THREE.Vector2,y=new THREE.Vector2,w=new THREE.Vector2,x=new THREE.Vector2,L=new THREE.Vector2,j=new THREE.Vector2,E=new THREE.Vector2,S=new THREE.Vector2,O=new THREE.Vector2;function T(){return Math.pow(.95,r.zoomSpeed)}function H(e){p.theta-=e}function N(e){p.phi-=e}var C,M=(C=new THREE.Vector3,function(e,t){C.setFromMatrixColumn(t,0),C.multiplyScalar(-e),v.add(C)}),_=function(){var e=new THREE.Vector3;return function(t,i){!0===r.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(r.object.up,e)),e.multiplyScalar(t),v.add(e)}}(),D=function(){var e=new THREE.Vector3;return function(t,i){var s=r.domElement===document?r.domElement.body:r.domElement;if(r.object.isPerspectiveCamera){var o=r.object.position;e.copy(o).sub(r.target);var a=e.length();a*=Math.tan(r.object.fov/2*Math.PI/180),M(2*t*a/s.clientHeight,r.object.matrix),_(2*i*a/s.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(M(t*(r.object.right-r.object.left)/r.object.zoom/s.clientWidth,r.object.matrix),_(i*(r.object.top-r.object.bottom)/r.object.zoom/s.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function k(e){r.object.isPerspectiveCamera?m/=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*e)),r.object.updateProjectionMatrix(),I=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function F(e){r.object.isPerspectiveCamera?m*=e:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/e)),r.object.updateProjectionMatrix(),I=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function A(e){x.set(e.clientX,e.clientY)}function U(e){if(!1!==r.enabled){switch(e.preventDefault(),e.button){case r.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===r.enablePan)return;A(e),h=u.PAN}else{if(!1===r.enableRotate)return;!function(e){b.set(e.clientX,e.clientY)}(e),h=u.ROTATE}break;case r.mouseButtons.MIDDLE:if(!1===r.enableZoom)return;!function(e){E.set(e.clientX,e.clientY)}(e),h=u.DOLLY;break;case r.mouseButtons.RIGHT:if(!1===r.enablePan)return;A(e),h=u.PAN}h!==u.NONE&&(document.addEventListener("mousemove",R,!1),document.addEventListener("mouseup",P,!1),r.dispatchEvent(c))}}function R(e){if(!1!==r.enabled)switch(e.preventDefault(),h){case u.ROTATE:if(!1===r.enableRotate)return;!function(e){y.set(e.clientX,e.clientY),w.subVectors(y,b).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;H(2*Math.PI*w.x/t.clientHeight),N(2*Math.PI*w.y/t.clientHeight),b.copy(y),r.update()}(e);break;case u.DOLLY:if(!1===r.enableZoom)return;!function(e){S.set(e.clientX,e.clientY),O.subVectors(S,E),O.y>0?k(T()):O.y<0&&F(T()),E.copy(S),r.update()}(e);break;case u.PAN:if(!1===r.enablePan)return;!function(e){L.set(e.clientX,e.clientY),j.subVectors(L,x).multiplyScalar(r.panSpeed),D(j.x,j.y),x.copy(L),r.update()}(e)}}function P(e){!1!==r.enabled&&(document.removeEventListener("mousemove",R,!1),document.removeEventListener("mouseup",P,!1),r.dispatchEvent(d),h=u.NONE)}function z(e){!1===r.enabled||!1===r.enableZoom||h!==u.NONE&&h!==u.ROTATE||(e.preventDefault(),e.stopPropagation(),r.dispatchEvent(c),function(e){e.deltaY<0?F(T()):e.deltaY>0&&k(T()),r.update()}(e),r.dispatchEvent(d))}function V(e){!1!==r.enabled&&!1!==r.enableKeys&&!1!==r.enablePan&&function(e){switch(e.keyCode){case r.keys.UP:D(0,r.keyPanSpeed),r.update();break;case r.keys.BOTTOM:D(0,-r.keyPanSpeed),r.update();break;case r.keys.LEFT:D(r.keyPanSpeed,0),r.update();break;case r.keys.RIGHT:D(-r.keyPanSpeed,0),r.update()}}(e)}function G(e){if(!1!==r.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===r.enableRotate)return;!function(e){b.set(e.touches[0].pageX,e.touches[0].pageY)}(e),h=u.TOUCH_ROTATE;break;case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,s=Math.sqrt(t*t+i*i);E.set(0,s)}if(r.enablePan){var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);x.set(o,a)}}(e),h=u.TOUCH_DOLLY_PAN;break;default:h=u.NONE}h!==u.NONE&&r.dispatchEvent(c)}}function W(e){if(!1!==r.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===r.enableRotate)return;if(h!==u.TOUCH_ROTATE)return;!function(e){y.set(e.touches[0].pageX,e.touches[0].pageY),w.subVectors(y,b).multiplyScalar(r.rotateSpeed);var t=r.domElement===document?r.domElement.body:r.domElement;H(2*Math.PI*w.x/t.clientHeight),N(2*Math.PI*w.y/t.clientHeight),b.copy(y),r.update()}(e);break;case 2:if(!1===r.enableZoom&&!1===r.enablePan)return;if(h!==u.TOUCH_DOLLY_PAN)return;!function(e){if(r.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,i=e.touches[0].pageY-e.touches[1].pageY,s=Math.sqrt(t*t+i*i);S.set(0,s),O.set(0,Math.pow(S.y/E.y,r.zoomSpeed)),k(O.y),E.copy(S)}if(r.enablePan){var o=.5*(e.touches[0].pageX+e.touches[1].pageX),a=.5*(e.touches[0].pageY+e.touches[1].pageY);L.set(o,a),j.subVectors(L,x).multiplyScalar(r.panSpeed),D(j.x,j.y),x.copy(L)}r.update()}(e);break;default:h=u.NONE}}function B(e){!1!==r.enabled&&(r.dispatchEvent(d),h=u.NONE)}function Y(e){!1!==r.enabled&&e.preventDefault()}r.domElement.addEventListener("contextmenu",Y,!1),r.domElement.addEventListener("mousedown",U,!1),r.domElement.addEventListener("wheel",z,!1),r.domElement.addEventListener("touchstart",G,!1),r.domElement.addEventListener("touchend",B,!1),r.domElement.addEventListener("touchmove",W,!1),window.addEventListener("keydown",V,!1),this.update()},THREE.OrbitControls.prototype=n()(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,o()(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}})},CJli:function(e,t,i){i("pRCB");var s=i("FeBl").Object;e.exports=function(e,t){return s.defineProperties(e,t)}},HSQo:function(e,t,i){e.exports={default:i("CJli"),__esModule:!0}},HbZC:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMjEgMjEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIxIDIxOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1taXRlcmxpbWl0OjEwO30NCjwvc3R5bGU+DQo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMjEsMWMtMC4yLDAtMC41LDAtMC43LDBDOS40LDEsMC42LDkuNywwLjYsMjAuNEgyMSIvPg0KPC9zdmc+DQo="},Hn5L:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("//Fk"),o=i.n(s),a=i("fZjL"),n=i.n(a),r=i("BO1k"),l=i.n(r),c=i("mvHQ"),d=i.n(c),u=i("u3Mf"),h=i("Oizb"),f=i("os9D"),g=i("yzMb"),p=(i("/sA3"),i("fYBn")),m=i("02tb"),v=i("6Vw2"),I=i("aG/w"),b=i("uSev"),y=i("UzJb"),w=i("7t+N"),x=i("tsU9").fabric,L=i("gApy"),j={components:{cancelBtn:p.a,confirmBtn:m.a,saveBtn:v.a,threeD:I.a,tableComponent:b.a},data:function(){return{PRO_TYPE:u.e,canvas:null,mouseFrom:{},mouseTo:{},drawType:null,textbox:null,drawWidth:1,color:"#333333",drawingObject:null,moveCount:1,doDrawing:!1,cell_width:20,activeIconIndex:null,dialogTitle:"",dialogVisible:!1,accessoryDialogVisible:!1,isLeader:"1",oldIsLeader:"",unitIds:"",Form:{houseId:"",housinguseId:null,houseNumber:"",houseUseArea:null,housetypeId:null,houseTypeFlag:null,useType:"",isUse:1,isIdle:0,leadingOfficeVo:{useunitId:null,unitId:null,useRelationshipList:[],deleteLeadingOfficeIds:[],leadingOfficeList:[{duty:"",leadingofficeId:null,leadingofficeName:"",leadingofficeWorkstatue:null,leadingofficeWorkStatueId:null,professionalId:null,professionalLevel:null,professionOpts:[]}]},housingUseVoList:[{useunitId:null,unitId:null,housinguseId:null,useRelationshipList:[],deleteLeadingOfficeIds:[],leadingOfficeList:[],useForm:null,distributionTime:null,departmentName:null}],deleteUseUnitIds:[]},oldFormData:null,contextMenuItems:{delete:{name:"删除",icon:"delete"}},contextMenuItems_2:{edit:{name:"编辑",icon:"edit"},delete:{name:"删除",icon:"delete"}},isRoom:!1,isOldUse:null,AddHouseId:[],deleteHouseId:[],editHouseInfo:[],existHouseId:[],existHouseInfo:[],originalHouseInfo:[],houseTypeColor:[{id:1,color:"#21b124"},{id:2,color:"#f4e83b"},{id:3,color:"#008aff"},{id:4,color:"#12fff1"},{id:5,color:"#ff01fd"},{id:6,color:"#fe8200"}],houseType:[],useType:["租赁","调配"],unitOptions:[],profession:[],workStatue:[],baseSubmitFlag:!0,unitSubmitFlag:!0,professSubmitFlag:!0,userNumSubmitFlag:!0,workStatueNumSubmitFlag:!0,nonLeaderSumbitFlag:!0,dutyNumSubmitFlag:!0,uploadCADUrl:h.n+"?uploadType=floor",fileList:[],CADDownload:[],activeBtnIndex:0,postHeaders:{Authorization:""},token:"",text_H:20,canvasHeight:0,canvasWidth:0,popoverDoorIcon:!1,activeObject:null,oldHouseType:null,drawing_width_scale:0,drawing_height_scale:0,allNavList:null,copiedGraphData:null,activeList:[],startEditObj:null,textHeightSpace:5,textWidthSpace:16,isConfigFloor:null,configDialogVisible:!1,configTableData:[],configCurrentPage:1,configPageSize:5,configTableTotal:0,updateIdList:[],houseVoList:[],addHouseIdList:[],delHouseIdList:[],configureIdList:[],rentHouseIds:[],wall_coordinate:[],configPX:{height:1080,width:1920},panning:!1,movementX:0,movementY:0,threeSacle:2,showViewBtn:!1,professionalLevelOpts:[{id:3,name:"市级机关"},{id:4,name:"县级机关"},{id:5,name:"乡级机关"}],loading:null,webglFlag:!0,moveFlag:!1,oldActiveIconIndex:null}},methods:{professionalLevelChange:function(e,t){this.Form.leadingOfficeVo.leadingOfficeList[t].professionalId="",this.Form.leadingOfficeVo.leadingOfficeList[t].professionalNum="",this.getAllProfessionList(e,t)},init:function(){var e=this;if(this.canvas=new x.Canvas("c",{skipTargetFind:!0,selectable:!1,selection:!1}),x.ActiveSelection.prototype.hasControls=x.ActiveSelection.prototype.hasBorders=!1,x.Object.prototype.originX="left",x.Object.prototype.originY="top",x.Object.prototype.transparentCorners=!1,x.Object.prototype.borderColor="red",x.Object.prototype.cornerColor="green",x.Object.prototype.cornerSize=10,x.Object.prototype.borderScaleFactor=2,x.Object.prototype.hasRotatingPoint=!1,window.canvas=this.canvas,this.setZoom(),window.onresize=function(){e.setZoom()},this.setCommonEvent(),w.contextMenu({selector:".upper-canvas",trigger:"none",build:function(e,t){return t.data("runCallbackThingie")()}}),this.startEditObj){this.getHouseGraphJson(this.startEditObj.buildId,this.startEditObj.floorName,!0),this.getAllHouseInfo(this.startEditObj.buildId,this.startEditObj.floorName);var t=sessionStorage.getItem("buildId"),i=sessionStorage.getItem("floorName");Object(h.m)(t,[i]).then(function(t){t?(e.isConfigFloor=!0,e.$confirm("该楼层房间关联了配置，如修改或删除房间信息，可能会还原分配方案。","提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning",center:!0}).then(function(){})):e.isConfigFloor=!1}).catch(function(t){var i=t.result?t.result:"是否关联配置获取失败";e.$message({message:i,type:"error"})})}},setZoom:function(){var e=w(this.canvas.wrapperEl).parent();this.canvasWidth=e.width(),this.canvasHeight=e.height();var t=this.canvas.height,i=this.canvas.width,s=this.canvasHeight>t?this.canvasHeight:t,o=this.canvasWidth>i?this.canvasWidth:i;o>s?(o=this.canvasWidth,s=this.canvasHeight):s=s*this.canvasHeight/this.configPX.height*.8,window.zoom=1,this.canvas.setZoom(1),this.canvas.setWidth(o),this.canvas.setHeight(s),this.canvas.requestRenderAll()},setCommonEvent:function(){var e=this;this.canvas.on("mouse:down",function(t){var i=!0,s=e.canvas.getObjects("textbox");if(s&&s.length>0)for(var o=0;o<s.length;o++){var a=s[o];if(e.canvas.containsPoint(t.e,a)){i=!1;break}}e.mouseFrom.x=t.e.offsetX,e.mouseFrom.y=t.e.offsetY,e.textbox&&i?(e.textbox.exitEditing(),e.textbox=null):!e.textbox&&i&&"text"===e.drawType&&(e.textbox=new x.Textbox("",{left:e.mouseFrom.x,top:e.mouseFrom.y,width:150,fontSize:18,fill:e.color,moveTo:10}),e.canvas.add(e.textbox),e.textbox.enterEditing()),"line"!==e.drawType&&"dottedline"!==e.drawType&&"rectangle"!==e.drawType||(e.doDrawing=!0,e.moveCount=1,e.mouseFrom.x%e.cell_width>=e.cell_width/2?e.mouseFrom.x=Math.ceil(e.mouseFrom.x/e.cell_width)*e.cell_width-1:e.mouseFrom.x=Math.floor(e.mouseFrom.x/e.cell_width)*e.cell_width-1,e.mouseFrom.y%e.cell_width>=e.cell_width/2?e.mouseFrom.y=Math.ceil(e.mouseFrom.y/e.cell_width)*e.cell_width-1:e.mouseFrom.y=Math.floor(e.mouseFrom.y/e.cell_width)*e.cell_width-1),!e.doDrawing&&t.e.altKey&&(e.panning=!0,e.canvas.selection=!1)}),this.canvas.on("mouse:move",function(t){if(e.panning&&t&&t.e&&!e.doDrawing){e.movementX+=t.e.movementX,e.movementY+=t.e.movementY;var i=new x.Point(t.e.movementX,t.e.movementY);e.canvas.relativePan(i)}else if((!(e.moveCount%2)||e.doDrawing)&&e.doDrawing)if(e.mouseTo.x=t.e.offsetX,e.mouseTo.y=t.e.offsetY,"rectangle"===e.drawType){var s=e.mouseTo.x-e.mouseFrom.x,o=e.mouseTo.y-e.mouseFrom.y;if(s>0&&o>0){var a=Math.floor(s/e.cell_width),n=Math.floor(o/e.cell_width);a<1&&(a=1),n<1&&(n=1),s%e.cell_width>=e.cell_width/2?(s=(a+1)*e.cell_width,e.drawing_width_scale=a+1):(s=a*e.cell_width,e.drawing_width_scale=a),o%e.cell_width>=e.cell_width/2?(o=(n+1)*e.cell_width,e.drawing_height_scale=n+1):(o=n*e.cell_width,e.drawing_height_scale=n),e.mouseTo.x=e.mouseFrom.x+s,e.mouseTo.y=e.mouseFrom.y+o,e.moveCount++,e.drawing()}}else e.moveCount++,e.drawing()}),this.canvas.on("mouse:up",function(t){if(!e.doDrawing&&e.panning){e.panning=!1,e.canvas.selection=!1;var i=0,s=0;e.movementX>0?i=e.cell_width-e.movementX%e.cell_width:e.movementX<0&&(i=-(e.cell_width- -e.movementX%e.cell_width)),s=e.movementY>0?e.cell_width-e.movementY%e.cell_width:-(e.cell_width- -e.movementY%e.cell_width);var o=new x.Point(i,s);e.canvas.relativePan(o),e.movementX=0,e.movementY=0}var a,n=e.canvas.getActiveObject();if(n&&!e.doDrawing&&"move"===e.drawType&&e.moveFlag){var r=n.type;if("textbox"!==r){var l=void 0,c=void 0,d=n.left,u=n.top;if(d>=0&&u>=0)if(l=d%e.cell_width>=e.cell_width/2?Math.ceil(d/e.cell_width)*e.cell_width-1:Math.floor(d/e.cell_width)*e.cell_width-1,c=u%e.cell_width>=e.cell_width/2?Math.ceil(u/e.cell_width)*e.cell_width-1:Math.floor(u/e.cell_width)*e.cell_width-1,"group"===r&&"path"===n.roomType){var h=n.pathLeft,f=n.pathTop,g=(n.uuid,l-h),p=c-f,m=n.pathPoint;e.canvas.remove(n);for(var v=0;v<m.length;v++){var I=m[v];I[0]=I[0]+g,I[1]=I[1]+p}for(var b="",y=0;y<m.length;y++)b+=0===y?"M "+m[y][0]+" "+m[y][1]+" ":"L "+m[y][0]+" "+m[y][1]+" ";b+="z",e.setPathGraph(n,m,b)}else if("line"===r){if(n.oldLeft&&n.oldTop&&n.oldCoord){var w=l-n.oldLeft,j=c-n.oldTop;n.oldCoord.x1=n.oldCoord.x1+w,n.oldCoord.x2=n.oldCoord.x2+w,n.oldCoord.y1=n.oldCoord.y1+j,n.oldCoord.y2=n.oldCoord.y2+j,n.oldLeft=l,n.oldTop=c}n.set({left:l,top:c}),n.setCoords()}else n.set({left:l,top:c}),n.setCoords(),e.canvas.requestRenderAll(),"activeSelection"===r&&n.forEachObject(function(t){if("group"===t.type&&"path"===t.roomType){var i=n.calcTransformMatrix(),s=new x.Point(t.left,t.top),o=x.util.transformPoint(s,i),a=o.x,r=o.y;if(a>=0&&r>=0){var l=t.pathLeft,c=t.pathTop,d=(t.uuid,a-l),u=r-c,h=t.pathPoint;e.canvas.remove(t);for(var f=0;f<h.length;f++){var g=h[f];g[0]=g[0]+d,g[1]=g[1]+u}for(var p="",m=0;m<h.length;m++)p+=0===m?"M "+h[m][0]+" "+h[m][1]+" ":"L "+h[m][0]+" "+h[m][1]+" ";p+="z",e.setPathGraph(t,h,p,n)}}else if("line"===t.type){var v=n.calcTransformMatrix(),I=new x.Point(t.left,t.top),b=x.util.transformPoint(I,v),y=b.x,w=b.y;if(y>=0&&w>=0&&t.oldLeft&&t.oldTop&&t.oldCoord){var L=y-t.oldLeft,j=w-t.oldTop;t.oldCoord.x1=t.oldCoord.x1+L,t.oldCoord.x2=t.oldCoord.x2+L,t.oldCoord.y1=t.oldCoord.y1+j,t.oldCoord.y2=t.oldCoord.y2+j,t.oldLeft=y,t.oldTop=w}}})}e.moveFlag=!1}if(e.doDrawing){if(e.canvas.discardActiveObject(),e.moveCount=1,e.doDrawing=!1,e.drawing_width_scale=0,e.drawing_height_scale=0,e.mouseTo.x=t.e.offsetX,e.mouseTo.y=t.e.offsetY,e.drawingObject&&"rect"===e.drawingObject.type){var E=e.drawingObject.width,S=e.drawingObject.height;e.canvas.remove(e.drawingObject);var O=new x.Rect({left:e.mouseFrom.x,top:e.mouseFrom.y,stroke:e.color,strokeWidth:e.drawWidth,fill:"rgba(204, 204, 204, 1)",width:E,height:S}),T=new x.Group([O]);T.toObject=(a=T.toObject,function(){return x.util.object.extend(a.call(this),{uuid:this.uuid,isUse:this.isUse,typeName:this.typeName})}),e.canvas.add(T);var H=L();T.uuid=H,T.typeName="room",e.canvas.requestRenderAll(),e.AddHouseId.push(H)}if(e.drawingObject&&("line"===e.drawingObject.type||"dottedline"===e.drawingObject.type)){var N=e.mouseFrom.x,C=e.mouseTo.x,M=e.mouseFrom.y,_=e.mouseTo.y,D=Math.floor(C/e.cell_width),k=Math.floor(_/e.cell_width);C=C%e.cell_width>=e.cell_width/2?(D+1)*e.cell_width-1:D*e.cell_width-1,_=_%e.cell_width>=e.cell_width/2?(k+1)*e.cell_width-1:k*e.cell_width-1,e.drawingObject.set({x2:C,y2:_}),e.drawingObject.setCoords(),e.drawingObject.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{oldLeft:this.oldLeft,oldTop:this.oldTop,oldCoord:this.oldCoord})}}(e.drawingObject.toObject);var F={x1:N,y1:M,x2:C,y2:_};e.drawingObject.oldLeft=e.drawingObject.left,e.drawingObject.oldTop=e.drawingObject.top,e.drawingObject.oldCoord=F,e.canvas.requestRenderAll()}e.drawingObject=null}}),this.canvas.on("mouse:dblclick",function(t){if("line"!==e.drawType&&"dottedline"!==e.drawType&&"rectangle"!==e.drawType){var i=e.canvas.getObjects("textbox");if(i&&i.length>0)for(var s=0;s<i.length;s++){var o=i[s];e.canvas.containsPoint(t.e,o)&&(e.textbox=o,o.enterEditing())}}}),this.canvas.on("object:moving",function(t){0===t.target.angle&&(t.target.opacity=.7,t.target.left+t.target.width>=e.canvasWidth&&(t.target.left=e.canvasWidth-t.target.width),t.target.top+t.target.height>=e.canvasHeight&&(t.target.top=e.canvasHeight-t.target.height),t.target.left<=0&&(t.target.left=0),t.target.top<=0&&(t.target.top=0))}),this.canvas.on("object:moved",function(t){t.target.opacity=.7,e.moveFlag=!0}),this.canvas.on("object:modified",function(e){e.target.opacity=1}),this.canvas.on("object:scaling",function(t){if("group"===t.target.type&&"room"===t.target.typeName&&0===t.target.angle){var i=t.target,s=i.width*i.scaleX,o=i.height*i.scaleY,a=Math.floor(s/e.cell_width),n=Math.floor(o/e.cell_width);s%e.cell_width>=e.cell_width/2?e.drawing_width_scale=a+1:e.drawing_width_scale=a,o%e.cell_width>=e.cell_width/2?e.drawing_height_scale=n+1:e.drawing_height_scale=n,e.canvas.requestRenderAll()}}),this.canvas.on("object:scaled",function(t){if("group"===t.target.type&&"room"===t.target.typeName&&0===t.target.angle){var i=t.target,s=i.width,o=i.height,a=i.width*i.scaleX,n=i.height*i.scaleY,r=Math.floor(a/e.cell_width),l=Math.floor(n/e.cell_width),c=(a=a%e.cell_width>=e.cell_width/2?(r+1)*e.cell_width+1:r*e.cell_width+1)/s,d=(n=n%e.cell_width>=e.cell_width/2?(l+1)*e.cell_width+1:l*e.cell_width+1)/o;i.set({scaleX:c,scaleY:d}),i.setCoords(),e.canvas.requestRenderAll()}e.drawing_width_scale=0,e.drawing_height_scale=0})},setPathGraph:function(e,t,i,s){var o="",a="",n="",r=e.uuid;this.existHouseInfo.forEach(function(e){e.houseId===r&&(o=e.houseUseArea||"",a=e.houseNumber||"",n=e.housetypeId||null)});var l=new x.Path(i,{stroke:this.color,strokeWidth:this.drawWidth,fill:"rgba(204, 204, 204, 1)"});n&&this.houseTypeColor.forEach(function(e){e.id===n&&l.set("fill",e.color)});var c,d=new x.Group([l],{hasControls:!1});if(d.toObject=(c=d.toObject,function(){return x.util.object.extend(c.call(this),{uuid:this.uuid,isUse:this.isUse,typeName:this.typeName,pathLeft:this.pathLeft,pathTop:this.pathTop,pathPoint:this.pathPoint,roomType:this.roomType})}),this.canvas.add(d),d.uuid=r,d.typeName="room",d.pathLeft=d.left,d.pathTop=d.top,d.pathPoint=t,d.roomType="path",o&&a){var u=d.width,h=d.height,f=new x.Text(o+"m²",{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),g=f.width,p=f.height,m=1,v=1;if(g+2*this.textWidthSpace>u){var I=u-2*this.textWidthSpace;f.scaleToWidth(I),m=f.scaleX}if(3*p+2*this.textHeightSpace>h){var b=(h-2*this.textHeightSpace)/3;f.scaleToHeight(b),v=f.scaleY}m>v?f.set({scaleX:v,scaleY:v}):m<v&&f.set({scaleX:m,scaleY:m}),f.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(f.toObject),d.add(f),f.typeName="houseUseArea";var y=new x.Text(""+a,{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),w=y.width,L=y.height,j=1;if(w+2*this.textWidthSpace>u){var E=u-2*this.textWidthSpace;y.scaleToWidth(E),j=y.scaleX}if(3*L+2*this.textHeightSpace>h){var S=(h-2*this.textHeightSpace)/3;y.scaleToHeight(S),y.scaleY}var O=void 0,T=void 0;j>m?(O=m,T=f.height):(O=j,T=y.height,f.set({scaleX:O,scaleY:O}));var H=Math.round(-T*O-this.textHeightSpace/2),N=new x.Text(""+a,{strokeWidth:1,originX:"center",originY:"center",fontSize:20,scaleX:O,scaleY:O,top:H});N.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(N.toObject),d.add(N),N.typeName="houseNumber"}s?s.addWithUpdate(d):this.canvas.setActiveObject(d),this.canvas.requestRenderAll()},tool:function(e,t){var i=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName");if(!i||!s)return this.popoverDoorIcon=!1,this.$message({message:"请先选择楼层",type:"warning"}),!1;this.activeIconIndex=t,this.drawType=e,this.canvas.selectable=!1,this.canvas.selection=!1,this.canvas.skipTargetFind=!0,this.doDrawing=!1,this.textbox&&(this.textbox.exitEditing(),this.textbox=null),"move"===this.drawType&&(this.canvas.selectable=!0,this.canvas.selection=!0,this.canvas.skipTargetFind=!1),this.canvas.discardActiveObject()},drawing:function(){this.drawingObject&&this.canvas.remove(this.drawingObject);var e=null;switch(this.drawType){case"line":e=new x.Line([this.mouseFrom.x,this.mouseFrom.y,this.mouseTo.x,this.mouseTo.y],{stroke:this.color,strokeWidth:this.drawWidth,hasControls:!1});break;case"dottedline":e=new x.Line([this.mouseFrom.x,this.mouseFrom.y,this.mouseTo.x,this.mouseTo.y],{strokeDashArray:[3,1],stroke:this.color,strokeWidth:this.drawWidth,hasControls:!1});break;case"rectangle":var t=this.mouseFrom.x,i=this.mouseFrom.y,s=this.mouseTo.x-this.mouseFrom.x,o=this.mouseTo.y-this.mouseFrom.y;e=new x.Rect({left:t,top:i,stroke:"#ff0000",strokeWidth:this.drawWidth,fill:"rgba(5, 127, 231, 0.2)",width:s,height:o})}e&&(this.canvas.add(e),this.drawingObject=e,this.canvas.requestRenderAll())},addDoor:function(e){var t=this;this.popoverDoorIcon=!1,x.loadSVGFromURL(i("0oGA")("./"+e+"-canvas.svg"),function(i,s){var o,a=x.util.groupSVGElements(i,s);a.set({left:59,top:240,fill:"rgb(255,255,255)"}),a.toObject=(o=a.toObject,function(){return x.util.object.extend(o.call(this),{typeName:this.typeName})}),a.typeName=e,t.canvas.add(a),t.canvas.requestRenderAll(),t.tool("move",0)})},getOptionsList:function(){var e=this;Object(h.g)().then(function(t){e.houseType=t}).catch(function(t){var i=t.result?t.result:"房屋形式获取失败";e.$message({message:i,type:"error"})}),Object(h.l)().then(function(t){e.unitOptions=t}).catch(function(t){var i=t.result?t.result:"单位名称获取失败";e.$message({message:i,type:"error"})}),Object(h.o)().then(function(t){e.workStatue=t}).catch(function(t){var i=t.result?t.result:"在职情况获取失败";e.$message({message:i,type:"error"})})},getAllProfessionList:function(e,t){var i=this;Object(h.b)(e,0).then(function(e){i.$set(i.Form.leadingOfficeVo.leadingOfficeList[t],"professionOpts",e)}).catch(function(e){var t=e.result?e.result:"职称获取失败";i.$message({message:t,type:"error"})})},showContextMenu:function(e){if(3===e.which){var t=w(".upper-canvas");if(this.activeObject=null,this.activeList=this.canvas.getActiveObjects(),this.isRoom=!1,this.activeList.length>1){t.data("runCallbackThingie",this.createSomeMenu);var i={x:e.clientX,y:e.clientY};t.contextMenu(i)}else if(1===this.activeList.length){this.canvas.containsPoint(e,this.activeList[0])&&("group"===this.activeList[0].type&&"room"===this.activeList[0].typeName?(this.isRoom=!0,this.activeObject=this.activeList[0]):this.isRoom=!1),t.data("runCallbackThingie",this.createSomeMenu);var s={x:e.clientX,y:e.clientY};t.contextMenu(s)}else if(0===this.activeList.length){var o=this.canvas.getObjects();if(o&&o.length>0)for(var a=0;a<o.length;a++)if(this.canvas.containsPoint(e,o[a])){this.activeObject=o[a],"group"===this.activeObject.type&&"room"===this.activeObject.typeName?this.isRoom=!0:this.isRoom=!1,t.data("runCallbackThingie",this.createSomeMenu);var n={x:e.clientX,y:e.clientY};return t.contextMenu(n),!1}}}},createSomeMenu:function(){var e=null;return e=this.isRoom?this.contextMenuItems_2:this.contextMenuItems,{callback:this.contextMenuClick,items:e}},contextMenuClick:function(e,t){var i=this;if("delete"===t)if(this.activeList.length>0){var s=!0;this.activeList.forEach(function(e){if("group"===e.type&&"room"===e.typeName)for(var t=0;t<i.originalHouseInfo.length;t++){var o=i.originalHouseInfo[t];if(o.houseId===e.uuid){if(e.actualDeleteflag=!0,void 0!==o.rent)return i.$message({message:"已经租借的房间不能删除",type:"warning"}),s=!1,!1;if(void 0!==o.repairModuleId)return i.$message({message:"关联维修的房间不能再次删除",type:"warning"}),s=!1,!1;if(void 0!==o.configurePlanDataId||o.configurePlanDataId)return i.$message({message:"关联配置的房间不能删除",type:"warning"}),s=!1,!1}}}),s&&this.activeList.forEach(function(e){e.actualDeleteflag&&i.deleteHouseId.push(e.uuid);for(var t=0;t<i.AddHouseId.length;t++)if(i.AddHouseId[t]===e.uuid){i.AddHouseId.splice(t,1);break}for(var s=0;s<i.editHouseInfo.length;s++)if(i.editHouseInfo[s].houseId===e.uuid){i.editHouseInfo.splice(s,1);break}i.canvas.remove(e)}),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.activeList=[]}else{for(var o=!0,a=!1,n=0;n<this.originalHouseInfo.length;n++){var r=this.originalHouseInfo[n];if(r.houseId===this.activeObject.uuid){if(a=!0,void 0!==r.rent)return this.$message({message:"已经租借的房间不能删除",type:"warning"}),o=!1,!1;if(void 0!==r.repairModuleId)return this.$message({message:"关联维修的房间不能再次删除",type:"warning"}),o=!1,!1;if(void 0!==r.configurePlanDataId||r.configurePlanDataId)return this.$message({message:"关联配置的房间不能删除",type:"warning"}),o=!1,!1}}if(o){a&&this.deleteHouseId.push(this.activeObject.uuid);for(var l=0;l<this.AddHouseId.length;l++)if(this.AddHouseId[l]===this.activeObject.uuid){this.AddHouseId.splice(l,1);break}for(var c=0;c<this.editHouseInfo.length;c++)if(this.editHouseInfo[c].houseId===this.activeObject.uuid){this.editHouseInfo.splice(c,1);break}this.canvas.remove(this.activeObject),this.canvas.discardActiveObject(),this.canvas.requestRenderAll()}}else if("edit"===t){var u=!1;this.originalHouseInfo.forEach(function(e){e.houseId===i.activeObject.uuid&&(u=!0,1===e.housetypeId&&1===e.isUse?e.housingUseVoList&&e.housingUseVoList.length>0&&null!==e.housingUseVoList[0].unitId&&""!==e.housingUseVoList[0].unitId?i.oldIsLeader="2":e.leadingOfficeVo&&null!==e.leadingOfficeVo.unitId&&""!==e.leadingOfficeVo.unitId&&(i.oldIsLeader="1"):i.oldIsLeader=null,1===e.isUse?i.isOldUse=1:i.isOldUse=0,i.oldHouseType=e.houseTypeFlag,i.oldFormData=JSON.parse(d()(e)))}),u||(this.oldHouseType=null,this.oldIsLeader=null,this.isOldUse=null),this.existHouseInfo.forEach(function(e){if(e.houseId===i.activeObject.uuid){1===e.housetypeId&&1===e.isUse?e.housingUseVoList&&e.housingUseVoList.length>0&&null!==e.housingUseVoList[0].unitId&&""!==e.housingUseVoList[0].unitId?i.isLeader="2":e.leadingOfficeVo&&null!==e.leadingOfficeVo.unitId&&""!==e.leadingOfficeVo.unitId&&(i.isLeader="1"):1!==e.housetypeId&&1===e.isUse&&(i.unitIds=e.unitIds[0]);var t=JSON.parse(d()(e));console.log(t),w.extend(i.Form,t)}}),this.Form.houseId=this.activeObject.uuid,this.Form.rent&&(this.Form.rent.rentBegin=this.formatDate(this.Form.rent.rentBegin),this.Form.rent.rentEnd=this.formatDate(this.Form.rent.rentEnd)),1===this.Form.housetypeId&&1===this.Form.isUse&&this.Form.leadingOfficeVo&&null!==this.Form.leadingOfficeVo.unitId&&""!==this.Form.leadingOfficeVo.unitId&&(console.log(this.Form),this.Form.leadingOfficeVo.leadingOfficeList.forEach(function(e){Object(h.b)(e.professionalLevel,0).then(function(t){i.$set(e,"professionOpts",t)}).catch(function(e){var t=e.result?e.result:"职称获取失败";i.$message({message:t,type:"error"})})})),this.dialogVisible=!0}},submitForm:function(){var e=this;1===this.Form.isIdle&&(this.Form.isUse=0);var t,i=null;if(i=1!==this.Form.houseTypeFlag&&1===this.Form.isUse?["houseNumber","houseUseArea","housetypeId","unitIds"]:["houseNumber","houseUseArea","housetypeId"],this.verificationNull(i),1===this.Form.isUse&&"1"===this.isLeader){var s=0,o=0,a=0,n=0,r=0;if(null===this.Form.leadingOfficeVo.unitId||""===this.Form.leadingOfficeVo.unitId){var l=w(".leader-info").find(".content-item-unitName");if(0===w(l).find(".el-form-item__error").length){var c=w(l).find("label").text(),u=w('<div class="el-form-item__error">'+c+"不能为空</div>");w(l).append(u)}this.unitSubmitFlag=!1}else{var h=w(".leader-info").find(".content-item-unitName"),f=w(h).find(".el-form-item__error");f&&f.remove(),this.unitSubmitFlag=!0}this.Form.leadingOfficeVo.leadingOfficeList.forEach(function(t,i){s++;var l=w(".leader-info").find(".unit-info-main").find(".content-item-group")[i],c=w(l).find(".group-item")[1],d=w(l).find(".group-item")[2],u=w(l).find(".group-item")[3],h=w(l).find(".group-item")[4];if(""===t.professionalId||null===t.professionalId){if(0===w(d).find(".el-form-item__error").length){var f=w(d).find("label").text(),g=w('<div class="el-form-item__error">'+f+"不能为空</div>");w(d).append(g)}e.professSubmitFlag=!1}else{a++;var p=w(d).find(".el-form-item__error");p&&p.remove()}if(""===t.leadingofficeName||null===t.leadingofficeName){if(0===w(u).find(".el-form-item__error").length){var m=w(u).find("label").text(),v=w('<div class="el-form-item__error">'+m+"不能为空</div>");w(u).append(v)}e.userNumSubmitFlag=!1}else{n++;var I=w(u).find(".el-form-item__error");I&&I.remove()}if(""===t.leadingofficeWorkStatueId||null===t.leadingofficeWorkStatueId){if(0===w(h).find(".el-form-item__error").length){var b=w(h).find("label").text(),y=w('<div class="el-form-item__error">'+b+"不能为空</div>");w(h).append(y)}e.workStatueNumSubmitFlag=!1}else{r++;var x=w(h).find(".el-form-item__error");x&&x.remove()}if(""===t.duty||null===t.duty){if(0===w(c).find(".el-form-item__error").length){var L=w(c).find("label").text(),j=w('<div class="el-form-item__error">'+L+"不能为空</div>");w(c).append(j)}e.dutyNumSubmitFlag=!1}else{o++;var E=w(c).find(".el-form-item__error");E&&E.remove()}}),a===s&&(this.professSubmitFlag=!0),n===s&&(this.userNumSubmitFlag=!0),r===s&&(this.workStatueNumSubmitFlag=!0),o===s&&(this.dutyNumSubmitFlag=!0)}else if(1===this.Form.isUse&&"2"===this.isLeader)if(""===this.Form.housingUseVoList[0].unitId||null===this.Form.housingUseVoList[0].unitId){var g=w(".unit-info").find(".unitId");if(0===w(g).find(".el-form-item__error").length){var p=w(g).find("label").text(),m=w('<div class="el-form-item__error">'+p+"不能为空</div>");w(g).append(m)}this.nonLeaderSumbitFlag=!1}else this.nonLeaderSumbitFlag=!0;if(1===this.Form.isUse&&"1"===this.isLeader&&this.baseSubmitFlag&&this.professSubmitFlag&&this.userNumSubmitFlag&&this.workStatueNumSubmitFlag&&this.unitSubmitFlag&&1===this.Form.houseTypeFlag){this.Form.unitIds&&this.Form.unitIds.length>0&&delete this.Form.unitIds;var v=JSON.parse(d()(this.Form)),I=!0;this.existHouseInfo.length>0&&this.existHouseInfo.forEach(function(t,i){t.houseId===v.houseId&&(e.existHouseInfo.splice(i,1,v),I=!1)}),I&&this.existHouseInfo.push(v);var b=JSON.parse(d()(this.Form));b.rent&&-1===this.rentHouseIds.indexOf(b.houseId)&&this.rentHouseIds.push(b.houseId),delete b.rent,b.houseUseArea=b.houseUseArea-0;for(var y=function(t){var i=b.leadingOfficeVo.leadingOfficeList[t];e.workStatue.forEach(function(e){i.leadingofficeWorkStatueId===e.key&&(i.leadingofficeWorkstatue=e.value)})},L=0;L<b.leadingOfficeVo.leadingOfficeList.length;L++)y(L);for(var j={},E=[],S=[],O=[],T=[],H=0;H<b.leadingOfficeVo.leadingOfficeList.length;H++){var N=b.leadingOfficeVo.leadingOfficeList[H];if(j[N.professionalId])j[N.professionalId].push(N);else{var C=[];C.push(N),j[N.professionalId]=C}}for(var M in j){var _={jobId:null,professionalId:parseInt(M),roomNum:j[M].length};E.push(_),O.push(parseInt(M))}if(void 0!==b.leadingOfficeVo.useRelationshipList&&b.leadingOfficeVo.useRelationshipList.length>0?(JSON.parse(d()(b.leadingOfficeVo.useRelationshipList)).forEach(function(e){if(S.push(e.professionalId),-1===O.indexOf(e.professionalId))e.roomNum=0,T.push(e);else{var t=O.indexOf(e.professionalId),i=E[t];i.jobId=e.jobId,T.push(i)}}),E.forEach(function(e){-1===S.indexOf(e.professionalId)&&T.push(e)}),b.leadingOfficeVo.useRelationshipList=T):b.leadingOfficeVo.useRelationshipList=E,1===this.isOldUse&&1===this.oldHouseType&&this.oldIsLeader!==this.isLeader)void 0===b.deleteUseUnitIds&&(b.deleteUseUnitIds=[]),b.deleteUseUnitIds.push(b.housingUseVoList[0].useunitId);else if(1===this.isOldUse&&1!==this.oldHouseType){void 0===b.deleteUseUnitIds&&(b.deleteUseUnitIds=[]),b.housingUseUnitList.forEach(function(e){b.deleteUseUnitIds.push(e.useunitId)});var D={useRelationshipList:[]};b.housingUseVoListClone.forEach(function(e){var t={jobId:e.useRelationshipList[0].jobId,roomNum:0};D.useRelationshipList.push(t)}),b.housingUseVoList.push(D)}void 0!==b.housingUseVoList&&delete b.housingUseVoList,void 0!==b.housingUseUnitList&&delete b.housingUseUnitList,void 0!==b.housingUseVoListClone&&delete b.housingUseVoListClone;var k=!0;this.editHouseInfo.length>0&&this.editHouseInfo.forEach(function(t,i){t.houseId===b.houseId&&(e.editHouseInfo.splice(i,1,b),k=!1)}),this.activeObject.isUse=!0,this.houseTypeColor.forEach(function(t){if(t.id===e.Form.housetypeId){var i=e.activeObject.getObjects("rect");if(i.length>0)i[0].set("fill",t.color);else e.activeObject.getObjects("path")[0].set("fill",t.color);e.canvas.requestRenderAll()}});var F=this.activeObject.getObjects("text"),A=!0,U=!0;if(F.length>0&&F.forEach(function(t){if("houseUseArea"===t.typeName){A=!1,t.set({text:e.Form.houseUseArea+"m²",scaleX:1,scaleY:1});var i=t.width,s=t.height,o=e.activeObject.width,a=e.activeObject.height,n=1,r=1;if(i+2*e.textWidthSpace>o){var l=o-2*e.textWidthSpace;t.scaleToWidth(l),n=t.scaleX}if(3*s+2*e.textHeightSpace>a){var c=(a-2*e.textHeightSpace)/3;t.scaleToHeight(c),r=t.scaleY}n>r?t.set({scaleX:r,scaleY:r}):n<r&&t.set({scaleX:n,scaleY:n})}if("houseNumber"===t.typeName){U=!1,t.set({text:""+e.Form.houseNumber,scaleX:1,scaleY:1});var d=t.width,u=t.height,h=e.activeObject.width,f=e.activeObject.height,g=1,p=1;if(d+2*e.textWidthSpace>h){var m=h-2*e.textWidthSpace;t.scaleToWidth(m),g=t.scaleX}if(3*u+2*e.textHeightSpace>f){var v=(f-2*e.textHeightSpace)/3;t.scaleToHeight(v),p=t.scaleY}g>p?t.set({scaleX:p,scaleY:p}):g<p&&t.set({scaleX:g,scaleY:g})}}),A){var R=new x.Text(this.Form.houseUseArea+"m²",{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),P=R.width,z=R.height,V=this.activeObject.width,G=this.activeObject.height,W=1,B=1;if(P+2*this.textWidthSpace>V){var Y=V-2*this.textWidthSpace;R.scaleToWidth(Y),W=R.scaleX}if(3*z+2*this.textHeightSpace>G){var X=(G-2*this.textHeightSpace)/3;R.scaleToHeight(X),B=R.scaleY}W>B?R.set({scaleX:B,scaleY:B}):W<B&&R.set({scaleX:W,scaleY:W}),R.toObject=(t=R.toObject,function(){return x.util.object.extend(t.call(this),{typeName:this.typeName})}),this.activeObject.add(R),R.typeName="houseUseArea"}if(U){var Z=new x.Text(""+this.Form.houseNumber,{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),J=Z.width,$=Z.height,Q=this.activeObject.width,K=this.activeObject.height,q=1,ee=1;if(J+2*this.textWidthSpace>Q){var te=Q-2*this.textWidthSpace;Z.scaleToWidth(te),q=Z.scaleX}if(3*$+2*this.textHeightSpace>K){var ie=(K-2*this.textHeightSpace)/3;Z.scaleToHeight(ie),ee=Z.scaleY}q>ee?Z.set({scaleX:ee,scaleY:ee}):q<ee&&Z.set({scaleX:q,scaleY:q}),Z.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(Z.toObject),this.activeObject.add(Z),Z.typeName="houseNumber"}var se=this.activeObject.getObjects("text");if(se.length>0){se.sort(function(e,t){return e.scaleX-t.scaleX});var oe=se[0].scaleX,ae=se[0].height;oe<1&&se.forEach(function(e){e.set({scaleX:oe,scaleY:oe})});var ne=Math.round(-ae*oe-this.textHeightSpace/2);se.forEach(function(e){"houseNumber"===e.typeName&&e.set({top:ne})})}this.canvas.requestRenderAll(),k&&this.editHouseInfo.push(b),this.dialogVisible=!1}else if(1===this.Form.isUse&&"2"===this.isLeader&&this.baseSubmitFlag&&this.nonLeaderSumbitFlag&&1===this.Form.houseTypeFlag){this.Form.unitIds&&this.Form.unitIds.length>0&&delete this.Form.unitIds;var re=JSON.parse(d()(this.Form)),le=!0;this.existHouseInfo.length>0&&this.existHouseInfo.forEach(function(t,i){t.houseId===re.houseId&&(e.existHouseInfo.splice(i,1,re),le=!1)}),le&&this.existHouseInfo.push(re);var ce=JSON.parse(d()(this.Form));if(ce.rent&&-1===this.rentHouseIds.indexOf(ce.houseId)&&this.rentHouseIds.push(ce.houseId),delete ce.rent,1===this.isOldUse&&1===this.oldHouseType&&this.oldIsLeader!==this.isLeader){var de=[];void 0===ce.deleteUseUnitIds&&(ce.deleteUseUnitIds=[]),ce.deleteUseUnitIds.push(ce.leadingOfficeVo.useunitId);var ue={deleteLeadingOfficeIds:[],useRelationshipList:[]};ce.leadingOfficeVo.leadingOfficeList.forEach(function(e){ue.deleteLeadingOfficeIds.push(e.leadingofficeId)}),ce.leadingOfficeVo.useRelationshipList.forEach(function(e){e.roomNum=0}),ue.useRelationshipList=ce.leadingOfficeVo.useRelationshipList,ue.unitId=ce.housingUseVoList[0].unitId,de.push(ue),ce.housingUseVoList=de}else if(1===this.isOldUse&&1!==this.oldHouseType){void 0===ce.deleteUseUnitIds&&(ce.deleteUseUnitIds=[]),ce.housingUseUnitList.forEach(function(e){ce.deleteUseUnitIds.push(e.useunitId)});var he={useRelationshipList:[]};ce.housingUseVoListClone.forEach(function(e){var t={jobId:e.useRelationshipList[0].jobId,roomNum:0};he.useRelationshipList.push(t)}),ce.housingUseVoList.push(he)}void 0!==ce.leadingOfficeVo&&delete ce.leadingOfficeVo,void 0!==ce.housingUseUnitList&&delete ce.housingUseUnitList,void 0!==ce.housingUseVoListClone&&delete ce.housingUseVoListClone,ce.houseUseArea=ce.houseUseArea-0;var fe=!0;this.editHouseInfo.length>0&&this.editHouseInfo.forEach(function(t,i){t.houseId===ce.houseId&&(e.editHouseInfo.splice(i,1,ce),fe=!1)}),this.activeObject.isUse=!0,this.houseTypeColor.forEach(function(t){if(t.id===e.Form.housetypeId){var i=e.activeObject.getObjects("rect");if(i.length>0)i[0].set("fill",t.color);else e.activeObject.getObjects("path")[0].set("fill",t.color);e.canvas.requestRenderAll()}});var ge=this.activeObject.getObjects("text"),pe=!0,me=!0;if(ge.length>0&&ge.forEach(function(t){if("houseUseArea"===t.typeName){pe=!1,t.set({text:e.Form.houseUseArea+"m²",scaleX:1,scaleY:1});var i=t.width,s=t.height,o=e.activeObject.width,a=e.activeObject.height,n=1,r=1;if(i+2*e.textWidthSpace>o){var l=o-2*e.textWidthSpace;t.scaleToWidth(l),n=t.scaleX}if(3*s+2*e.textHeightSpace>a){var c=(a-2*e.textHeightSpace)/3;t.scaleToHeight(c),r=t.scaleY}n>r?t.set({scaleX:r,scaleY:r}):n<r&&t.set({scaleX:n,scaleY:n})}if("houseNumber"===t.typeName){me=!1,t.set({text:""+e.Form.houseNumber,scaleX:1,scaleY:1});var d=t.width,u=t.height,h=e.activeObject.width,f=e.activeObject.height,g=1,p=1;if(d+2*e.textWidthSpace>h){var m=h-2*e.textWidthSpace;t.scaleToWidth(m),g=t.scaleX}if(3*u+2*e.textHeightSpace>f){var v=(f-2*e.textHeightSpace)/3;t.scaleToHeight(v),p=t.scaleY}g>p?t.set({scaleX:p,scaleY:p}):g<p&&t.set({scaleX:g,scaleY:g})}}),pe){var ve=new x.Text(this.Form.houseUseArea+"m²",{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),Ie=ve.width,be=ve.height,ye=this.activeObject.width,we=this.activeObject.height,xe=1,Le=1;if(Ie+2*this.textWidthSpace>ye){var je=ye-2*this.textWidthSpace;ve.scaleToWidth(je),xe=ve.scaleX}if(3*be+2*this.textHeightSpace>we){var Ee=(we-2*this.textHeightSpace)/3;ve.scaleToHeight(Ee),Le=ve.scaleY}xe>Le?ve.set({scaleX:Le,scaleY:Le}):xe<Le&&ve.set({scaleX:xe,scaleY:xe}),ve.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(ve.toObject),this.activeObject.add(ve),ve.typeName="houseUseArea"}if(me){var Se=new x.Text(""+this.Form.houseNumber,{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),Oe=Se.width,Te=Se.height,He=this.activeObject.width,Ne=this.activeObject.height,Ce=1,Me=1;if(Oe+2*this.textWidthSpace>He){var _e=He-2*this.textWidthSpace;Se.scaleToWidth(_e),Ce=Se.scaleX}if(3*Te+2*this.textHeightSpace>Ne){var De=(Ne-2*this.textHeightSpace)/3;Se.scaleToHeight(De),Me=Se.scaleY}Ce>Me?Se.set({scaleX:Me,scaleY:Me}):Ce<Me&&Se.set({scaleX:Ce,scaleY:Ce}),Se.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(Se.toObject),this.activeObject.add(Se),Se.typeName="houseNumber"}var ke=this.activeObject.getObjects("text");if(ke.length>0){ke.sort(function(e,t){return e.scaleX-t.scaleX});var Fe=ke[0].scaleX,Ae=ke[0].height;Fe<1&&ke.forEach(function(e){e.set({scaleX:Fe,scaleY:Fe})}),ke.forEach(function(t){"houseNumber"===t.typeName&&t.set({top:-Ae*Fe-e.textHeightSpace/2})})}this.canvas.requestRenderAll(),fe&&this.editHouseInfo.push(ce),this.dialogVisible=!1}else if(1===this.Form.isUse&&this.baseSubmitFlag&&1!==this.Form.houseTypeFlag){var Ue=JSON.parse(d()(this.Form));this.clearForm(Ue.leadingOfficeVo);var Re=!0;this.existHouseInfo.length>0&&this.existHouseInfo.forEach(function(t,i){t.houseId===Ue.houseId&&(e.existHouseInfo.splice(i,1,Ue),Re=!1)}),Ue.unitIds=[],Ue.unitIds.push(this.unitIds),Re&&this.existHouseInfo.push(Ue);var Pe=JSON.parse(d()(this.Form));if(Pe.rent&&-1===this.rentHouseIds.indexOf(Pe.houseId)&&this.rentHouseIds.push(Pe.houseId),delete Pe.rent,Pe.houseUseArea=Pe.houseUseArea-0,Pe.unitIds=[],Pe.unitIds.push(this.unitIds),1===this.isOldUse&&1===this.oldHouseType)if("1"===this.oldIsLeader){var ze=[];void 0===Pe.deleteUseUnitIds&&(Pe.deleteUseUnitIds=[]),Pe.deleteUseUnitIds.push(this.oldFormData.leadingOfficeVo.useunitId);var Ve={deleteLeadingOfficeIds:[],useRelationshipList:[]};this.oldFormData.leadingOfficeVo.leadingOfficeList.forEach(function(e){Ve.deleteLeadingOfficeIds.push(e.leadingofficeId)}),this.oldFormData.leadingOfficeVo.useRelationshipList.forEach(function(e){e.roomNum=0}),Ve.useRelationshipList=this.oldFormData.leadingOfficeVo.useRelationshipList,ze.push(Ve),Pe.housingUseVoList=ze,Pe.housingUseUnitList=[],Pe.unitIds.forEach(function(e){var t={};t.unitId=e,Pe.housingUseUnitList.push(t)}),delete Pe.leadingOfficeVo}else{void 0===Pe.deleteUseUnitIds&&(Pe.deleteUseUnitIds=[]),Pe.deleteUseUnitIds.push(Pe.housingUseVoList[0].useunitId);var Ge={},We={jobId:Pe.housingUseVoList[0].jobId,professionalId:Pe.housingUseVoList[0].professionalId,roomNum:0};Ge.useRelationshipList=[We],Ge.deleteLeadingOfficeIds=[Pe.housingUseVoList[0].leadingofficeId],Pe.housingUseVoList=[Ge],Pe.housingUseUnitList=[],Pe.unitIds.forEach(function(e){var t={};t.unitId=e,Pe.housingUseUnitList.push(t)}),delete Pe.leadingOfficeVo}else if(1===this.isOldUse&&1!==this.oldHouseType){void 0===Pe.deleteUseUnitIds&&(Pe.deleteUseUnitIds=[]);for(L=Pe.housingUseUnitList.length-1;L>-1;L--)-1===Pe.unitIds.indexOf(Pe.housingUseUnitList[L].unitId)&&(Pe.deleteUseUnitIds.push(Pe.housingUseUnitList[L].useunitId),Pe.housingUseUnitList.splice(L,1));var Be=[];Pe.housingUseUnitList.forEach(function(e){Be.push(e.unitId)}),Pe.unitIds.forEach(function(e){if(-1===Be.indexOf(e)){var t={};t.unitId=e,Pe.housingUseUnitList.push(t)}}),delete Pe.leadingOfficeVo,delete Pe.housingUseVoList}else Pe.housingUseUnitList=[],Pe.unitIds.forEach(function(e){var t={};t.unitId=e,Pe.housingUseUnitList.push(t)}),delete Pe.leadingOfficeVo,delete Pe.housingUseVoList;var Ye=!0;this.editHouseInfo.length>0&&this.editHouseInfo.forEach(function(t,i){t.houseId===Pe.houseId&&(e.editHouseInfo.splice(i,1,Pe),Ye=!1)}),this.activeObject.isUse=!0,this.houseTypeColor.forEach(function(t){if(t.id===e.Form.housetypeId){var i=e.activeObject.getObjects("rect");if(i.length>0)i[0].set("fill",t.color);else e.activeObject.getObjects("path")[0].set("fill",t.color);e.canvas.requestRenderAll()}}),this.dialogVisible=!1,Ye&&this.editHouseInfo.push(Pe);var Xe=this.activeObject.getObjects("text"),Ze=!0,Je=!0;if(Xe.length>0&&Xe.forEach(function(t){if("houseUseArea"===t.typeName){Ze=!1,t.set({text:e.Form.houseUseArea+"m²",scaleX:1,scaleY:1});var i=t.width,s=t.height,o=e.activeObject.width,a=e.activeObject.height,n=1,r=1;if(i+2*e.textWidthSpace>o){var l=o-2*e.textWidthSpace;t.scaleToWidth(l),n=t.scaleX}if(3*s+2*e.textHeightSpace>a){var c=(a-2*e.textHeightSpace)/3;t.scaleToHeight(c),r=t.scaleY}n>r?t.set({scaleX:r,scaleY:r}):n<r&&t.set({scaleX:n,scaleY:n})}if("houseNumber"===t.typeName){Je=!1,t.set({text:""+e.Form.houseNumber,scaleX:1,scaleY:1});var d=t.width,u=t.height,h=e.activeObject.width,f=e.activeObject.height,g=1,p=1;if(d+2*e.textWidthSpace>h){var m=h-2*e.textWidthSpace;t.scaleToWidth(m),g=t.scaleX}if(3*u+2*e.textHeightSpace>f){var v=(f-2*e.textHeightSpace)/3;t.scaleToHeight(v),p=t.scaleY}g>p?t.set({scaleX:p,scaleY:p}):g<p&&t.set({scaleX:g,scaleY:g})}}),Ze){var $e=new x.Text(this.Form.houseUseArea+"m²",{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),Qe=$e.width,Ke=$e.height,qe=this.activeObject.width,et=this.activeObject.height,tt=1,it=1;if(Qe+2*this.textWidthSpace>qe){var st=qe-2*this.textWidthSpace;$e.scaleToWidth(st),tt=$e.scaleX}if(3*Ke+2*this.textHeightSpace>et){var ot=(et-2*this.textHeightSpace)/3;$e.scaleToHeight(ot),it=$e.scaleY}tt>it?$e.set({scaleX:it,scaleY:it}):tt<it&&$e.set({scaleX:tt,scaleY:tt}),$e.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}($e.toObject),this.activeObject.add($e),$e.typeName="houseUseArea"}if(Je){var at=new x.Text(""+this.Form.houseNumber,{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),nt=at.width,rt=at.height,lt=this.activeObject.width,ct=this.activeObject.height,dt=1,ut=1;if(nt+2*this.textWidthSpace>lt){var ht=lt-2*this.textWidthSpace;at.scaleToWidth(ht),dt=at.scaleX}if(3*rt+2*this.textHeightSpace>ct){var ft=(ct-2*this.textHeightSpace)/3;at.scaleToHeight(ft),ut=at.scaleY}dt>ut?at.set({scaleX:ut,scaleY:ut}):dt<ut&&at.set({scaleX:dt,scaleY:dt}),at.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(at.toObject),this.activeObject.add(at),at.typeName="houseNumber"}var gt=this.activeObject.getObjects("text");if(gt.length>0){gt.sort(function(e,t){return e.scaleX-t.scaleX});var pt=gt[0].scaleX,mt=gt[0].height;pt<1&&gt.forEach(function(e){e.set({scaleX:pt,scaleY:pt})}),gt.forEach(function(t){"houseNumber"===t.typeName&&t.set({top:-mt*pt-e.textHeightSpace/2})})}this.canvas.requestRenderAll()}else if(0===this.Form.isUse&&this.baseSubmitFlag){this.Form.unitIds&&this.Form.unitIds.length>0&&delete this.Form.unitIds;var vt=JSON.parse(d()(this.Form));delete vt.housingUseVoList,delete vt.leadingOfficeVo;var It=!0;this.existHouseInfo.length>0&&this.existHouseInfo.forEach(function(t,i){t.houseId===vt.houseId&&(e.existHouseInfo.splice(i,1,vt),It=!1)}),It&&this.existHouseInfo.push(vt);var bt=JSON.parse(d()(this.Form));if(bt.houseUseArea=bt.houseUseArea-0,1===this.isOldUse&&1===this.oldHouseType)if("1"===this.oldIsLeader){var yt=[];void 0===bt.deleteUseUnitIds&&(bt.deleteUseUnitIds=[]),bt.deleteUseUnitIds.push(this.oldFormData.leadingOfficeVo.useunitId);var wt={deleteLeadingOfficeIds:[],useRelationshipList:[]};this.oldFormData.leadingOfficeVo.leadingOfficeList.forEach(function(e){wt.deleteLeadingOfficeIds.push(e.leadingofficeId)}),this.oldFormData.leadingOfficeVo.useRelationshipList.forEach(function(e){e.roomNum=0}),wt.useRelationshipList=this.oldFormData.leadingOfficeVo.useRelationshipList,yt.push(wt),bt.housingUseVoList=yt,bt.housingUseUnitList=[],bt.unitIds.forEach(function(e){var t={};t.unitId=e,bt.housingUseUnitList.push(t)}),delete bt.leadingOfficeVo}else{void 0===bt.deleteUseUnitIds&&(bt.deleteUseUnitIds=[]),bt.deleteUseUnitIds.push(bt.housingUseVoList[0].useunitId);var xt={},Lt={jobId:bt.housingUseVoList[0].jobId,professionalId:bt.housingUseVoList[0].professionalId,roomNum:0};xt.useRelationshipList=[Lt],xt.deleteLeadingOfficeIds=[bt.housingUseVoList[0].leadingofficeId],bt.housingUseVoList=[xt],bt.housingUseUnitList=[],bt.unitIds.forEach(function(e){var t={};t.unitId=e,bt.housingUseUnitList.push(t)}),delete bt.leadingOfficeVo}else if(1===this.isOldUse&&1!==this.oldHouseType){void 0===bt.deleteUseUnitIds&&(bt.deleteUseUnitIds=[]);for(var jt=bt.housingUseUnitList.length-1;jt>-1;jt--)bt.deleteUseUnitIds.push(bt.housingUseUnitList[jt].useunitId);delete bt.leadingOfficeVo,delete bt.housingUseVoList,delete bt.housingUseUnitList}else delete bt.housingUseVoList,delete bt.leadingOfficeVo,delete bt.housingUseUnitList;delete bt.housingUseVoListClone;var Et=!0;this.editHouseInfo.length>0&&this.editHouseInfo.forEach(function(t,i){t.houseId===bt.houseId&&(e.editHouseInfo.splice(i,1,bt),Et=!1)}),Et&&this.editHouseInfo.push(bt),this.dialogVisible=!1,this.activeObject.isUse=!1,this.houseTypeColor.forEach(function(t){if(t.id===e.Form.housetypeId){var i=e.activeObject.getObjects("rect");if(i.length>0)i[0].set("fill",t.color);else e.activeObject.getObjects("path")[0].set("fill",t.color)}});var St=this.activeObject.getObjects("text"),Ot=!0,Tt=!0;if(St.length>0&&St.forEach(function(t){if("houseUseArea"===t.typeName){Ot=!1,t.set({text:e.Form.houseUseArea+"m²",scaleX:1,scaleY:1});var i=t.width,s=t.height,o=e.activeObject.width,a=e.activeObject.height,n=1,r=1;if(i+2*e.textWidthSpace>o){var l=o-2*e.textWidthSpace;t.scaleToWidth(l),n=t.scaleX}if(3*s+2*e.textHeightSpace>a){var c=(a-2*e.textHeightSpace)/3;t.scaleToHeight(c),r=t.scaleY}n>r?t.set({scaleX:r,scaleY:r}):n<r&&t.set({scaleX:n,scaleY:n})}if("houseNumber"===t.typeName){Tt=!1,t.set({text:""+e.Form.houseNumber,scaleX:1,scaleY:1});var d=t.width,u=t.height,h=e.activeObject.width,f=e.activeObject.height,g=1,p=1;if(d+2*e.textWidthSpace>h){var m=h-2*e.textWidthSpace;t.scaleToWidth(m),g=t.scaleX}if(3*u+2*e.textHeightSpace>f){var v=(f-2*e.textHeightSpace)/3;t.scaleToHeight(v),p=t.scaleY}g>p?t.set({scaleX:p,scaleY:p}):g<p&&t.set({scaleX:g,scaleY:g})}}),Ot){var Ht=new x.Text(this.Form.houseUseArea+"m²",{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),Nt=Ht.width,Ct=Ht.height,Mt=this.activeObject.width,_t=this.activeObject.height,Dt=1,kt=1;if(Nt+2*this.textWidthSpace>Mt){var Ft=Mt-2*this.textWidthSpace;Ht.scaleToWidth(Ft),Dt=Ht.scaleX}if(3*Ct+2*this.textHeightSpace>_t){var At=(_t-2*this.textHeightSpace)/3;Ht.scaleToHeight(At),kt=Ht.scaleY}Dt>kt?Ht.set({scaleX:kt,scaleY:kt}):Dt<kt&&Ht.set({scaleX:Dt,scaleY:Dt}),Ht.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(Ht.toObject),this.activeObject.add(Ht),Ht.typeName="houseUseArea"}if(Tt){var Ut=new x.Text(""+this.Form.houseNumber,{strokeWidth:1,originX:"center",originY:"center",fontSize:20}),Rt=Ut.width,Pt=Ut.height,zt=this.activeObject.width,Vt=this.activeObject.height,Gt=1,Wt=1;if(Rt+2*this.textWidthSpace>zt){var Bt=zt-2*this.textWidthSpace;Ut.scaleToWidth(Bt),Gt=Ut.scaleX}if(3*Pt+2*this.textHeightSpace>Vt){var Yt=(Vt-2*this.textHeightSpace)/3;Ut.scaleToHeight(Yt),Wt=Ut.scaleY}Gt>Wt?Ut.set({scaleX:Wt,scaleY:Wt}):Gt<Wt&&Ut.set({scaleX:Gt,scaleY:Gt}),Ut.toObject=function(e){return function(){return x.util.object.extend(e.call(this),{typeName:this.typeName})}}(Ut.toObject),this.activeObject.add(Ut),Ut.typeName="houseNumber"}var Xt=this.activeObject.getObjects("text");if(Xt.length>0){Xt.sort(function(e,t){return e.scaleX-t.scaleX});var Zt=Xt[0].scaleX,Jt=Xt[0].height;Zt<1&&Xt.forEach(function(e){e.set({scaleX:Zt,scaleY:Zt})}),Xt.forEach(function(t){"houseNumber"===t.typeName&&t.set({top:-Jt*Zt-e.textHeightSpace/2})})}if(bt.rent){if(this.rentHouseIds.indexOf(bt.houseId)>-1){var $t=this.rentHouseIds.indexOf(bt.houseId);this.rentHouseIds.splice($t,1)}var Qt=this.activeObject.getObjects("rect");if(Qt.length>0)Qt[0].set("fill","rgb(254, 130, 0)");else this.activeObject.getObjects("path")[0].set("fill","rgb(254, 130, 0)")}delete bt.rent,this.canvas.requestRenderAll()}},saveAllInfo:function(){var e=this,t=sessionStorage.getItem("yardId"),i=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName"),o=sessionStorage.getItem("name"),a=sessionStorage.getItem("userId"),n=this.canvas.toJSON(["uuid","isExcess","isRecorded","isUse","typeName","pathLeft","pathTop","pathPoint","roomType","oldLeft","oldTop","oldCoord"]),r=n.objects&&n.objects.length>0?n:null,l=new Object;this.houseVoList.forEach(function(e){1===e.isUse&&e.leadingOfficeVo&&e.leadingOfficeVo.unitId&&e.leadingOfficeVo.leadingOfficeList&&e.leadingOfficeVo.leadingOfficeList.length>0&&e.leadingOfficeVo.leadingOfficeList.forEach(function(e){delete e.professionOpts,delete e.professionalLevel})});var c=!1,d=0,u=this.houseVoList.length;r&&r.objects.forEach(function(e){"group"===e.type&&"room"===e.typeName&&(d+=1)}),d>=u&&(c=!0),c?(l.houseVoList=this.houseVoList,l.addHouseIdList=this.addHouseIdList,l.delHouseIdList=this.delHouseIdList,l.recordHolder=o,l.recordHolderId=a,l.configureIds=this.configureIdList,l.rentHouseIds=this.rentHouseIds,l.jsonPlanVo={jsonPlan:r,yardId:t,buildId:i,floorName:s},l.yardId=t,l.buildId=i,l.floorName=s,Object(f.C)(l).then(function(t){e.$message({message:"保存成功",type:"success"}),e.editHouseInfo=[],e.AddHouseId=[],e.deleteHouseId=[],e.houseVoList=[],e.addHouseIdList=[],e.delHouseIdList=[],e.rentHouseIds=[],e.configDialogVisible=!1,e.getAllHouseInfo(i,s),e.getHouseGraphJson(i,s,!1)}).catch(function(t){var o=t.result?t.result:"保存失败";e.$message({message:o,type:"error"}),e.editHouseInfo=[],e.AddHouseId=[],e.deleteHouseId=[],e.houseVoList=[],e.addHouseIdList=[],e.delHouseIdList=[],e.rentHouseIds=[],e.getAllHouseInfo(i,s),e.getHouseGraphJson(i,s,!1)})):this.$message({message:"保存失败",type:"error"})},allSave:function(){var e=this,t=sessionStorage.getItem("buildId"),i=sessionStorage.getItem("floorName");if(!t||!i)return this.$message({message:"请先选择楼层",type:"warning"}),!1;this.houseVoList=[],this.addHouseIdList=[],this.delHouseIdList=[],this.canvas.getObjects("group").forEach(function(t){e.editHouseInfo.forEach(function(i){t.uuid===i.houseId&&e.houseVoList.push(i)}),e.AddHouseId.forEach(function(i){t.uuid===i&&e.addHouseIdList.push(i)})}),this.delHouseIdList=this.deleteHouseId,this.isConfigFloor?(this.updateIdList=[],this.houseVoList.forEach(function(t){e.updateIdList.push(t.houseId)}),this.delHouseIdList.forEach(function(t){e.updateIdList.push(t)}),this.updateIdList.length>0?(this.configureListByHouseId(this.updateIdList),this.getConfigureIdList(this.updateIdList)):(this.configureIdList=[],this.saveAllInfo())):(this.configureIdList=[],this.saveAllInfo())},getConfigureIdList:function(e){var t=this;Object(h.f)(e).then(function(e){e&&e.length>0?(t.configureIdList=e,t.configDialogVisible=!0):(t.configureIdList=[],t.saveAllInfo())}).catch(function(e){var i=e.result?e.result:"房间关联的配置ID获取失败";t.$message({message:i,type:"error"})})},verificationNull:function(e){var t=this,i=0;e.forEach(function(e){var s="";s="unitIds"!==e?t.Form[e]:t.unitIds;var o=w("."+e);if(""===s||null===s){var a=o.find("label").text();if(0===w("."+e).find(".el-form-item__error").length){var n=w('<div class="el-form-item__error">'+a+"不能为空</div>");o.append(n)}t.baseSubmitFlag=!1}else{var r=w("."+e).find(".el-form-item__error");r&&r.remove(),i++}}),i===e.length&&(this.baseSubmitFlag=!0)},getDataType:function(e){var t=!0,i=!1,s=void 0;try{for(var o,a=l()(["String","Object","Number","Array","Date"]);!(t=(o=a.next()).done);t=!0){var n=o.value;if(Object.prototype.toString.call(e)==="[object "+n+"]")return n}}catch(e){i=!0,s=e}finally{try{!t&&a.return&&a.return()}finally{if(i)throw s}}},clearForm:function(e){for(var t in e){var i=this.getDataType(e[t]);if("String"===i)e[t]="";else if("Array"===i)e[t]=[];else if("Object"===i){n()(e[t]).length>0?this.clearForm(e[t]):e[t]={}}else e[t]=null}},dialogClosed:function(){this.isLeader="1",this.unitIds="",this.oldIsLeader=null,this.oldHouseType=null,this.isOldUse=null,this.oldFormData=null,this.deleteHousingUseVoList=[],w(".el-form-item__error").remove(),this.baseSubmitFlag=!0,this.unitSubmitFlag=!0,this.professSubmitFlag=!0,this.userNumSubmitFlag=!0,this.workStatueNumSubmitFlag=!0,this.nonLeaderSumbitFlag=!0,delete this.Form.rent,this.Form.housingUseVoList=[],this.Form.leadingOfficeVo={},this.clearForm(this.Form),this.Form.isUse=1,this.Form.isIdle=0,this.Form.housingUseVoList=[{useunitId:null,unitId:null,housinguseId:null,useRelationshipList:[],deleteLeadingOfficeIds:[],leadingOfficeList:[],useForm:null,distributionTime:null,departmentName:null}],this.Form.leadingOfficeVo={useunitId:null,unitId:null,useRelationshipList:[],deleteLeadingOfficeIds:[],leadingOfficeList:[{duty:"",leadingofficeId:null,leadingofficeName:"",leadingofficeWorkstatue:null,leadingofficeWorkStatueId:null,professionalId:null,professionalLevel:null,professionOpts:[]}]}},addProfessionItem:function(){this.Form.leadingOfficeVo.leadingOfficeList.push({duty:"",leadingofficeId:null,leadingofficeName:"",leadingofficeWorkstatue:"",leadingofficeWorkStatueId:null,professionalId:null,professionalLevel:null,professionOpts:[]})},deleteProfessionItem:function(e){var t=this.Form.leadingOfficeVo.leadingOfficeList[e].leadingofficeId;this.Form.leadingOfficeVo.leadingOfficeList.splice(e,1),t&&(void 0===this.Form.leadingOfficeVo.deleteLeadingOfficeIds&&(this.Form.leadingOfficeVo.deleteLeadingOfficeIds=[]),this.Form.leadingOfficeVo.deleteLeadingOfficeIds.push(t))},getHouseGraphJson:function(e,t,i){var s=this;i&&!this.loading&&(this.loading=this.$loading({target:".plane",lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})),this.existHouseId=[],this.activeBtnIndex=0,this.textbox&&(this.textbox.exitEditing(),this.textbox=null),Object(f.r)(e,t).then(function(e){if(""===e||null===e)return i&&s.loading&&(s.loading.close(),s.loading=null,s.$message({message:"该楼层暂无示意图",type:"warning"})),s.canvas.clear(),s.$refs.threeD.clear(),s.tool("move",0),!1;s.canvas.loadFromJSON(e,function(){var e=s.canvas.getObjects("line"),t=s.canvas.getObjects("group");e.length>0&&e.forEach(function(e,t){e.hasControls=!1}),t.length>0&&t.forEach(function(e,t){"room"===e.typeName&&s.existHouseId.push(e.uuid),"room"===e.typeName&&"path"===e.roomType&&(e.hasControls=!1)}),i&&s.loading&&(s.loading.close(),s.loading=null),s.tool("move",0)})}).catch(function(e){i&&s.loading&&(s.loading.close(),s.loading=null),s.$message({message:e.result?e.result:"示意图加载失败！",type:"error"}),s.canvas.clear(),s.$refs.threeD.clear(),s.tool("move",0)})},initWebgl:function(){var e=this;this.wall_coordinate=[];var t=this.canvas.getObjects("group");t.length>0&&t.forEach(function(t,i){if("room"===t.typeName){var s=t.getObjects("rect"),o=t.getObjects("path");if(s.length>0){e.existHouseId.push(t.uuid);var a=[],n=[],r=[],l=[],c=JSON.parse(d()(t.aCoords));for(var u in c)c[u].x=c[u].x*e.threeSacle,c[u].y=c[u].y*e.threeSacle;a.push(c.tl),a.push(c.tr),n.push(c.tr),n.push(c.br),r.push(c.tl),r.push(c.bl),l.push(c.bl),l.push(c.br),e.wall_coordinate.push(a),e.wall_coordinate.push(n),e.wall_coordinate.push(r),e.wall_coordinate.push(l)}else if(o.length>0){for(var h=o[0].path,f=0;f<h.length;f++){var g=h[f],p=h[f+1],m=[];"M"!==g[0]&&"L"!==g[0]||!p||"z"===p[0]||(m.push({x:g[1]*e.threeSacle,y:g[2]*e.threeSacle}),m.push({x:p[1]*e.threeSacle,y:p[2]*e.threeSacle}),e.wall_coordinate.push(m))}var v=[],I=h[0],b=h[h.length-2];v.push({x:b[1]*e.threeSacle,y:b[2]*e.threeSacle}),v.push({x:I[1]*e.threeSacle,y:I[2]*e.threeSacle}),e.wall_coordinate.push(v)}}});var i=this.canvas.getObjects("line");i.length>0&&i.forEach(function(t){var i=JSON.parse(d()(t.aCoords));if(t.width>0&&0===t.height){var s=[];s.push({x:i.tl.x*e.threeSacle,y:i.tl.y*e.threeSacle}),s.push({x:i.tr.x*e.threeSacle,y:i.tr.y*e.threeSacle}),e.wall_coordinate.push(s)}else if(0===t.width&&t.height>0){var o=[];o.push({x:i.tr.x*e.threeSacle,y:i.tr.y*e.threeSacle}),o.push({x:i.br.x*e.threeSacle,y:i.br.y*e.threeSacle}),e.wall_coordinate.push(o)}else if(t.width>0&&t.height>0)if(t.x1>0&&t.y1>0||t.x1<0&&t.y1<0){var a=[];a.push({x:i.tl.x*e.threeSacle,y:i.tl.y*e.threeSacle}),a.push({x:i.br.x*e.threeSacle,y:i.br.y*e.threeSacle}),e.wall_coordinate.push(a)}else if(t.x1>0&&t.y1<0||t.x1<0&&t.y1>0){var n=[];n.push({x:i.tr.x*e.threeSacle,y:i.tr.y*e.threeSacle}),n.push({x:i.bl.x*e.threeSacle,y:i.bl.y*e.threeSacle}),e.wall_coordinate.push(n)}}),(t.length>0||i.length>0)&&(this.loading=this.$loading({target:".threeD",lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}),this.$refs.threeD.init(this.wall_coordinate))},initWebglFinished:function(){this.loading.close()},getAllHouseInfo:function(e,t){var i=this,s=!1;Object(f.l)(e,t).then(function(e){console.log(e),i.originalHouseInfo=JSON.parse(d()(e)),i.existHouseInfo=JSON.parse(d()(e)),i.originalHouseInfo.forEach(function(e){e.rent&&(e.isUse=0,e.isIdle=0),!1===s&&(e.rent||1===e.isUse)&&(s=!0)}),i.showViewBtn=!1!==s,i.existHouseInfo.forEach(function(e){e.houseUseArea=e.houseUseArea?e.houseUseArea.toFixed(2):"",e.rent?(e.isUse=0,e.isIdle=0):(e.unitIds=[],void 0!==e.housetypeId&&1!==e.housetypeId&&e.housingUseUnitList&&e.housingUseUnitList.length>0&&(e.unitIds.push(e.housingUseUnitList[0].unitId),e.housingUseVoListClone=JSON.parse(d()(e.housingUseVoList)),delete e.housingUseVoList))})}).catch(function(e){var t=e.result?e.result:"楼层房间信息获取失败";i.$message({message:t,type:"error"})})},isRecorded:function(e){return new o.a(function(t){var i=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName");Object(f.l)(i,s).then(function(i){if(i&&i.length>0){for(var s=0;s<i.length;s++)if(i[s].houseId===e){var o=i[s].isRecord;t(o&&1===o?1:null)}}else t(null)})})},accessoryHandle:function(e){var t=this,i=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName");if(!i||!s)return this.$message({message:"请先选择楼层",type:"warning"}),!1;this.oldActiveIconIndex=this.activeIconIndex,this.activeIconIndex=e,this.accessoryDialogVisible=!0,Object(f.E)(i,s).then(function(e){e&&e.length>0&&e.forEach(function(e,i){var s={name:e.floordrawingFileName,id:e.floordrawingId};t.fileList.push(s)})}).catch(function(e){var i=e.result?e.result:"CAD获取失败";t.$message({message:i,type:"error"})})},accessoryDialogClosed:function(){this.accessoryDialogVisible=!1,this.fileList=[],this.CADDownload=[],this.activeIconIndex=this.oldActiveIconIndex,this.oldActiveIconIndex=null},beforeAvatarUpload:function(e){var t=e.size/1024/1024<200;return t||this.$message.error("上传CAD大小不能超过200MB!"),t},handleRemove:function(e,t){var i=this,s=[];s.push(e.id),Object(f.g)(s).then(function(t){i.$message({message:"CAD删除成功",type:"success"}),i.fileList.forEach(function(t,s){t.id===e.id&&i.fileList.splice(s,1)})}).catch(function(e){var t=e.result?e.result:"CAD删除失败";i.$message({message:t,type:"error"})})},handleSuccess:function(e,t,i){var s=this,o=sessionStorage.getItem("buildId"),a=sessionStorage.getItem("floorName");if(o&&a){var n={};n.buildId=o,n.floor=a,n.floordrawingFileName=e.imgList[0].originalName.originalFile,n.floordrawingUrl=e.imgList[0].imgPath,Object(f.D)(n).then(function(e){s.fileList=i,s.fileList[s.fileList.length-1].id=e.floordrawingId,s.$message({message:"CAD上传成功",type:"success"})}).catch(function(e){i.splice(i.length-1,1),s.fileList=i;var t=e.result?e.result:"CAD上传失败";s.$message({message:t,type:"error"})})}},handleError:function(e,t,i){401===e.status&&(this.$store.dispatch("Logout",this.token),this.$router.push({path:"/login"}));var s=e.message?e.message:"附件上传失败";this.$message({message:s,type:"error"})},checkboxChange:function(e,t){if(!0===e)-1===this.CADDownload.indexOf(t)&&this.CADDownload.push(t);else{var i=this.CADDownload.indexOf(t);i>-1&&this.CADDownload.splice(i,1)}},downloadCAD:function(){var e=this,t={},s=sessionStorage.getItem("buildId"),o=sessionStorage.getItem("floorName");t.buildId=s,t.floorName=o,t.floorDrawingIdList=this.CADDownload,this.CADDownload.length>0?Object(f.k)(t).then(function(e){i("3UNf")(e,decodeURIComponent(sessionStorage.getItem("CADdownloadFileName")))}).catch(function(t){var i=t.result?t.result:"CAD下载失败";e.$message({message:i,type:"error"})}):this.$message({message:"请先选中一个CAD文件",type:"warning"})},planeDisplay:function(){var e=sessionStorage.getItem("buildId"),t=sessionStorage.getItem("floorName");if(!e||!t)return this.$message({message:"请先选择楼层",type:"warning"}),!1;this.activeBtnIndex=0},threeDisplay:function(){if(!1===this.webglFlag)return this.$message({message:"该浏览器不支持3D显示功能！",type:"warning"}),!1;var e=sessionStorage.getItem("buildId"),t=sessionStorage.getItem("floorName");if(!e||!t)return this.$message({message:"请先选择楼层",type:"warning"}),!1;this.activeBtnIndex=1,this.initWebgl()},limitFloat:function(e,t){this.Form[e]=this.Form[e].replace(/[^\d.]/g,"").replace(/\.{2,}/g,".").replace(".","$#$").replace(/\./g,"").replace("$#$",".").replace(/^(\-)*(\d+)\.(\d\d).*$/,"$1$2.$3").replace(/^\./g,""),t&&""!==this.Form[e]&&(this.Form[e]=(this.Form[e]-0).toFixed(2))},houseTypeChange:function(e){for(var t=0;t<this.houseType.length;t++)this.houseType[t].housetypeId===e&&(this.Form.houseTypeFlag=this.houseType[t].houseTypeFlag)},clearCanvas:function(){this.canvas&&this.canvas.clear&&this.canvas.clear(),sessionStorage.removeItem("yardId"),sessionStorage.removeItem("buildId"),sessionStorage.removeItem("floorName"),this.drawType=null,this.popoverDoorIcon=!1},getRouterList:function(){var e=this;Object(h.i)().then(function(t){e.allNavList=t}).catch(function(t){var i=t.result?t.result:"路由信息获取失败！";e.$message({message:i,type:"error"})})},copyRoom:function(){var e=this,t=sessionStorage.getItem("buildId"),i=sessionStorage.getItem("floorName");if(!t||!i)return this.$message({message:"请先选择楼层",type:"warning"}),!1;var s=this.canvas.getActiveObject();s?("activeSelection"===s.type?s.clone(function(t){e.copiedGraphData=t,e.copiedGraphData.forEachObject(function(e){"group"===e.type&&"room"===e.typeName&&(e.forEachObject(function(t){"rect"!==t.type&&"path"!==t.type?e.remove(t):t.set({fill:"rgba(204, 204, 204, 1)"})}),e.isExcess=!1,e.isRecorded=!1,e.isUse=!1,e.uuid="")})},["typeName","pathLeft","pathTop","pathPoint","roomType","oldLeft","oldTop","oldCoord"]):"group"===s.type&&"room"===s.typeName?s.clone(function(t){for(var i=t._objects.length-1;i>=0;i--){var s=t._objects[i];"rect"!==s.type&&"path"!==s.type?t.remove(s):s.set({fill:"rgba(204, 204, 204, 1)"})}t.isExcess=!1,t.isRecorded=!1,t.isUse=!1,t.uuid="",e.copiedGraphData=t},["typeName","pathLeft","pathTop","pathPoint","roomType","oldLeft","oldTop","oldCoord"]):s.clone(function(t){e.copiedGraphData=t},["typeName","oldLeft","oldTop","oldCoord"]),this.canvas.requestRenderAll(),this.$message({message:"已复制",type:"success"})):this.$message({message:"请先选择要复制的图形",type:"warning"})},pasteRoom:function(){var e=this,t=sessionStorage.getItem("buildId"),i=sessionStorage.getItem("floorName");return t&&i?this.copiedGraphData?("activeSelection"===this.copiedGraphData.type?this.copiedGraphData.clone(function(t){e.canvas.discardActiveObject(),t.canvas=e.canvas,t.forEachObject(function(t){if("group"===t.type&&"room"===t.typeName){var i=L();t.uuid=i,e.AddHouseId.push(i)}e.canvas.add(t)}),t.setCoords(),canvas.setActiveObject(t),canvas.requestRenderAll()},["typeName","pathLeft","pathTop","pathPoint","roomType","oldLeft","oldTop","oldCoord"]):"group"===this.copiedGraphData.type&&"room"===this.copiedGraphData.typeName?this.copiedGraphData.clone(function(t){e.canvas.discardActiveObject();var i=L();t.uuid=i,e.AddHouseId.push(i),e.canvas.add(t),e.canvas.setActiveObject(t),e.canvas.requestRenderAll()},["typeName","pathLeft","pathTop","pathPoint","roomType","oldLeft","oldTop","oldCoord"]):this.copiedGraphData.clone(function(t){e.canvas.discardActiveObject(),e.canvas.add(t),e.canvas.setActiveObject(t),e.canvas.requestRenderAll()},["typeName","oldLeft","oldTop","oldCoord"]),void this.$message({message:"已粘贴",type:"success"})):(this.$message({message:"请先复制",type:"warning"}),!1):(this.$message({message:"请先选择楼层",type:"warning"}),!1)},addStairs:function(){var e=this,t=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName");if(!t||!s)return this.$message({message:"请先选择楼层",type:"warning"}),!1;x.loadSVGFromURL(i("acqc"),function(t,i){var s,o=x.util.groupSVGElements(t,i);o.set({left:59,top:260}),o.toObject=(s=o.toObject,function(){return x.util.object.extend(s.call(this),{typeName:this.typeName})}),o.typeName="stairs",e.canvas.add(o),e.canvas.requestRenderAll(),e.tool("move",0)})},addElevator:function(){var e=this,t=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName");if(!t||!s)return this.$message({message:"请先选择楼层",type:"warning"}),!1;x.loadSVGFromURL(i("26Lr"),function(t,i){var s,o=x.util.groupSVGElements(t,i);o.set({left:59,top:300}),o.toObject=(s=o.toObject,function(){return x.util.object.extend(s.call(this),{typeName:this.typeName})}),o.typeName="elevator",e.canvas.add(o),e.canvas.requestRenderAll(),e.tool("move",0)})},keyToDelete:function(e){var t=this;if(46===e.keyCode){var i=!0;this.activeList=this.canvas.getActiveObjects(),this.activeList.length>0&&(this.activeList.forEach(function(e){if("group"===e.type&&"room"===e.typeName&&t.originalHouseInfo.length>0)for(var s=0;s<t.originalHouseInfo.length;s++){var o=t.originalHouseInfo[s];if(o.houseId===e.uuid){if(e.actualDeleteflag=!0,void 0!==o.rent)return t.$message({message:"已经租借的房间不能删除",type:"warning"}),i=!1,!1;if(void 0!==o.repairModuleId)return t.$message({message:"关联维修的房间不能再次删除",type:"warning"}),i=!1,!1}}}),i&&this.activeList.forEach(function(e){e.actualDeleteflag&&t.deleteHouseId.push(e.uuid);for(var i=0;i<t.AddHouseId.length;i++)if(t.AddHouseId[i]===e.uuid){t.AddHouseId.splice(i,1);break}for(var s=0;s<t.editHouseInfo.length;s++)if(t.editHouseInfo[s].houseId===e.uuid){t.editHouseInfo.splice(s,1);break}t.canvas.remove(e)}),this.canvas.discardActiveObject(),this.canvas.requestRenderAll(),this.activeList=[])}},startView:function(){var e=this,t=sessionStorage.getItem("yardId"),i=sessionStorage.getItem("buildId"),s=sessionStorage.getItem("floorName"),o=sessionStorage.getItem("unitId")||null;if(this.editHouseInfo.length>0||this.AddHouseId.length>0||this.deleteHouseId.length>0)this.$confirm("当前楼层数据还未保存，可点击右下角保存按钮保存，如若切换楼层将清空刚才所编辑的楼层数据，是否继续此操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(!i||!s)return e.$message({message:"请先选择楼层",type:"warning"}),!1;e.$router.push({name:"houseGraphView",params:{yardId:t,buildId:i,floorName:s,unitId:o,flag:!0}})}).catch(function(){e.$message({type:"info",message:"已取消切换"})});else{if(!i||!s)return this.$message({message:"请先选择楼层",type:"warning"}),!1;this.$router.push({name:"houseGraphView",params:{yardId:t,buildId:i,floorName:s,unitId:o,flag:!0}})}},configDialogClosed:function(){this.configTableData=[],this.configCurrentPage=1,this.configTableTotal=0},configCurrentChange:function(e){this.configCurrentPage=e,this.configureListByHouseId(this.updateIdList)},configureListByHouseId:function(e){var t=this;Object(h.a)(this.configCurrentPage,this.configPageSize,e).then(function(e){t.configTableData=e.records,t.configTableTotal=e.total,t.configTableData.forEach(function(e){e.configureDate=t.formatDate(e.configureDate)})}).catch(function(e){var i=e.result?e.result:"房间关联的配置获取失败";t.$message({message:i,type:"error"})})},formatDate:function(e,t){var i=new Date(e),s=t||"yyyy-MM-dd",o={"M+":i.getMonth()+1,"d+":i.getDate(),"h+":i.getHours(),"m+":i.getMinutes(),"s+":i.getSeconds(),"q+":Math.floor((i.getMonth()+3)/3),S:i.getMilliseconds()};for(var a in/(y+)/.test(s)&&(s=s.replace(RegExp.$1,(i.getFullYear()+"").substr(4-RegExp.$1.length))),o)new RegExp("("+a+")").test(s)&&(s=s.replace(RegExp.$1,1==RegExp.$1.length?o[a]:("00"+o[a]).substr((""+o[a]).length)));return s},showWebgl:function(){y.a.webgl||(this.webglFlag=!1,this.$alert("该浏览器不支持webgl，无法使用3D显示功能，建议使用高版本的谷歌浏览器查看。","关于3D显示的提醒",{type:"warning",confirmButtonText:"确定"}))},merge:function(){var e,t=this,i=this.canvas.getActiveObject();if(i){if("activeSelection"===i.type){var s=[],o=!0;if(i.forEachObject(function(e){if("line"===e.type){var i=e.oldCoord;s.push([i.x1,i.y1]),s.push([i.x2,i.y2]),t.canvas.remove(e)}else o&&(t.$message({message:"只有线段才能做合并操作",type:"warning"}),o=!1)}),!o)return!1;for(var a="",n=0;n<s.length;n++)a+=0===n?"M "+s[n][0]+" "+s[n][1]+" ":"L "+s[n][0]+" "+s[n][1]+" ";a+="z";var r=new x.Path(a,{stroke:this.color,strokeWidth:this.drawWidth,fill:"rgba(204, 204, 204, 1)"}),l=new x.Group([r],{hasControls:!1});l.toObject=(e=l.toObject,function(){return x.util.object.extend(e.call(this),{uuid:this.uuid,isUse:this.isUse,typeName:this.typeName,pathLeft:this.pathLeft,pathTop:this.pathTop,pathPoint:this.pathPoint,roomType:this.roomType})}),this.canvas.add(l);var c=L();l.uuid=c,l.typeName="room",l.pathLeft=l.left,l.pathTop=l.top,l.pathPoint=s,l.roomType="path",this.canvas.requestRenderAll(),this.AddHouseId.push(c)}}else this.$message({message:"请先选择要合并的线段",type:"warning"})}},created:function(){if(this.$route.params.yardId&&this.$route.params.buildId&&this.$route.params.floorName){sessionStorage.setItem("yardId",this.$route.params.yardId),sessionStorage.setItem("buildId",this.$route.params.buildId),sessionStorage.setItem("floorName",this.$route.params.floorName),this.$route.params.unitId&&sessionStorage.setItem("unitId",this.$route.params.unitId);var e={};e.yardId=this.$route.params.yardId,e.buildId=this.$route.params.buildId,e.floorName=this.$route.params.floorName,this.startEditObj=e,this.$emit("startEdit",e)}},mounted:function(){var e=this;this.showWebgl(),this.$nextTick(function(){e.init()}),this.token=sessionStorage.getItem("TOKEN"),this.token&&(this.postHeaders.Authorization="Bearer "+this.token),window.addEventListener("keyup",this.keyToDelete,!1),this.getOptionsList(),this.getRouterList(),g.a.$off("getGraphJson"),g.a.$off("clearCanvas"),g.a.$off("showSaveTips"),g.a.$off("collapse"),g.a.$on("getGraphJson",function(t){Object(h.m)(t.buildId,[t.floorName]).then(function(t){t?(e.isConfigFloor=!0,e.$confirm("该楼层房间关联了配置，如修改或删除房间信息，可能会还原分配方案。","提示",{confirmButtonText:"确定",showCancelButton:!1,type:"warning",center:!0}).then(function(){})):e.isConfigFloor=!1}).catch(function(t){var i=t.result?t.result:"是否关联配置获取失败";e.$message({message:i,type:"error"})}),e.editHouseInfo.length>0||e.AddHouseId.length>0||e.deleteHouseId.length>0?e.$confirm("当前楼层数据还未保存，可点击右下角保存按钮保存，如若切换楼层将清空刚才所编辑的楼层数据，是否继续此操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.editHouseInfo=[],e.AddHouseId=[],e.deleteHouseId=[],e.houseVoList=[],e.addHouseIdList=[],e.delHouseIdList=[],e.rentHouseIds=[],e.clearCanvas(),sessionStorage.setItem("yardId",t.yardId),sessionStorage.setItem("buildId",t.buildId),sessionStorage.setItem("floorName",t.floorName),e.getHouseGraphJson(t.buildId,t.floorName,!0),e.getAllHouseInfo(t.buildId,t.floorName)}).catch(function(){g.a.$emit("activeTree"),e.$message({type:"info",message:"已取消切换"})}):(sessionStorage.setItem("yardId",t.yardId),sessionStorage.setItem("buildId",t.buildId),sessionStorage.setItem("floorName",t.floorName),e.getHouseGraphJson(t.buildId,t.floorName,!0),e.getAllHouseInfo(t.buildId,t.floorName))}),g.a.$on("clearCanvas",function(){e.clearCanvas()}),g.a.$on("showSaveTips",function(t,i){if(e.editHouseInfo.length>0||e.AddHouseId.length>0||e.deleteHouseId.length>0)e.$confirm("当前楼层数据还未保存，可点击右下角保存按钮保存，如若切换楼层将清空刚才所编辑的楼层数据，是否继续此操作？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(t)if("/login"===t){var s=sessionStorage.getItem("TOKEN");e.$router.replace({path:t}),e.$store.dispatch("Logout",s)}else i&&e.$store.commit("changeNavList",i),e.$router.push(t);else e.editHouseInfo=[],e.AddHouseId=[],e.deleteHouseId=[],e.houseVoList=[],e.addHouseIdList=[],e.delHouseIdList=[],e.rentHouseIds=[],e.clearCanvas()}).catch(function(){g.a.$emit("activeTree"),e.$message({type:"info",message:"已取消切换"})});else if(t)if("/login"===t){var s=sessionStorage.getItem("TOKEN");e.$router.replace({path:t}),e.$store.dispatch("Logout",s)}else i&&e.$store.commit("changeNavList",i),e.$router.push(t);else e.editHouseInfo=[],e.AddHouseId=[],e.deleteHouseId=[],e.houseVoList=[],e.addHouseIdList=[],e.delHouseIdList=[],e.rentHouseIds=[],e.clearCanvas()}),g.a.$on("collapse",function(){setTimeout(function(){e.setZoom()},1e3)})}},E={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"houseGraph"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:0===e.activeBtnIndex,expression:"activeBtnIndex === 0"}],staticClass:"plane"},[i("div",{staticClass:"tools-box"},[i("ul",{staticClass:"tools"},[i("el-tooltip",{staticClass:"item",attrs:{content:"移动",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-move-black",class:{"acitive-icon":0===e.activeIconIndex},on:{click:function(t){e.tool("move",0)}}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"实线",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-line-black",class:{"acitive-icon":1===e.activeIconIndex},on:{click:function(t){e.tool("line",1)}}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"虚线",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-dottedline-black",class:{"acitive-icon":2===e.activeIconIndex},on:{click:function(t){e.tool("dottedline",2)}}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"房间",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-rectangle-black",class:{"acitive-icon":3===e.activeIconIndex},on:{click:function(t){e.tool("rectangle",3)}}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"文字",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-text-black",class:{"acitive-icon":4===e.activeIconIndex},on:{click:function(t){e.tool("text",4)}}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"门",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-door-black",class:{"acitive-icon":6===e.activeIconIndex},on:{click:function(t){e.tool("door",6)}}},[i("el-popover",{attrs:{placement:"right",width:"108",trigger:"click","popper-class":"door-icon-popper"},model:{value:e.popoverDoorIcon,callback:function(t){e.popoverDoorIcon=t},expression:"popoverDoorIcon"}},[i("div",{staticClass:"door-icon-box"},[i("div",{staticClass:"door-icon-item",on:{click:function(t){e.addDoor("door-top")}}},[i("span",[e._v("单开门(上)")])]),e._v(" "),i("div",{staticClass:"door-icon-item",on:{click:function(t){e.addDoor("door-bottom")}}},[i("span",[e._v("单开门(下)")])]),e._v(" "),i("div",{staticClass:"door-icon-item",on:{click:function(t){e.addDoor("door-left")}}},[i("span",[e._v("单开门(左)")])]),e._v(" "),i("div",{staticClass:"door-icon-item",on:{click:function(t){e.addDoor("door-right")}}},[i("span",[e._v("单开门(右)")])])]),e._v(" "),i("div",{staticClass:"tooltip-box",attrs:{slot:"reference"},slot:"reference"},[i("i",{staticClass:"subscript"})])])],1)]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"楼梯",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-stairs-black",attrs:{"data-type":"text"},on:{click:e.addStairs}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"电梯",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-elevator-black",attrs:{"data-type":"text"},on:{click:e.addElevator}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"复制",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-copy-black",attrs:{"data-type":"text"},on:{click:e.copyRoom}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"粘贴",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-paste-black",attrs:{"data-type":"text"},on:{click:e.pasteRoom}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"附件",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-accessory-black",class:{"acitive-icon":5===e.activeIconIndex},attrs:{"data-type":"text"},on:{click:function(t){e.accessoryHandle(5)}}},[i("div",{staticClass:"tooltip-box"})])]),e._v(" "),i("el-tooltip",{staticClass:"item",attrs:{content:"合并",effect:"dark",placement:"left-start"}},[i("li",{staticClass:"icon-merge-black",attrs:{"data-type":"text"},on:{click:e.merge}},[i("div",{staticClass:"tooltip-box"})])])],1)]),e._v(" "),i("div",{staticClass:"canvasDiv",on:{contextmenu:function(t){t.preventDefault(),e.showContextMenu(t)}}},[i("canvas",{attrs:{id:"c"}},[e._v("请使用支持HTML5的浏览器")])])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:1===e.activeBtnIndex,expression:"activeBtnIndex === 1"}],staticClass:"threeD"},[i("three-d",{ref:"threeD",on:{finished:e.initWebglFinished}})],1),e._v(" "),i("div",{staticClass:"btn-box"},[i("button",{staticClass:"plane-display-btn",class:{active:0===e.activeBtnIndex},on:{click:e.planeDisplay}},[e._v("\n      平面显示\n    ")]),e._v(" "),i("button",{staticClass:"threeD-display-btn",class:{active:1===e.activeBtnIndex,threeDisabled:!1===e.webglFlag},on:{click:e.threeDisplay}},[e._v("\n      3D显示\n    ")]),e._v(" "),i("save-btn",{directives:[{name:"show",rawName:"v-show",value:0===e.activeBtnIndex,expression:"activeBtnIndex === 0"}],staticClass:"graph-save-btn",on:{clickBtn:e.allSave}})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,width:"1450px",center:!0},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.dialogClosed}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("span",[e._v("基本信息")])]),e._v(" "),i("div",{staticClass:"basic-info"},[i("div",{staticClass:"base-info-content clearfix"},[i("div",{staticClass:"base-info-line"},[i("div",{staticClass:"content-item houseNumber clearfix"},[i("label",[e._v("房间号")]),e._v(" "),i("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],staticStyle:{width:"160px"},attrs:{size:"small",placeholder:"请输入房间号"},model:{value:e.Form.houseNumber,callback:function(t){e.$set(e.Form,"houseNumber",t)},expression:"Form.houseNumber"}})],1),e._v(" "),i("div",{staticClass:"content-item housetypeId clearfix"},[i("label",[e._v("房屋类型")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择",size:"small"},on:{change:e.houseTypeChange},model:{value:e.Form.housetypeId,callback:function(t){e.$set(e.Form,"housetypeId",t)},expression:"Form.housetypeId"}},e._l(e.houseType,function(e){return i("el-option",{key:e.housetypeId,attrs:{label:e.housetypeName,value:e.housetypeId}})}))],1),e._v(" "),i("div",{staticClass:"content-item houseUseArea clearfix"},[i("label",[e._v(e._s(4===e.Form.housetypeId?"建筑面积":"使用面积"))]),e._v(" "),i("el-input",{staticStyle:{width:"160px"},attrs:{size:"small",placeholder:4===e.Form.housetypeId?"请输入建筑面积(㎡)":"请输入使用面积(㎡)"},on:{blur:function(t){e.limitFloat("houseUseArea",!0)}},nativeOn:{keyup:function(t){e.limitFloat("houseUseArea")}},model:{value:e.Form.houseUseArea,callback:function(t){e.$set(e.Form,"houseUseArea",t)},expression:"Form.houseUseArea"}})],1),e._v(" "),i("div",{staticClass:"content-item useType clearfix"},[i("label",[e._v("使用类型")]),e._v(" "),i("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],staticStyle:{width:"160px"},attrs:{size:"small",placeholder:"请输入使用类型"},model:{value:e.Form.useType,callback:function(t){e.$set(e.Form,"useType",t)},expression:"Form.useType"}})],1),e._v(" "),i("div",{staticClass:"content-item clearfix"},[i("label",[e._v("是否使用")]),e._v(" "),i("div",{staticClass:"isUser-radio-box"},[i("el-radio",{staticStyle:{width:"50px"},attrs:{label:0},model:{value:e.Form.isIdle,callback:function(t){e.$set(e.Form,"isIdle",t)},expression:"Form.isIdle"}},[e._v("使用")]),e._v(" "),i("el-radio",{staticStyle:{width:"50px"},attrs:{label:1},model:{value:e.Form.isIdle,callback:function(t){e.$set(e.Form,"isIdle",t)},expression:"Form.isIdle"}},[e._v("闲置")])],1)])]),e._v(" "),i("div",{staticClass:"base-info-line"},[0===e.Form.isIdle?i("div",{staticClass:"content-item clearfix"},[i("label",[e._v("是否自用")]),e._v(" "),i("div",{staticClass:"isUser-radio-box"},[i("el-radio",{staticStyle:{width:"50px"},attrs:{label:1},model:{value:e.Form.isUse,callback:function(t){e.$set(e.Form,"isUse",t)},expression:"Form.isUse"}},[e._v("自用")]),e._v(" "),i("el-radio",{staticStyle:{width:"50px"},attrs:{label:0},model:{value:e.Form.isUse,callback:function(t){e.$set(e.Form,"isUse",t)},expression:"Form.isUse"}},[e._v("非自用")])],1)]):e._e(),e._v(" "),0===e.Form.isIdle&&1===e.Form.isUse&&e.Form.housetypeId&&1!==e.Form.housetypeId?i("div",{staticClass:"content-item unitIds clearfix"},[i("label",[e._v("所属单位")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.unitIds,callback:function(t){e.unitIds=t},expression:"unitIds"}},e._l(e.unitOptions,function(e){return i("el-option",{key:e.unitId,attrs:{label:e.unitName,value:e.unitId,disabled:e.disabled}})}))],1):e._e()])])]),e._v(" "),e.Form.rent&&0===e.Form.isUse?i("div",{staticClass:"rent-info"},[i("div",{staticClass:"line"}),e._v(" "),i("div",{staticClass:"rent-tips"},[e._v("\n        该房间为"+e._s(1===e.Form.rent.type?"出租":"出借")+"的房间，"+e._s(1===e.Form.rent.type?"出租":"出借")+"相关信息如下：\n      ")]),e._v(" "),i("div",{staticClass:"rent-info-line clearfix"},[i("div",{staticClass:"rent-item"},[i("span",[e._v(e._s(1===e.Form.rent.type?"承租用途：":"承借用途："))]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.lesseeUse?e.Form.rent.lesseeUse:"暂无"))])]),e._v(" "),i("div",{staticClass:"rent-item"},[i("span",[e._v(e._s(1===e.Form.rent.type?"承租方：":"借用单位："))]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.renter))])]),e._v(" "),i("div",{staticClass:"rent-item"},[i("span",[e._v("开始时间：")]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.rentBegin))])]),e._v(" "),i("div",{staticClass:"rent-item"},[i("span",[e._v("结束时间：")]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.rentEnd))])])]),e._v(" "),i("div",{staticClass:"rent-info-line clearfix"},[1===e.Form.rent.type?i("div",{staticClass:"rent-item"},[i("span",[e._v("租金：")]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.rentMoney))])]):e._e(),e._v(" "),1===e.Form.rent.type?i("div",{staticClass:"rent-item"},[i("span",[e._v("押金：")]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.deposit))])]):e._e(),e._v(" "),i("div",{staticClass:"rent-item"},[i("span",[e._v("联系人：")]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.contacts?e.Form.rent.contacts:"暂无"))])]),e._v(" "),i("div",{staticClass:"rent-item"},[i("span",[e._v("联系方式：")]),e._v(" "),i("span",[e._v(e._s(e.Form.rent.contactPhone?e.Form.rent.contactPhone:"暂无"))])])])]):e._e(),e._v(" "),0===e.Form.isIdle&&1===e.Form.isUse&&1===e.Form.housetypeId?i("div",{staticClass:"use-info"},[i("div",{staticClass:"line"}),e._v(" "),i("div",{staticClass:"content-item clearfix"},[i("label",{staticStyle:{width:"140px"}},[e._v("是否为领导办公室")]),e._v(" "),i("el-radio",{staticStyle:{width:"50px"},attrs:{label:"1",name:"isLeader"},model:{value:e.isLeader,callback:function(t){e.isLeader=t},expression:"isLeader"}},[e._v("是")]),e._v(" "),i("el-radio",{staticStyle:{width:"50px"},attrs:{label:"2",name:"isLeader"},model:{value:e.isLeader,callback:function(t){e.isLeader=t},expression:"isLeader"}},[e._v("否")])],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"1"===e.isLeader,expression:"isLeader === '1'"}],staticClass:"leader-info"},[i("div",{staticClass:"unit-info-content unit-info-main"},[i("div",{staticClass:"content-item-unitName clearfix"},[i("label",[e._v("所属单位")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.Form.leadingOfficeVo.unitId,callback:function(t){e.$set(e.Form.leadingOfficeVo,"unitId",t)},expression:"Form.leadingOfficeVo.unitId"}},e._l(e.unitOptions,function(e){return i("el-option",{key:e.unitId,attrs:{label:e.unitName,value:e.unitId,disabled:e.disabled}})}))],1),e._v(" "),e._l(e.Form.leadingOfficeVo.leadingOfficeList,function(t,s){return i("div",{key:s,staticClass:"content-item-group clearfix"},[i("div",{staticClass:"group-item clearfix"},[i("label",[e._v("等级")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{filterable:"",placeholder:"请选择等级",size:"small"},on:{change:function(t){e.professionalLevelChange(t,s)}},model:{value:t.professionalLevel,callback:function(i){e.$set(t,"professionalLevel",i)},expression:"members.professionalLevel"}},e._l(e.professionalLevelOpts,function(e){return i("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),i("div",{staticClass:"group-item clearfix"},[i("label",[e._v("职级")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择职级","no-data-text":"请先选择等级",size:"small"},model:{value:t.professionalId,callback:function(i){e.$set(t,"professionalId",i)},expression:"members.professionalId"}},e._l(t.professionOpts,function(e){return i("el-option",{key:e.professionalId,attrs:{label:e.professionalName,value:e.professionalId}})}))],1),e._v(" "),i("div",{staticClass:"group-item clearfix"},[i("label",[e._v("职务")]),e._v(" "),i("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],staticStyle:{width:"160px"},attrs:{size:"small",placeholder:"请输入职务"},model:{value:t.duty,callback:function(i){e.$set(t,"duty",i)},expression:"members.duty"}})],1),e._v(" "),i("div",{staticClass:"group-item clearfix"},[i("label",[e._v("使用人姓名")]),e._v(" "),i("el-input",{directives:[{name:"enter-trim",rawName:"v-enter-trim"}],staticStyle:{width:"160px"},attrs:{size:"small",placeholder:"请输入使用人姓名"},model:{value:t.leadingofficeName,callback:function(i){e.$set(t,"leadingofficeName",e._n(i))},expression:"members.leadingofficeName"}})],1),e._v(" "),i("div",{staticClass:"group-item clearfix"},[i("label",[e._v("在职情况")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择在职情况",size:"small"},model:{value:t.leadingofficeWorkStatueId,callback:function(i){e.$set(t,"leadingofficeWorkStatueId",i)},expression:"members.leadingofficeWorkStatueId"}},e._l(e.workStatue,function(e){return i("el-option",{key:e.workstatusId,attrs:{label:e.workstatusName,value:e.workstatusId}})}))],1),e._v(" "),i("div",{staticClass:"group-item clearfix"},[i("a",{directives:[{name:"show",rawName:"v-show",value:0===s,expression:"i === 0"}],staticClass:"add-item-btn",attrs:{href:"javascript:;"},on:{click:function(t){e.addProfessionItem()}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 添加\n              ")]),e._v(" "),i("a",{directives:[{name:"show",rawName:"v-show",value:0!==s,expression:"i !== 0"}],staticClass:"delete-item-btn",attrs:{href:"javascript:;"},on:{click:function(t){e.deleteProfessionItem(s)}}},[i("i",{staticClass:"el-icon-close"}),e._v(" 删除\n              ")])])])})],2)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:"2"===e.isLeader,expression:"isLeader === '2'"}],staticClass:"unit-info"},[i("div",{staticClass:"unit-info-content clearfix"},[i("div",{staticClass:"content-item unitId"},[i("label",[e._v("所属单位")]),e._v(" "),i("el-select",{staticStyle:{width:"160px"},attrs:{placeholder:"请选择",size:"small"},model:{value:e.Form.housingUseVoList[0].unitId,callback:function(t){e.$set(e.Form.housingUseVoList[0],"unitId",t)},expression:"Form.housingUseVoList[0].unitId"}},e._l(e.unitOptions,function(e){return i("el-option",{key:e.unitId,attrs:{label:e.unitName,value:e.unitId,disabled:e.disabled}})}))],1)])])]):e._e(),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("cancel-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.dialogVisible=!1}}}),e._v(" "),i("confirm-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.submitForm("Form")}}})],1)]),e._v(" "),i("el-dialog",{staticClass:"accessoryDialog",attrs:{"before-close":e.accessoryDialogClosed,visible:e.accessoryDialogVisible,"close-on-click-modal":!1,width:"780px"},on:{"update:visible":function(t){e.accessoryDialogVisible=t}}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("span",[e._v("附件")])]),e._v(" "),i("div",{staticClass:"accessory-main"},[i("ul",{staticClass:"accessory-checkbox"},e._l(e.fileList,function(t,s){return i("li",{key:s},[i("el-checkbox",{on:{change:function(i){e.checkboxChange(i,t.id)}}})],1)})),e._v(" "),i("el-upload",{staticClass:"upload-demo",attrs:{headers:e.postHeaders,action:e.uploadCADUrl,"on-remove":e.handleRemove,"on-success":e.handleSuccess,"on-error":e.handleError,"file-list":e.fileList,"before-upload":e.beforeAvatarUpload}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("上传CAD")]),e._v(" "),e.fileList.length>0?i("el-button",{staticStyle:{"margin-left":"10px"},attrs:{slot:"tip",size:"small",type:"primary"},on:{click:e.downloadCAD},slot:"tip"},[e._v("下载CAD")]):e._e()],1)],1)]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:0===e.activeBtnIndex,expression:"activeBtnIndex === 0"}],staticClass:"house-type-box"},[i("ul",[e._m(0),e._v(" "),e._m(1),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),e._m(4),e._v(" "),e._m(5),e._v(" "),"gl"!==e.PRO_TYPE?i("li",[i("span",{staticStyle:{background:"#fe8200"}}),e._v("\n        租借用房\n      ")]):e._e()])]),e._v(" "),this.drawing_width_scale>0&&this.drawing_height_scale>0?i("div",{staticClass:"drawing-size-scale"},[i("span",[e._v(e._s(this.drawing_width_scale))]),e._v(" "),i("span",[e._v("x")]),e._v(" "),i("span",[e._v(e._s(this.drawing_height_scale))])]):e._e(),e._v(" "),0===e.activeBtnIndex&&e.showViewBtn?i("div",{staticClass:"start-view-box"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"浏览房间数据",placement:"right"}},[i("div",{staticClass:"view-icon",on:{click:e.startView}},[i("span",{staticClass:"iconfont"},[e._v("")])])])],1):e._e(),e._v(" "),i("el-dialog",{staticClass:"config-info-dialog",attrs:{visible:e.configDialogVisible,"close-on-click-modal":!1,width:"780px",center:!0},on:{"update:visible":function(t){e.configDialogVisible=t},closed:e.configDialogClosed}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("span",[e._v("提示")])]),e._v(" "),i("div",{staticClass:"dialog-content"},[i("p",{staticClass:"save-before-room-tips"},[e._v("\n        刚刚修改的房间，关联以下配置信息，点击确定按钮，将撤销以下全部配置信息并保存刚刚修改的房间信息，如若继续请点击确定按钮，否则请点击取消按钮取消操作。\n      ")]),e._v(" "),i("p",[i("table-component",{attrs:{tableData:e.configTableData,tableHeight:200}},[i("el-table-column",{attrs:{type:"index",width:"50",label:"序号",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"configureNo",label:"配置编号",align:"center","show-overflow-tooltip":!0}}),e._v(" "),i("el-table-column",{attrs:{prop:"unitName",label:"申请单位",align:"center","show-overflow-tooltip":!0}}),e._v(" "),i("el-table-column",{attrs:{prop:"configureApplicant",label:"申请人",align:"center","show-overflow-tooltip":!0}}),e._v(" "),i("el-table-column",{attrs:{prop:"configureDate",label:"申请时间",align:"center","show-overflow-tooltip":!0}})],1)],1),e._v(" "),i("div",{staticClass:"config-table-pagination-box"},[i("div",{staticClass:"config-table-pagination"},[i("el-pagination",{attrs:{small:"",layout:"prev, pager, next","current-page":e.configCurrentPage,"page-size":e.configPageSize,total:e.configTableTotal},on:{"current-change":e.configCurrentChange}})],1)])]),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("cancel-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.configDialogVisible=!1}}}),e._v(" "),i("confirm-btn",{attrs:{fontSize:14},on:{clickBtn:e.saveAllInfo}})],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{background:"#cccccc"}}),this._v("\n        未填写信息\n      ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{background:"#21b124"}}),this._v("\n        办公室用房\n      ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{background:"#f4e83b"}}),this._v("\n        服务用房\n      ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{background:"#008aff"}}),this._v("\n        设备用房\n      ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{background:"#12fff1"}}),this._v("\n        附属用房\n      ")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("span",{staticStyle:{background:"#ff01fd"}}),this._v("\n        业务用房\n      ")])}]};var S=i("VU/8")(j,E,!1,function(e){i("7kC7")},null,null);t.default=S.exports},JnFy:function(e,t,i){e.exports=i.p+"static/img/wall.9d79e9f.jpg"},M7Mp:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMjEgMjEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIxIDIxOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1taXRlcmxpbWl0OjEwO30NCjwvc3R5bGU+DQo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMCwyMC40YzAuMiwwLDAuNSwwLDAuNywwYzEwLjcsMCwxOS4zLTguNywxOS4zLTE5LjRIMCIvPg0KPC9zdmc+DQo="},Mqq8:function(e,t,i){"use strict";(function(e){var s=i("r4Au"),o=i.n(s),a=(i("BYiG"),i("Ps6x"));i.n(a);t.a={data:function(){return{data:{wall:[],door:[],info:[[{type:"1"},{x:"10",y:"20"}],[{type:"2"},{x:"500",y:"700"}]]},scene:null,camera:null,renderer:null,container:null,controls:null,wallMaterial:null,ASPECT:null,dummy:null,loader:null,jdLoader:null,VIEW_ANGLE:30,NEAR:.1,FAR:1e4,WALL_HEIGHT:100,WALL_THICK:8,DOOR_WALL_THICK:8,devOrdinateX:0,devOrdinateY:0,stop:null}},methods:{init:function(e){this.data.wall=e;var t=window.innerWidth,i=window.innerHeight;this.ASPECT=t/i,this.dummy=new THREE.Object3D,this.loader=new THREE.TextureLoader,this.jdLoader=new THREE.JDLoader,this.initScene(),this.initCamera(),this.initRender(),this.initControls(),this.initLight(),this.initObject(),this.animate(),this.$emit("finished")},animate:function(){this.stop=requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera)},getLineAngle:function(e,t,i,s){return Math.atan2(i-e,s-t)},getObjectGeometryData:function(e,t,i){var s=new Object;return s.objLength=Math.sqrt(Math.pow(e.xSource-e.xSink,2)+Math.pow(e.ySource-e.ySink,2)),s.objXPoint=(e.xSource+e.xSink)/2-t,s.objYPoint=(e.ySource+e.ySink)/2-i,s},findDoor:function(e,t){for(var i=new Array,s=void 0,o=void 0,a=void 0,n=0;n<e.length;n++)t.xSource==t.xSink==e[n].xSource!=e[n].xSink?(s=(t.ySink-e[n].ySource)/(t.xSink-e[n].xSource),o=(t.ySink-e[n].ySink)/(t.xSink-e[n].xSink),a=(t.ySink-t.ySource)/(t.xSink-t.xSource),s==o&&o==a&&i.push(e[n])):i.push(e[n]);return i},initScene:function(){this.scene=new THREE.Scene},initCamera:function(){this.camera=new THREE.PerspectiveCamera(this.VIEW_ANGLE,this.ASPECT,this.NEAR,this.FAR),this.camera.position.set(1e3,1500,2500),this.camera.lookAt(0,0,0),this.scene.add(this.camera)},initRender:function(){this.renderer=new THREE.WebGLRenderer({antialias:!0});var t=e("#mainDiv").outerHeight(),i=e("#mainDiv").outerWidth();this.renderer.setSize(i,t),this.container=document.getElementById("3DView"),this.container.childNodes.length>0&&this.container.removeChild(this.container.childNodes[0]),this.container.appendChild(this.renderer.domElement),this.renderer.setClearColor(4620980,1)},initControls:function(){this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement)},initLight:function(){var e=new THREE.PointLight(15790320,.4);e.position.set(0,100,0).normalize(),this.scene.add(e);var t=new THREE.AmbientLight(14737632,.8);t.position.set(0,0,0),this.scene.add(t)},initObject:function(){this.initMaterial(),this.initLayout()},initMaterial:function(){this.wallMaterial=new THREE.MeshLambertMaterial({map:this.loader.load(i("JnFy"),function(e){e.wrapS=e.wrapT=THREE.RepeatWrapping,e.repeat.set(1,1)})}),this.wallMaterial.transparent=!0},initLayout:function(){for(var e=0,t=0,i=0,s=0,o=void 0,a=void 0,n=new Array,r=new Array,l=new Object,c=0;c<this.data.wall.length;c++)(o=new Object).xSource=parseFloat(this.data.wall[c][0].x),o.ySource=parseFloat(this.data.wall[c][0].y),o.xSink=parseFloat(this.data.wall[c][1].x),o.ySink=parseFloat(this.data.wall[c][1].y),n.push(o),0==c?(e=Math.min(this.data.wall[c][0].x,this.data.wall[c][1].x),t=Math.max(this.data.wall[c][0].x,this.data.wall[c][1].x),i=Math.min(this.data.wall[c][0].y,this.data.wall[c][1].y),i=Math.max(this.data.wall[c][0].y,this.data.wall[c][1].y)):(e=Math.min(e,this.data.wall[c][0].x),e=Math.min(e,this.data.wall[c][1].x),t=Math.max(t,this.data.wall[c][0].x),t=Math.max(t,this.data.wall[c][1].x),i=Math.min(i,this.data.wall[c][0].y),i=Math.min(i,this.data.wall[c][1].y),s=Math.max(s,this.data.wall[c][0].y),s=Math.max(s,this.data.wall[c][1].y));for(var d=0;d<this.data.door.length;d++)(a=new Object).xSource=parseFloat(this.data.door[d][0].x),a.ySource=parseFloat(this.data.door[d][0].y),a.xSink=parseFloat(this.data.door[d][1].x),a.ySink=parseFloat(this.data.door[d][1].y),r.push(a);l.width=t-e,l.length=s-i,l.wallArray=n,l.doorArray=r,this.devOrdinateX=(t+e)/2,this.devOrdinateY=(s+i)/2,this.createLayout(l),this.createFloor(t-e,s-i)},createFloor:function(e,t){var s=this;this.loader.load(i("lggW"),function(i){i.wrapS=i.wrapT=THREE.RepeatWrapping,i.repeat.set(10,10);var o=new THREE.BoxGeometry(t,e,1),a=new THREE.MeshBasicMaterial({map:i,side:THREE.DoubleSide}),n=new THREE.Mesh(o,a);n.position.z=0,n.position.y=-100,n.position.x=0,n.rotation.x=Math.PI/2,n.rotation.z=Math.PI/2,s.scene.add(n)})},createResultBsp:function(e,t){for(var i=new o.a(e),s=0;s<t.length;s++){var a=new o.a(t[s]);i=i.subtract(a)}var n=i.toMesh(this.wallMaterial);n.material.flatshading=THREE.FlatShading,n.geometry.computeFaceNormals(),n.geometry.computeVertexNormals(),n.material.needsUpdate=!0,n.geometry.buffersNeedUpdate=!0,n.geometry.uvsNeedUpdate=!0,this.scene.add(n)},createCubeWall:function(e,t,i,s,o,a,n){var r=new THREE.BoxGeometry(e,t,i),l=new THREE.Mesh(r,this.wallMaterial);l.position.x=o,l.position.y=a,l.position.z=n,l.rotation.y=s,this.scene.add(l)},returnWallObject:function(e,t,i,s,o,a,n){var r=new THREE.BoxGeometry(e,t,i),l=new THREE.Mesh(r,this.wallMaterial);return l.position.x=o,l.position.y=a,l.position.z=n,l.rotation.y=s,l},createLayout:function(e){for(var t=e.wallArray,i=e.doorArray,s=void 0,o=void 0,a=new Array,n=0;n<t.length;n++){var r;r=this.getLineAngle(t[n].xSource,t[n].ySource,t[n].xSink,t[n].ySink);var l=this.getObjectGeometryData(t[n],this.devOrdinateX,this.devOrdinateY);if(0==(s=this.findDoor(i,t[n])).length)this.createCubeWall(this.WALL_THICK,this.WALL_HEIGHT,l.objLength,r,l.objXPoint,this.WALL_HEIGHT/2-100,l.objYPoint);else{var c=this.returnWallObject(this.DOOR_WALL_THICK,this.WALL_HEIGHT,l.objLength,r,l.objYPoint,this.WALL_HEIGHT/2-100,l.objXPoint);o=new Array;for(var d=0;d<s.length;d++){var u=this.getObjectGeometryData(s[d],this.devOrdinateX,this.devOrdinateY),h=this.returnWallObject(u.objLength,this.WALL_HEIGHT-20,this.DOOR_WALL_THICK,r+Math.PI/2,u.objYPoint,0,u.objXPoint);o.push(h),a.push(h)}this.createResultBsp(c,o)}}this.addDoorTexture(a)},addDoorTexture:function(e){var t=this;this.loader.load(i("0Xel"),function(i){var s=null,o=new THREE.BoxGeometry(100,180,2),a=new THREE.MeshBasicMaterial({map:i,color:16777215});a.opacity=1,a.transparent=!0;for(var n=0;n<e.length;n++){(s=new THREE.Mesh(o,a)).position.set(e[n].position.x+400,e[n].position.y,e[n].position.z-250),s.rotation.y=e[n].rotation.y;var r=s.clone();r.position.set(e[n].position.x+400,e[n].position.y,e[n].position.z-250),r.rotation.y=e[n].rotation.y,r.visible=!1,t.dummy.add(s),t.dummy.add(r),t.dummy.position.set(e[n].position.x+400,e[n].position.y,e[n].position.z-250),t.scene.add(t.dummy)}})},clear:function(){this.container=document.getElementById("3DView"),this.container.childNodes.length>0&&this.container.removeChild(this.container.childNodes[0])}},mounted:function(){}}}).call(t,i("7t+N"))},OvRC:function(e,t,i){e.exports={default:i("oM7Q"),__esModule:!0}},Ps6x:function(e,t){THREE.JDLoader=function(e){this.manager=void 0!==e?e:THREE.DefaultLoadingManager},THREE.JDLoader.prototype={constructor:THREE.JDLoader,load:function(e,t,i,s){var o=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:THREE.LoaderUtils.extractUrlBase(e);new THREE.FileLoader(this.manager).load(e,function(e){o.loadText(e,t,a)},i,s)},loadText:function(e,t,i){(e=JSON.parse(e))&&t(i=this.parse(e,i))},setTexturePath:function(e){this.texturePath=e},parse:function(e,t){function i(){for(var e=[],t=0;t<d.length;++t){var i=new THREE.MeshPhongMaterial({});i.copy(d[t]),e.push(i)}return e}function s(e){var t=new THREE.Matrix4;if(!u||0>e||!u[e])return t;for(;0<=e;e=u[e].parent){var i=u[e],s=new THREE.Vector3(i.pos[0],i.pos[1],i.pos[2]),o=new THREE.Vector3(i.scl[0],i.scl[1],i.scl[2]);i=new THREE.Quaternion(i.rotq[0],i.rotq[1],i.rotq[2],i.rotq[3]),s=(new THREE.Matrix4).compose(s,i,o);t.premultiply(s)}return t}function o(e,t){if(!e)return console.error("parseOffsetAnimation: no animation"),null;var i=e.fps||30,o=!0,l=e.length||-1;"frames"==e.timeline&&(o=!1,l/=i);var c=[],d=e.name||"default";if(!(f=(e.animNodes||[])[t]))return console.error("parseOffsetAnimation: animNode "+t+" is null !"),null;var h="";void 0!==f.nodeName?h=f.nodeName:void 0!==f.nodeIndex&&(h=u[f.nodeIndex].name);for(var f={times:[],values:[]},g={times:[],values:[]},p={times:[],values:[]},m=[],v=t;0<=v;v=u[v].parent)m=n(m=n(m=n(m,(b=e.animNodes[v]).scl.times),b.rot.times),b.pos.times);f.times=f.times.concat(m),g.times=g.times.concat(m),p.times=p.times.concat(m);v=new THREE.Vector3;var I,b=new THREE.Vector3,y=new THREE.Quaternion;new THREE.Matrix4;var w=new THREE.Matrix4;w.getInverse(s(t));for(var x=0;x<m.length;++x){I=e;var L=t,j=m[x],E=new THREE.Matrix4;if(u&&!(0>L)&&I.animNodes[L])for(var S,O,T,H,N,C;0<=L;L=u[L].parent)(O=(S=a((C=I.animNodes[L]).scl.times,j)).iBegin)==(T=S.iEnd)?N=new THREE.Vector3(C.scl.values[3*O],C.scl.values[3*O+1],C.scl.values[3*O+2]):(S=(j-C.scl.times[O])/(C.scl.times[T]-C.scl.times[O]),N=new THREE.Vector3(C.scl.values[3*O],C.scl.values[3*O+1],C.scl.values[3*O+2]),H=new THREE.Vector3(C.scl.values[3*T],C.scl.values[3*T+1],C.scl.values[3*T+2]),N=N.lerp(H,S)),(O=(S=a(C.pos.times,j)).iBegin)==(T=S.iEnd)?H=new THREE.Vector3(C.pos.values[3*O],C.pos.values[3*O+1],C.pos.values[3*O+2]):(S=(j-C.pos.times[O])/(C.pos.times[T]-C.pos.times[O]),H=new THREE.Vector3(C.pos.values[3*O],C.pos.values[3*O+1],C.pos.values[3*O+2]),O=new THREE.Vector3(C.pos.values[3*T],C.pos.values[3*T+1],C.pos.values[3*T+2]),H=H.lerp(O,S)),(O=(S=a(C.rot.times,j)).iBegin)==(T=S.iEnd)?O=new THREE.Quaternion(C.rot.values[4*O],C.rot.values[4*O+1],C.rot.values[4*O+2],C.rot.values[4*O+3]):(S=(j-C.rot.times[O])/(C.rot.times[T]-C.rot.times[O]),O=new THREE.Quaternion(C.rot.values[4*O],C.rot.values[4*O+1],C.rot.values[4*O+2],C.rot.values[4*O+3]),C=new THREE.Quaternion(C.rot.values[4*T],C.rot.values[4*T+1],C.rot.values[4*T+2],C.rot.values[4*T+3]),O=O.slerp(C,S)),N=(new THREE.Matrix4).compose(H,O,N),E.premultiply(N);(I=E).multiply(w),I.decompose(v,y,b),f.values.push(b.x),f.values.push(b.y),f.values.push(b.z),p.values.push(v.x),p.values.push(v.y),p.values.push(v.z),g.values.push(y.x),g.values.push(y.y),g.values.push(y.z),g.values.push(y.w)}return r(o,i,THREE.VectorKeyframeTrack,h+".position",p,c),r(o,i,THREE.VectorKeyframeTrack,h+".scale",f,c),r(o,i,THREE.QuaternionKeyframeTrack,h+".quaternion",g,c),0===c.length?(console.error("parseOffsetAnimation: tracks.length is 0 !"),null):new THREE.AnimationClip(d,l,c)}function a(e,t){for(var i=0,s=0,o=0;o<e.length;++o){if(e[o]==t){i=s=o;break}if(e[o]>t){i=s=o;break}if(o==e.length-1){i=s=o;break}if(t<e[o+1]){i=o,s=o+1;break}}return{iBegin:i,iEnd:s}}function n(e,t){for(var i=[],s=0,o=0;s<e.length&&o<t.length;)e[s]<t[o]?(0!=i.length&&e[s]==i[i.length-1]||i.push(e[s]),++s):(e[s]>t[o]?0!=i.length&&t[o]==i[i.length-1]||i.push(t[o]):(0!=i.length&&i[i.length-1]==e[s]||i.push(e[s]),++s),++o);for(;s<e.length;)0!=i.length&&e[s]==i[i.length-1]||i.push(e[s]),++s;for(;o<t.length;)0!=i.length&&t[o]==i[i.length-1]||i.push(t[o]),++o;return i}function r(e,t,i,s,o,a){if(o&&Array.isArray(o.times)&&Array.isArray(o.values)){var n=[],r=(r=[]).concat(o.times);n=n.concat(o.values);if(!e)for(e=0;e<r.length;++e)r[e]/=t;r&&0!=r.length&&n&&0!=n.length&&a.push(new i(s,r,n))}}var l=0,c=this,d=[],u=[],h=[],f=[],g=[],p=[],m=[];for(function(){var i,s,o,a,n,r,l,u,h,f;if(d=[],void 0!==e.materials&&0!==e.materials.length)for(f=0;f<e.materials.length;++f){var g=e.materials[f];if(i=new THREE.Color(16777215),s=new THREE.Color(1644825),g.diffuse&&i.fromArray(g.diffuse),g.specular&&s.fromArray(g.specular),o=void 0!==g.glossiness?g.glossiness:40,h=u=l=r=n=a=void 0,g.maps)for(var p=0;p<g.maps.length;++p)if(""!=g.maps[p].file)if("diffuse"==g.maps[p].type){var m=new THREE.TextureLoader;m.setCrossOrigin(c.crossOrigin),(a=m.load(t+g.maps[p].file)).wrapS=a.wrapT=THREE.RepeatWrapping}else"specular"==g.maps[p].type?((m=new THREE.TextureLoader).setCrossOrigin(c.crossOrigin),(n=m.load(t+g.maps[p].file)).wrapS=n.wrapT=THREE.RepeatWrapping):"bump"==g.maps[p].type?((m=new THREE.TextureLoader).setCrossOrigin(c.crossOrigin),(r=m.load(t+g.maps[p].file)).wrapS=r.wrapT=THREE.RepeatWrapping):"normal"==g.maps[p].type?((m=new THREE.TextureLoader).setCrossOrigin(c.crossOrigin),(l=m.load(t+g.maps[p].file)).wrapS=l.wrapT=THREE.RepeatWrapping):"opacity"==g.maps[p].type?((m=new THREE.TextureLoader).setCrossOrigin(c.crossOrigin),(u=m.load(t+g.maps[p].file)).wrapS=u.wrapT=THREE.RepeatWrapping):"lightmap"==g.maps[p].type&&((m=new THREE.TextureLoader).setCrossOrigin(c.crossOrigin),(h=m.load(t+g.maps[p].file)).wrapS=h.wrapT=THREE.RepeatWrapping);i=new THREE.MeshPhongMaterial({name:name,color:i.getHex(),specular:s.getHex(),shininess:o,skinning:!0}),a&&(i.map=a),n&&(i.specularMap=n),r&&(i.bumpMap=r),l&&(i.normalMap=l),u&&(i.alphaMap=u,i.transparent=!0),h&&(i.lightMap=h),void 0!==g.opacity&&(i.opacity=g.opacity,1>g.opacity&&(i.transparent=!0)),d.push(i)}}(),function(){if(u=void 0!==e.hierarchy?e.hierarchy.nodes:e.nodes,Array.isArray(u)&&0<u.length)for(var t=0;t<u.length;++t)void 0!==u[t].rot&&(u[t].rotq=u[t].rot,u[t].rot=void 0);else u=[]}(),function(){var t=e.model;if(t){var i,o,a,n,r,l,c,d,m,v,I,b,y,w,x,L,j;if(t.splineShapes)for(c=0;c<t.splineShapes.length&&void 0!=(j=t.splineShapes[c]);++c)for(L=s(I=j.node),y=0;y<j.splines.length;++y){for((r=new THREE.BufferGeometry).name=j.name,1<j.splines.length&&(r.name+="_SubSpline"+y),d=new THREE.CurvePath,l=j.splines[y],i=0;i+2<l.points.length;i+=3)(b=new THREE.Vector3(l.points[i],l.points[i+1],l.points[i+2])).applyMatrix4(L),l.points[i]=b.x,l.points[i+1]=b.y,l.points[i+2]=b.z;for(i=0;i+11<l.points.length;i+=9)m=new THREE.CubicBezierCurve3(new THREE.Vector3(l.points[i],l.points[i+1],l.points[i+2]),new THREE.Vector3(l.points[i+3],l.points[i+4],l.points[i+5]),new THREE.Vector3(l.points[i+6],l.points[i+7],l.points[i+8]),new THREE.Vector3(l.points[i+9],l.points[i+10],l.points[i+11])),d.add(m);r.setFromPoints(d.getPoints(j.steps+1)),h.push(r),g.push("Line"),p.push(j),f.push(I)}if(t.meshes)for(j=0;j<t.meshes.length&&(r=new THREE.BufferGeometry,void 0!=(c=t.meshes[j]))&&(c.name&&(r.name=c.name),void 0!=(m=c.verts))&&void 0!=(I=c.vertElement)&&(d=c.face,y=I.vertIndices,n=I.normals,w=I.uvs,l=c.skin,void 0!=(I=c.node)&&(0<=I&&I<u.length))&&((i=u[I])&&i.pos&&i.rotq&&i.scl)&&void 0!=d&&(x=d.vertElementIndices,a=d.groups,x&&a);++j){L=s(I),d=y.length;var E=new Float32Array(3*d);for(v=0;v<d;++v)i=3*y[v],o=3*v,(b=new THREE.Vector3(m[i],m[i+1],m[i+2])).applyMatrix4(L),E[o]=b.x,E[o+1]=b.y,E[o+2]=b.z;if(r.addAttribute("position",new THREE.BufferAttribute(E,3)),void 0!==n&&0<n.length){for(L=(new THREE.Matrix3).getNormalMatrix(L),b=new Float32Array(n),i=0;i+2<n.length;i+=3)(v=new THREE.Vector3(n[i],n[i+1],n[i+2])).applyMatrix3(L).normalize(),b[i]=v.x,b[i+1]=v.y,b[i+2]=v.z;r.addAttribute("normal",new THREE.BufferAttribute(b,3))}if(void 0!==w&&0<w.length){e:if(i=-1,a&&e.materials){for(v=0;v<a.length;++v)if((n=e.materials[a[v].materialIndex])&&n.maps)for(L=0;L<n.maps.length;++L)if("diffuse"==n.maps[L].type)if(0>i)i=n.maps[L].uvsIndex;else if(i!=n.maps[L].uvsIndex)break e;i=0>i?0:i}else i=0;if(i=i<w.length?i:0,v=new Float32Array(w[i]),r.addAttribute("uv",new THREE.BufferAttribute(v,2)),1<w.length){e:{if(a&&e.materials)for(i=0;i<a.length;++i)if((v=e.materials[a[i].materialIndex])&&v.maps)for(n=0;n<v.maps.length;++n)if("lightmap"==v.maps[n].type){i=v.maps[n].uvsIndex;break e}i=-1}0<=i&&(v=new Float32Array(w[i]),r.addAttribute("uv2",new THREE.BufferAttribute(v,2)),console.log("lightmap uv index "+i))}}if(i=new Uint32Array(x),r.setIndex(new THREE.BufferAttribute(i,1)),r.groups=a,n=m.length/3,m=[],w=[],l&&l.skinBones&&l.skinWeights&&l.skinBones.length==l.skinWeights.length)for(v=0;v<n;++v){for(x=new THREE.Vector4(0,0,0,0),i=new THREE.Vector4(0,0,0,0),a=L=0;4>a;++a)a<l.skinBones[v].length?(x.setComponent(a,l.skinBones[v][a]),i.setComponent(a,l.skinWeights[v][a]),++L):(x.setComponent(a,0),i.setComponent(a,0));for(;L<l.skinWeights[v].length;)i.addScalar(.25*l.skinWeights[v][L]),++L;m.push(x),w.push(i)}if(0<m.length&&0<w.length)for(l="SkinnedMesh",r.addAttribute("skinIndex",new THREE.Float32BufferAttribute(new Float32Array(4*d),4)),r.addAttribute("skinWeight",new THREE.Float32BufferAttribute(new Float32Array(4*d),4)),v=0;v<d;++v)x=m[i=y[v]],i=w[i],r.attributes.skinIndex.setXYZW(v,x.x,x.y,x.z,x.w),r.attributes.skinWeight.setXYZW(v,i.x,i.y,i.z,i.w);else l="Mesh";y=Number(THREE.REVISION.replace(/[^0-9]/gi,"")),"SkinnedMesh"!=l||98<y||(y=getBones(c))&&0<y.length&&(r.bones=y),h.push(r),g.push(l),p.push(c),f.push(I)}}}(),function(){if((a=e.animation)&&a.keyframeAnimations&&0!=a.keyframeAnimations.length){var t,i,s,a=a.keyframeAnimations.concat(),n=[];for(i=0;i<a.length;++i){if(g=a[i]){t=g.fps||30,s=!0;var l=g.length||-1;"frames"==g.timeline&&(s=!1,l/=t);for(var c=[],d=g.name||"default",g=g.animNodes||[],p=0;p<g.length;p++){var m=g[p];if(m){var v="";void 0!==m.nodeName?v=m.nodeName:void 0!==m.nodeIndex&&(v=u[m.nodeIndex].name),r(s,t,THREE.VectorKeyframeTrack,v+".position",m.pos,c),r(s,t,THREE.VectorKeyframeTrack,v+".scale",m.scl,c),r(s,t,THREE.QuaternionKeyframeTrack,v+".quaternion",m.rot,c)}}s=0===c.length?null:new THREE.AnimationClip(d,l,c)}else console.error("parseKeyFrameAnimation: no animation"),s=null;s&&n.push(s)}if(0<n.length)for(t=0;t<h.length;++t)if(i=!1,h[t]instanceof THREE.Geometry?i=h[t].skinIndices&&0<h[t].skinIndices.length&&h[t].skinWeights&&0<h[t].skinWeights.length:h[t]instanceof THREE.BufferGeometry&&(i=h[t].attributes.skinIndex&&0<h[t].attributes.skinIndex.count&&h[t].attributes.skinWeight&&0<h[t].attributes.skinWeight.count),i)h[t].animations=n;else for(h[t].animations=[],i=0;i<a.length;++i)(s=o(a[i],f[t]))&&h[t].animations.push(s)}}(),l=0;l<h.length;++l)h[l].computeFaceNormals(),h[l].computeBoundingSphere(),m.push({geometry:h[l],type:g[l],jd_object:p[l]});return l=function(){var e,t,i=new THREE.Sphere,s=0,o=0,a=0,n=[],r=[],l=new THREE.Vector3(0,0,0),c=new THREE.Vector3(0,0,0);if(h&&h.length){for(e=0;e<h.length;++e)h[e].boundingSphere||h[e].computeBoundingSphere(),o+=h[e].boundingSphere.radius;if(0<o){for(e=0;e<h.length;++e)t=h[e],r.push(t.boundingSphere.radius),n.push(t.boundingSphere.center),c.copy(t.boundingSphere.center),c.multiplyScalar(t.boundingSphere.radius/o),l.add(c);for(e=0;e<h.length;++e)(t=l.distanceTo(n[e]))>=s&&(a=(s=t)+r[e]);i.center=l,i.radius=a}}return i}(),{nodes:u,objects:m,materials:d,jd_materials:e.materials,boundingSphere:l,createObject:function(e){if("Mesh"==m[e].type)return new THREE.Mesh(m[e].geometry,i());if("SkinnedMesh"==m[e].type){e=new THREE.SkinnedMesh(m[e].geometry,i());var t,s,o,a,n=[];for(a=0;a<u.length;a++)o=u[a],(s=new THREE.Bone).name=o.name,s.position.fromArray(o.pos),s.quaternion.fromArray(o.rotq),s.scale.fromArray(o.scl),n.push(s);for(a=0;a<u.length;a++)-1!==(o=u[a]).parent?n[o.parent].add(n[a]):t=n[a];return t&&t.updateMatrixWorld(!0),t=new THREE.Skeleton(n),e.add(t.bones[0]),e.bind(t),e}return"Line"==m[e].type?(t=m[e].jd_object.color,t=new THREE.Color(t[0]/255,t[1]/255,t[2]/255),t=new THREE.LineBasicMaterial({color:t}),new THREE.Line(m[e].geometry,t)):null}}}}},UzJb:function(e,t,i){"use strict";var s={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" rel="external nofollow" rel="external nofollow" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" rel="external nofollow" rel="external nofollow" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,i,o;t=void 0!==(e=e||{}).parent?e.parent:document.body,i=void 0!==e.id?e.id:"oldie",(o=s.getWebGLErrorMessage()).id=i,t.appendChild(o)}};t.a=s},"aG/w":function(e,t,i){"use strict";var s=i("Mqq8"),o={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticStyle:{position:"absolute",left:"0px",top:"0px",width:"100%",height:"100%"},attrs:{id:"3DView"}})},staticRenderFns:[]};var a=function(e){i("6Fgi")},n=i("VU/8")(s.a,o,!1,a,"data-v-96a333cc",null);t.a=n.exports},acqc:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNTAgNjAiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDUwIDYwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDojRkZGRkZGO30NCgkuc3Qxe2ZpbGw6bm9uZTtzdHJva2U6IzAwMDAwMDtzdHJva2UtbWl0ZXJsaW1pdDoxMDt9DQo8L3N0eWxlPg0KPGc+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjAuOCIgeTE9IjEzLjQiIHgyPSIyMi43IiB5Mj0iMTMuNCIvPg0KCTxsaW5lIGNsYXNzPSJzdDEiIHgxPSIwLjgiIHkxPSIxOCIgeDI9IjIyLjciIHkyPSIxOCIvPg0KCTxsaW5lIGNsYXNzPSJzdDEiIHgxPSIwLjgiIHkxPSIyMi41IiB4Mj0iMjIuNyIgeTI9IjIyLjUiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMC44IiB5MT0iMjcuMiIgeDI9IjIyLjciIHkyPSIyNy4yIi8+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjAuNiIgeTE9IjMxLjciIHgyPSIyMi41IiB5Mj0iMzEuNyIvPg0KCTxsaW5lIGNsYXNzPSJzdDEiIHgxPSIwLjgiIHkxPSIzNi4yIiB4Mj0iMjIuNyIgeTI9IjM2LjIiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMC44IiB5MT0iNDAuNyIgeDI9IjIyLjciIHkyPSI0MC43Ii8+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjAuOCIgeTE9IjQ1LjIiIHgyPSIyMi43IiB5Mj0iNDUuMiIvPg0KCTxsaW5lIGNsYXNzPSJzdDEiIHgxPSIwLjgiIHkxPSI0OS42IiB4Mj0iMjIuNyIgeTI9IjQ5LjYiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMC44IiB5MT0iNTQuMSIgeDI9IjIyLjciIHkyPSI1NC4xIi8+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjI3LjQiIHkxPSIxMy40IiB4Mj0iNDkuMiIgeTI9IjEzLjQiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMjcuNCIgeTE9IjE4IiB4Mj0iNDkuMiIgeTI9IjE4Ii8+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjI3LjQiIHkxPSIyMi41IiB4Mj0iNDkuMiIgeTI9IjIyLjUiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMjcuNCIgeTE9IjI3LjIiIHgyPSI0OS4yIiB5Mj0iMjcuMiIvPg0KCTxsaW5lIGNsYXNzPSJzdDEiIHgxPSIyNy42IiB5MT0iMzEuNyIgeDI9IjQ5LjQiIHkyPSIzMS43Ii8+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjI3LjQiIHkxPSIzNi4yIiB4Mj0iNDkuMiIgeTI9IjM2LjIiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMjcuNCIgeTE9IjQwLjciIHgyPSI0OS4yIiB5Mj0iNDAuNyIvPg0KCTxsaW5lIGNsYXNzPSJzdDEiIHgxPSIyNy40IiB5MT0iNDUuMiIgeDI9IjQ5LjIiIHkyPSI0NS4yIi8+DQoJPGxpbmUgY2xhc3M9InN0MSIgeDE9IjI3LjQiIHkxPSI0OS42IiB4Mj0iNDkuMiIgeTI9IjQ5LjYiLz4NCgk8bGluZSBjbGFzcz0ic3QxIiB4MT0iMjcuNCIgeTE9IjU0LjEiIHgyPSI0OS4yIiB5Mj0iNTQuMSIvPg0KCTxyZWN0IHg9IjIyLjYiIHk9IjExLjQiIGNsYXNzPSJzdDEiIHdpZHRoPSI0LjkiIGhlaWdodD0iNDUuMyIvPg0KCTxyZWN0IHg9IjIzLjkiIHk9IjEyLjYiIGNsYXNzPSJzdDEiIHdpZHRoPSIyLjEiIGhlaWdodD0iNDIuNiIvPg0KCTxwb2x5bGluZSBjbGFzcz0ic3QxIiBwb2ludHM9IjExLjcsNjAgMTEuNywyIDM4LjQsMiAzOC42LDYwIAkiLz4NCjwvZz4NCjwvc3ZnPg0K"},iPHX:function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMi4wLjEsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0i5Zu+5bGCXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMjEgMjEiIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDIxIDIxOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KCS5zdDB7ZmlsbDpub25lO3N0cm9rZTojMDAwMDAwO3N0cm9rZS1taXRlcmxpbWl0OjEwO30NCjwvc3R5bGU+DQo8cGF0aCBjbGFzcz0ic3QwIiBkPSJNMS4zLDBjMCwwLjIsMCwwLjUsMCwwLjdDMS4yLDExLjQsOS42LDIwLDIwLDIwVjAiLz4NCjwvc3ZnPg0K"},lggW:function(e,t,i){e.exports=i.p+"static/img/floor.ea78bde.png"},oM7Q:function(e,t,i){i("sF+V");var s=i("FeBl").Object;e.exports=function(e,t){return s.create(e,t)}},pRCB:function(e,t,i){var s=i("kM2E");s(s.S+s.F*!i("+E39"),"Object",{defineProperties:i("qio6")})},r4Au:function(e,t){e.exports=function(e){var t,i=function(e,t){return function(){return e.apply(t,arguments)}},s=[].slice,o={}.hasOwnProperty;function a(t,s){this.matrix=s,this.intersect=i(this.intersect,this),this.union=i(this.union,this),this.subtract=i(this.subtract,this),this.toGeometry=i(this.toGeometry,this),this.toMesh=i(this.toMesh,this),this.toTree=i(this.toTree,this),null==this.matrix&&(this.matrix=new e.Matrix4),this.tree=this.toTree(t)}return 1e-5,0,1,2,3,t=function(e,t){return t(),e},a.prototype.toTree=function(t){var i,s,o,n,r,l,c,d=this;if(t instanceof a.Node)return t;for(o=[],n=function(t,s){var n,r,l,c,u,h,f,g,p;for(null==(n=null!=(g=i.faceVertexUvs)?g[0][s]:void 0)&&(n=[new e.Vector2,new e.Vector2,new e.Vector2,new e.Vector2]),l=new a.Polygon,c=h=0,f=(p=["a","b","c","d"]).length;h<f;c=++h)null!=(r=t[p[c]])&&(u=i.vertices[r],(u=new a.Vertex(u.x,u.y,u.z,t.vertexNormals[0],new e.Vector2(n[c].x,n[c].y))).applyMatrix4(d.matrix),l.vertices.push(u));return o.push(l.calculateProperties())},s=r=0,l=(c=(i=t instanceof e.Geometry?t:t instanceof e.Mesh?(t.updateMatrix(),this.matrix=t.matrix.clone(),t.geometry):void 0).faces).length;r<l;s=++r)n(c[s],s);return new a.Node(o)},a.prototype.toMesh=function(i){var s,o,a=this;return null==i&&(i=new e.MeshNormalMaterial),s=this.toGeometry(),t(o=new e.Mesh(s,i),function(){return o.position.getPositionFromMatrix(a.matrix),o.rotation.setFromRotationMatrix(a.matrix)})},a.prototype.toGeometry=function(){var i,o,a=this;return o=(new e.Matrix4).getInverse(this.matrix),t(i=new e.Geometry,function(){var t,n,r,l,c,d,u,h,f,g,p;for(p=[],h=0,f=(g=a.tree.allPolygons()).length;h<f;h++)l=g[h],r=function(){var e,t,i,s;for(s=[],e=0,t=(i=l.vertices).length;e<t;e++)c=i[e],s.push(c.clone().applyMatrix4(o));return s}(),p.push(function(){var o,a,h;for(h=[],n=o=2,a=r.length;2<=a?o<a:o>a;n=2<=a?++o:--o)u=[r[0],r[n-1],r[n]],d=function(){var t,i,s,o,a;for(a=[],t=0,i=u.length;t<i;t++)c=u[t],a.push(new e.Vector2(null!=(s=c.uv)?s.x:void 0,null!=(o=c.uv)?o.y:void 0));return a}(),t=function(e,t,i){i.prototype=e.prototype;var s=new i,o=e.apply(s,t);return Object(o)===o?o:s}(e.Face3,s.call(function(){var e,t,s;for(s=[],e=0,t=u.length;e<t;e++)c=u[e],s.push(i.vertices.push(c)-1);return s}()).concat([l.normal.clone()]),function(){}),i.faces.push(t),h.push(i.faceVertexUvs[0].push(d));return h}());return p})},a.prototype.subtract=function(e){var t,i,s;return t=(s=[this.tree.clone(),e.tree.clone()])[1],(i=s[0]).invert().clipTo(t),t.clipTo(i).invert().clipTo(i).invert(),new a(i.build(t.allPolygons()).invert(),this.matrix)},a.prototype.union=function(e){var t,i,s;return t=(s=[this.tree.clone(),e.tree.clone()])[1],(i=s[0]).clipTo(t),t.clipTo(i).invert().clipTo(i).invert(),new a(i.build(t.allPolygons()),this.matrix)},a.prototype.intersect=function(e){var t,i,s;return i=(s=[this.tree.clone(),e.tree.clone()])[0],(t=s[1]).clipTo(i.invert()).invert().clipTo(i.clipTo(t)),new a(i.build(t.allPolygons()).invert(),this.matrix)},a.Vertex=function(n){function r(t,s,o,a,n){this.normal=null!=a?a:new e.Vector3,this.uv=null!=n?n:new e.Vector2,this.interpolate=i(this.interpolate,this),this.lerp=i(this.lerp,this),r.__super__.constructor.call(this,t,s,o)}return function(e,t){for(var i in t)o.call(t,i)&&(e[i]=t[i]);function s(){this.constructor=e}s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype}(r,e.Vector3),r.prototype.clone=function(){return new a.Vertex(this.x,this.y,this.z,this.normal.clone(),this.uv.clone())},r.prototype.lerp=function(e,i){var s=this;return t(r.__super__.lerp.apply(this,arguments),function(){return s.uv.add(e.uv.clone().sub(s.uv).multiplyScalar(i)),s.normal.lerp(e,i)})},r.prototype.interpolate=function(){var e,t;return e=1<=arguments.length?s.call(arguments,0):[],(t=this.clone()).lerp.apply(t,e)},r}(),a.Polygon=function(){function e(e,t,s){this.vertices=null!=e?e:[],this.normal=t,this.w=s,this.subdivide=i(this.subdivide,this),this.tessellate=i(this.tessellate,this),this.classifySide=i(this.classifySide,this),this.classifyVertex=i(this.classifyVertex,this),this.invert=i(this.invert,this),this.clone=i(this.clone,this),this.calculateProperties=i(this.calculateProperties,this),this.vertices.length&&this.calculateProperties()}return e.prototype.calculateProperties=function(){var e=this;return t(this,function(){var t,i,s,o;return t=(o=e.vertices)[0],i=o[1],s=o[2],e.normal=i.clone().sub(t).cross(s.clone().sub(t)).normalize(),e.w=e.normal.clone().dot(t)})},e.prototype.clone=function(){var e;return new a.Polygon(function(){var t,i,s,o;for(o=[],t=0,i=(s=this.vertices).length;t<i;t++)e=s[t],o.push(e.clone());return o}.call(this),this.normal.clone(),this.w)},e.prototype.invert=function(){var e=this;return t(this,function(){return e.normal.multiplyScalar(-1),e.w*=-1,e.vertices.reverse()})},e.prototype.classifyVertex=function(e){var t;switch(t=this.normal.dot(e)-this.w,!1){case!(t<-1e-5):return 2;case!(t>1e-5):return 1;default:return 0}},e.prototype.classifySide=function(e){var t,i,s,o,a,n,r,l=this;for(i=(n=[0,0])[0],t=n[1],s=function(e){switch(l.classifyVertex(e)){case 1:return i+=1;case 2:return t+=1}},o=0,a=(r=e.vertices).length;o<a;o++)s(r[o]);return i>0&&0===t?1:0===i&&t>0?2:i===t&&0===t?0:3},e.prototype.tessellate=function(e){var i,s,o,n,r,l,c,d,u,h,f,g,p,m,v,I;if(m={f:[],b:[],count:e.vertices.length},o=m.f,i=m.b,s=m.count,3!==this.classifySide(e))return[e];for(n=g=0,p=(v=e.vertices).length;g<p;n=++g)h=v[n],f=e.vertices[(n+1)%s],c=(I=function(){var e,t,i,s;for(s=[],e=0,t=(i=[h,f]).length;e<t;e++)u=i[e],s.push(this.classifyVertex(u));return s}.call(this))[0],d=I[1],2!==c&&o.push(h),1!==c&&i.push(h),3==(c|d)&&(l=(this.w-this.normal.dot(h))/this.normal.dot(f.clone().sub(h)),u=h.interpolate(f,l),o.push(u),i.push(u));return t(r=[],function(){if(o.length>=3&&r.push(new a.Polygon(o)),i.length>=3)return r.push(new a.Polygon(i))})},e.prototype.subdivide=function(e,t,i,s,o){var a,n,r,l,c,d;for(d=[],r=0,l=(c=this.tessellate(e)).length;r<l;r++)switch(a=c[r],n=this.classifySide(a)){case 1:d.push(s.push(a));break;case 2:d.push(o.push(a));break;case 0:this.normal.dot(a.normal)>0?d.push(t.push(a)):d.push(i.push(a));break;default:throw new Error("BUG: Polygon of classification "+n+" in subdivision")}return d},e}(),a.Node=function(){function e(e){this.clipTo=i(this.clipTo,this),this.clipPolygons=i(this.clipPolygons,this),this.invert=i(this.invert,this),this.allPolygons=i(this.allPolygons,this),this.isConvex=i(this.isConvex,this),this.build=i(this.build,this),this.clone=i(this.clone,this),this.polygons=[],null!=e&&e.length&&this.build(e)}return e.prototype.clone=function(){var e,i=this;return t(e=new a.Node,function(){var t,s,o,a;return e.divider=null!=(s=i.divider)?s.clone():void 0,e.polygons=function(){var e,i,s,o;for(o=[],e=0,i=(s=this.polygons).length;e<i;e++)t=s[e],o.push(t.clone());return o}.call(i),e.front=null!=(o=i.front)?o.clone():void 0,e.back=null!=(a=i.back)?a.clone():void 0})},e.prototype.build=function(e){var i=this;return t(this,function(){var t,s,n,r,l,c,d;for(r={front:[],back:[]},null==i.divider&&(i.divider=e[0].clone()),l=0,c=e.length;l<c;l++)t=e[l],i.divider.subdivide(t,i.polygons,i.polygons,r.front,r.back);for(n in d=[],r)o.call(r,n)&&((s=r[n]).length?(null==i[n]&&(i[n]=new a.Node),d.push(i[n].build(s))):d.push(void 0));return d})},e.prototype.isConvex=function(e){var t,i,s,o,a,n;for(s=0,a=e.length;s<a;s++)for(t=e[s],o=0,n=e.length;o<n;o++)if(t!==(i=e[o])&&2!==i.classifySide(t))return!1;return!0},e.prototype.allPolygons=function(){var e,t;return this.polygons.slice().concat((null!=(t=this.front)?t.allPolygons():void 0)||[]).concat((null!=(e=this.back)?e.allPolygons():void 0)||[])},e.prototype.invert=function(){var e=this;return t(this,function(){var t,i,s,o,a,n,r,l;for(i=0,o=(n=e.polygons).length;i<o;i++)n[i].invert();for(s=0,a=(r=[e.divider,e.front,e.back]).length;s<a;s++)null!=(t=r[s])&&t.invert();return l=[e.back,e.front],e.front=l[0],e.back=l[1],l})},e.prototype.clipPolygons=function(e){var t,i,s,o,a;if(!this.divider)return e.slice();for(i=[],t=[],o=0,a=e.length;o<a;o++)s=e[o],this.divider.subdivide(s,i,t,i,t);return this.front&&(i=this.front.clipPolygons(i)),this.back&&(t=this.back.clipPolygons(t)),i.concat(this.back?t:[])},e.prototype.clipTo=function(e){var i=this;return t(this,function(){var t,s;return i.polygons=e.clipPolygons(i.polygons),null!=(t=i.front)&&t.clipTo(e),null!=(s=i.back)?s.clipTo(e):void 0})},e}(),a}},"sF+V":function(e,t,i){var s=i("kM2E");s(s.S,"Object",{create:i("Yobk")})}});
//# sourceMappingURL=2.7e35130c9f6eab221ca9.js.map