webpackJsonp([34],{GwvJ:function(e,t,a){"use strict";(function(e){var i=a("BO1k"),r=a.n(i),s=a("fZjL"),n=a.n(s),l=a("gApy"),o=(a.n(l),a("u3Mf")),c=a("4YAr"),u=(a("yzMb"),a("uSev")),d=a("dO4M"),p=a("FAvH"),m=a("GR1E"),h=a("fYBn"),g=a("02tb"),f=a("5kkW"),v=a("3a1n");t.a={components:{singleBtnGroup:d.a,tableBtnGroup:p.a,tablePagination:m.a,tableComponent:u.a,cancelBtn:h.a,confirmBtn:g.a,searchBtn:f.a,resetBtn:v.a},data:function(){var e=this;return{PRO_TYPE:o.e,roleName:"",currentPage:1,pageSize:15,total:0,loading:null,tableHeight:0,selectData:[],tableData:[],dialogTitle:"",operateType:"add",dialogVisible:!1,unitOptions:[],menuTreeDate:[],unitTreeDate:[],selectMenuTreeDate:[],selectUnitTreeDate:[],treeShow:!1,Form:{roleId:"",roleName:"",isFreeze:0,isSubscibe:1,roleBanner:0,menuId:[],unitId:[]},props:{label:"menuTitle",children:"children"},unitProps:{children:"childrens",label:"unitName"},bannner_1:""+o.a+o.f+"/images/inside.png",bannner_2:""+o.a+o.f+"/images/without.png",bannnerDetail:"",rules:{roleName:[{required:!0,validator:function(t,a,i){""===a||null===a?i(new Error("角色名称不能为空")):Object(c.B)(e.Form.roleName,e.Form.roleId).then(function(e){i()}).catch(function(e){i(new Error("角色名称不能重复"))})},trigger:"blur"}],isFreeze:[{required:!0,message:"请选择是否冻结",trigger:"change"}],unitId:[{required:!0,message:"所属单位不能为空",trigger:"blur"}],menuId:[{required:!0,message:"菜单不能为空",trigger:"blur"}]}}},methods:{loadingStart:function(e){this.loading||(this.loading=this.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",target:e,customClass:"loading-box"}))},loadingEnd:function(){this.loading&&(this.loading.close(),this.loading=null)},changeSize:function(e){this.pageSize=e,this.getList()},changePage:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this;this.loadingStart(".table-box"),Object(c.v)(this.currentPage,this.pageSize,this.roleName).then(function(t){e.tableData=t.records,e.total=t.total,e.tableData.forEach(function(e,t){e.serialNum=t+1,0===e.isFreeze?e.FreezeStatus="非冻结":e.FreezeStatus="冻结"}),e.loadingEnd()}).catch(function(t){var a=t.result?t.result:"角色信息获取失败";e.$message({message:a,type:"error"})})},search:function(){this.currentPage=1,this.getList()},reset:function(){this.currentPage=1,this.roleName="",this.search()},add:function(){this.dialogVisible=!0,this.dialogTitle="新增角色信息",this.operateType="add",this.treeShow=!0},singleDetle:function(e){var t=this;this.$confirm("此操作将永久删除角色"+e.roleName+", 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(c.i)(parseInt(e.roleId)).then(function(e){t.$message({message:"删除角色信息成功!",type:"success"}),t.currentPage=1,t.getList()}).catch(function(e){var a=e.result?e.result:"删除角色信息失败!";t.$message({message:a,type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},singleUpdate:function(e){var t=this;this.dialogVisible=!0,this.dialogTitle="修改角色信息",this.operateType="edit",this.treeShow=!0,this.loadingStart(".el-dialog"),Object(c.l)(e.roleId).then(function(a){t.Form.roleBanner=a.roleBanner,t.Form.isFreeze=a.isFreeze,t.Form.roleId=a.roleId,t.Form.roleName=a.roleName,t.selectMenuTreeDate=a.menuDetail,t.selectUnitTreeDate=a.unitList,a.menuDetail&&a.menuDetail.length>0&&a.menuDetail.forEach(function(e){t.Form.menuId.push(e.menuId)}),a.unitList&&a.unitList.length>0&&a.unitList.forEach(function(e){t.Form.unitId.push(e.unitId)}),t.$refs.unitTree.setCheckedKeys(t.Form.unitId),Object(c.m)(e.roleId).then(function(e){var a=[];e.menuDetail&&e.menuDetail.length>0&&(e.menuDetail.forEach(function(e){a.push(e.menuId)}),t.$refs.menuTree.setCheckedKeys(a)),t.loadingEnd()}).catch(function(e){var a=e.result?e.result:"角色菜单信息获取失败";t.$message({message:a,type:"error"})})}).catch(function(e){var a=e.result?e.result:"角色信息获取失败";t.$message({message:a,type:"error"})})},singleDetail:function(e){var t=this;this.dialogVisible=!0,this.dialogTitle="角色详情",this.operateType="detail",Object(c.l)(e.roleId).then(function(e){t.Form.isFreeze=e.isFreeze,t.Form.roleId=e.roleId,t.Form.roleName=e.roleName,t.selectMenuTreeDate=e.menuDetail,t.selectUnitTreeDate=e.unitList,0===e.roleBanner?t.bannnerDetail=t.bannner_1:t.bannnerDetail=t.bannner_2}).catch(function(e){var a=e.result?e.result:"角色详情获取失败";t.$message({message:a,type:"error"})})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;"add"===t.operateType?Object(c.c)(t.Form).then(function(e){t.$message({message:"新增角色信息成功",type:"success"}),t.dialogVisible=!1,t.getList()}).catch(function(e){var a=e.result?e.result:"新增角色信息失败";t.$message({message:a,type:"error"})}):Object(c.H)(t.Form).then(function(e){t.$message({message:"修改角色信息成功",type:"success"}),t.dialogVisible=!1,t.getList()}).catch(function(e){var a=e.result?e.result:"修改角色信息失败";t.$message({message:a,type:"error"})})})},clearForm:function(e){for(var t in e){var a=this.getDataType(e[t]);if("String"===a)e[t]="";else if("Array"===a)e[t]=[];else if("Object"===a){n()(e[t]).length>0?this.clearForm(e[t]):e[t]={}}else e[t]=null}},dialogOpen:function(){var e=this;this.$nextTick(function(){e.$refs.Form.clearValidate()})},dialogClosed:function(){this.clearForm(this.Form),this.selectMenuTreeDate=[],this.selectUnitTreeDate=[],this.treeShow=!1,this.Form.isFreeze=0,this.Form.isSubscibe=1,this.bannnerDetail=""},getDataType:function(e){var t=!0,a=!1,i=void 0;try{for(var s,n=r()(["String","Object","Number","Array","Function"]);!(t=(s=n.next()).done);t=!0){var l=s.value;if(Object.prototype.toString.call(e)==="[object "+l+"]")return l}}catch(e){a=!0,i=e}finally{try{!t&&n.return&&n.return()}finally{if(a)throw i}}},getCheckedKeys:function(e){var t=this;if("menu"===e){this.Form.menuId=[],this.selectMenuTreeDate=[];var a=this.$refs.menuTree.getCheckedKeys(),i=this.$refs.menuTree.getHalfCheckedKeys();this.Form.menuId=i.concat(a);var r=this.$refs.menuTree.getCheckedNodes(),s=this.$refs.menuTree.getHalfCheckedNodes();this.selectMenuTreeDate=s.concat(r)}else{this.Form.unitId=[],this.selectUnitTreeDate=[],this.$refs.unitTree.getCheckedNodes().forEach(function(e){1!==e.unitClassify&&2!==e.unitClassify||(t.Form.unitId.push(e.unitId),t.selectUnitTreeDate.push(e))})}},getMenuTree:function(){var e=this;Object(c.s)().then(function(t){e.menuTreeDate=t}).catch(function(t){var a=t.result?t.result:"获取菜单信息失败";e.$message({message:a,type:"error"})})},getUnitTree:function(){var e=this;Object(c.p)().then(function(t){e.unitTreeDate=t}).catch(function(t){var a=t.result?t.result:"单位信息获取失败";e.$message({message:a,type:"error"})})}},mounted:function(){var t=this;this.getList(),this.getMenuTree(),this.getUnitTree(),setTimeout(function(){var a=e("#mainDiv").height(),i=e("#queryBox").outerHeight(!0),r=e("#operateBox").height();t.tableHeight=a-i-r},1)}}}).call(t,a("7t+N"))},PvY1:function(e,t){},zOPq:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("GwvJ"),r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"role"}},[a("div",{staticClass:"query-box",attrs:{id:"queryBox"}},[a("div",{staticClass:"clearfix"},[a("div",{staticClass:"query-item"},[a("div",{staticClass:"query-title"},[e._v("角色名称：")]),e._v(" "),a("div",{staticClass:"query-input"},[a("el-input",{attrs:{placeholder:"请输入角色名称"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}})],1)]),e._v(" "),a("div",{staticClass:"query-btn"},[a("search-btn",{on:{clickBtn:e.search}}),e._v(" "),a("reset-btn",{on:{clickBtn:e.reset}})],1)])]),e._v(" "),a("div",{staticClass:"table-box"},[a("table-component",{attrs:{tableData:e.tableData,tableHeight:e.tableHeight}},[a("el-table-column",{attrs:{prop:"serialNum",label:"序号",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",label:"角色名称",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"FreezeStatus",label:"是否冻结",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"190",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("single-btn-group",{attrs:{isShowDetail:!0},on:{deleteClick:function(a){e.singleDetle(t.row)},updateClick:function(a){e.singleUpdate(t.row)},detailClick:function(a){e.singleDetail(t.row)}}})]}}])})],1),e._v(" "),a("div",{staticClass:"table-operate-box",attrs:{id:"operateBox"}},[a("div",{staticClass:"operate-btn"},[a("table-btn-group",{attrs:{batchDelBtnShow:!1},on:{addClick:e.add}})],1),e._v(" "),a("div",{staticClass:"operate-pager"},[a("table-pagination",{attrs:{currentPage:e.currentPage,pageSize:e.pageSize,total:e.total},on:{"size-change":e.changeSize,"page-change":e.changePage}})],1)])],1),e._v(" "),a("el-dialog",{attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,width:"780px",center:!0},on:{"update:visible":function(t){e.dialogVisible=t},open:e.dialogOpen,closed:e.dialogClosed}},[a("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[a("span",[e._v(e._s(e.dialogTitle))])]),e._v(" "),a("el-form",{ref:"Form",attrs:{inline:!0,model:e.Form,rules:e.rules}},[a("el-form-item",{class:{"detail-form-item":"detail"===e.operateType},attrs:{label:"detail"===e.operateType?"角色名称:":"角色名称","label-width":"120px",prop:"roleName"}},[a("el-input",{attrs:{placeholder:"请输入角色名称",readonly:"detail"===e.operateType},model:{value:e.Form.roleName,callback:function(t){e.$set(e.Form,"roleName",t)},expression:"Form.roleName"}})],1),e._v(" "),a("el-form-item",{staticClass:"freeze-box",attrs:{label:"detail"===e.operateType?"是否冻结:":"是否冻结","label-width":"120px",prop:"isFreeze"}},[a("el-radio",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],attrs:{label:1,name:"isFreeze"},model:{value:e.Form.isFreeze,callback:function(t){e.$set(e.Form,"isFreeze",t)},expression:"Form.isFreeze"}},[e._v("是")]),e._v(" "),a("el-radio",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],attrs:{label:0,name:"isFreeze"},model:{value:e.Form.isFreeze,callback:function(t){e.$set(e.Form,"isFreeze",t)},expression:"Form.isFreeze"}},[e._v("否")]),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:"detail"===e.operateType,expression:"operateType==='detail'"}]},[e._v(e._s(1===e.Form.isFreeze?"冻结":"非冻结"))])],1),e._v(" "),a("el-form-item",{class:{"detail-form-item":"detail"===e.operateType},attrs:{label:"detail"===e.operateType?"已选单位:":"选择单位","label-width":"120px",prop:"unitIdList"}},[a("div",{staticClass:"menuTransfer clearfix"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],staticClass:"transfer-panel",staticStyle:{"margin-right":"20px"}},[a("div",{staticClass:"transfer-panel-header"},[e._v("全部单位")]),e._v(" "),a("div",{staticClass:"transfer-panel-body"},[e.treeShow?a("el-tree",{ref:"unitTree",attrs:{props:e.unitProps,"show-checkbox":"",data:e.unitTreeDate,"node-key":"unitId"}}):e._e()],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],staticStyle:{"padding-top":"100px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right",circle:""},on:{click:function(t){e.getCheckedKeys("unit")}}})],1),e._v(" "),a("div",{staticClass:"transfer-panel",staticStyle:{"margin-left":"20px"}},[a("div",{staticClass:"transfer-panel-header"},[e._v("已选单位")]),e._v(" "),a("div",{staticClass:"transfer-panel-body"},[a("ul",{staticClass:"selected-menu"},e._l(e.selectUnitTreeDate,function(t){return a("li",{key:t.unitId},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.unitName,placement:"top"}},[a("span",[e._v(e._s(t.unitName))])])],1)}))])])])]),e._v(" "),a("el-form-item",{class:{"detail-form-item":"detail"===e.operateType},attrs:{label:"detail"===e.operateType?"已选菜单:":"选择菜单","label-width":"120px",prop:"menuIdList"}},[a("div",{staticClass:"menuTransfer clearfix"},[a("div",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],staticClass:"transfer-panel",staticStyle:{"margin-right":"20px"}},[a("div",{staticClass:"transfer-panel-header"},[e._v("全部菜单")]),e._v(" "),a("div",{staticClass:"transfer-panel-body"},[e.treeShow?a("el-tree",{ref:"menuTree",attrs:{props:e.props,"show-checkbox":"",data:e.menuTreeDate,"node-key":"menuId"}}):e._e()],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],staticStyle:{"padding-top":"100px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right",circle:""},on:{click:function(t){e.getCheckedKeys("menu")}}})],1),e._v(" "),a("div",{staticClass:"transfer-panel",staticStyle:{"margin-left":"20px"}},[a("div",{staticClass:"transfer-panel-header"},[e._v("已选菜单")]),e._v(" "),a("div",{staticClass:"transfer-panel-body"},[a("ul",{staticClass:"selected-menu"},e._l(e.selectMenuTreeDate,function(t){return a("li",{key:t.menuId},[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.menuTitle,placement:"top"}},[a("span",[e._v(e._s(t.menuTitle))])])],1)}))])])])]),e._v(" "),"yc"===e.PRO_TYPE?a("el-form-item",{style:"detail"===e.operateType?"display:block":"display:inline-block",attrs:{label:"detail"===e.operateType?"已选标题:":"选择标题","label-width":"120px",prop:"titroleBannerle"}},[a("el-radio-group",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],model:{value:e.Form.roleBanner,callback:function(t){e.$set(e.Form,"roleBanner",t)},expression:"Form.roleBanner"}},[a("div",{staticClass:"title-item"},[a("el-radio",{attrs:{label:0}},[a("img",{attrs:{src:e.bannner_1,alt:"title-banner"}})])],1),e._v(" "),a("div",{staticClass:"title-item"},[a("el-radio",{attrs:{label:1}},[a("img",{attrs:{src:e.bannner_2,alt:"title-banner"}})])],1)]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:"detail"===e.operateType,expression:"operateType==='detail'"}],staticClass:"bannner-detail"},[a("img",{attrs:{src:e.bannnerDetail,alt:"title-banner"}})])],1):e._e()],1),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("cancel-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.dialogVisible=!1}}}),e._v(" "),a("confirm-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.submitForm("Form")}}})],1)],1)],1)},staticRenderFns:[]};var s=function(e){a("PvY1")},n=a("VU/8")(i.a,r,!1,s,null,null);t.default=n.exports}});
//# sourceMappingURL=34.616bc2bd769626fdd747.js.map