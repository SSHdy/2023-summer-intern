webpackJsonp([54],{RiKm:function(e,t){},dXms:function(e,t,i){"use strict";(function(e){var a=i("BO1k"),n=i.n(a),l=i("Yhen"),r=i("Oizb"),s=(i("yzMb"),i("uSev")),o=i("dO4M"),m=i("FAvH"),u=i("GR1E"),c=i("fYBn"),p=i("02tb");t.a={components:{singleBtnGroup:o.a,tableBtnGroup:m.a,tablePagination:u.a,tableComponent:s.a,cancelBtn:c.a,confirmBtn:p.a},data:function(){return{name:"",type:"",currentPage:1,pageSize:15,total:0,loading:null,tableHeight:0,selectData:[],tableData:[],dialogTitle:"",operateType:"add",yardOptions:[],buildOptions:[],Form:{buildIdList:[],equipmentBrand:"",equipmentCharge:"",equipmentCode:"",equipmentContact:"",equipmentId:null,equipmentName:"",equipmentNum:null,equipmentRemark:"",equipmentTime:null,equipmentType:"",yardId:null,idList:[]},dialogVisible:!1,rules:{equipmentName:[{required:!0,message:"设备名称不能为空",trigger:"blur"}],equipmentNum:[{required:!0,message:"设备数量不能为空",trigger:"blur"}],equipmentCharge:[{required:!0,message:"负责人不能为空",trigger:"blur"}],equipmentContact:[{required:!0,message:"联系方式不能为空",trigger:"blur"}],yardId:[{required:!0,message:"设备所属院落不能为空",trigger:"change"}],buildIdList:[{required:!0,message:"设备所属楼座不能为空",trigger:"change"}]}}},methods:{loadingStart:function(e){this.loading||(this.loading=this.$loading({lock:!0,text:"正在加载...",spinner:"el-icon-loading",target:e,customClass:"loading-box"}))},loadingEnd:function(){this.loading&&(this.loading.close(),this.loading=null)},changeSize:function(e){this.pageSize=e,this.getList()},changePage:function(e){this.currentPage=e,this.getList()},getList:function(){var e=this;this.loadingStart(".table-box"),Object(l.k)(this.currentPage,this.pageSize).then(function(t){e.loadingEnd(),e.tableData=t.records,e.total=t.total}).catch(function(t){e.loadingEnd();var i=t.result?t.result:"设备信息列表获取失败";e.$message({message:i,type:"error"})})},addDevice:function(){this.dialogTitle="新增设备",this.operateType="add",this.dialogVisible=!0,this.getYardList()},singleDetle:function(e){var t=this;this.$confirm("此操作将永久删除类别为"+e.equipmentName+"的设备, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l.f)(parseInt(e.equipmentId)).then(function(e){t.$message({message:"删除设备信息成功!",type:"success"}),t.currentPage=1,t.getList()}).catch(function(e){var i=e.result?e.result:"删除设备信息失败";t.$message({message:i,type:"error"})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},batchDelete:function(){var e=this,t=[];this.selectData.forEach(function(e,i){t.push(e.equipmentId)}),this.$confirm("此操作将永久删除这些设备信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){if(0===t.length)return e.$message({message:"请先勾选删除项！",type:"warning"}),!1;Object(l.e)(t).then(function(t){e.$message({message:"批量删除设备信息成功!",type:"success"}),e.currentPage=1,e.getList()}).catch(function(t){var i=t.result?t.result:"批量删除设备信息失败";e.$message({message:i,type:"error"})})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},singleUpdate:function(e){var t=this;this.dialogTitle="修改设备",this.operateType="edit",this.dialogVisible=!0,this.getYardList(),Object(l.j)(e.equipmentId).then(function(e){for(var i in t.Form)t.Form[i]=e[i]?e[i]:"";t.Form.yardId&&t.yardSelectChangeHandle(t.Form.yardId,!0)}).catch(function(e){var i=e.result?e.result:"设备详情获取失败";t.$message({message:i,type:"error"})})},handleSelectionChange:function(e){this.selectData=e},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.operateType;"add"===t.operateType?Object(l.b)(t.Form).then(function(e){t.$message({message:"新增设备成功",type:"success"}),t.dialogVisible=!1,t.getList()}).catch(function(e){var i=e.result?e.result:"新增设备失败";t.$message({message:i,type:"error"})}):"edit"===t.operateType&&Object(l.s)(t.Form).then(function(e){t.$message({message:"修改设备成功",type:"success"}),t.dialogVisible=!1,t.getList()}).catch(function(e){var i=e.result?e.result:"修改设备失败";t.$message({message:i,type:"error"})})})},cancel:function(){this.dialogVisible=!1},dialogOpen:function(){var e=this;this.$nextTick(function(){e.$refs.Form.clearValidate()})},dialogClosed:function(){for(var e in this.Form){var t=this.getDataType(this.Form[e]);this.Form[e]="String"===t?"":"Array"===t?[]:"Object"===t?{}:null}this.yardOptions=[],this.buildOptions=[]},getYardList:function(){var e=this;Object(r.d)(1).then(function(t){e.yardOptions=t}).catch(function(t){var i=t.result?t.result:"院落下拉选项获取失败";e.$message({message:i,type:"error"})})},yardSelectChangeHandle:function(e,t){var i=this;t&&void 0!==t||(this.Form.buildIdList=[]),Object(r.j)(e).then(function(e){i.buildOptions=e}).catch(function(e){var t=e.result?e.result:"楼座下拉选项获取失败";i.$message({message:t,type:"error"})})},limitInt:function(e){this.Form[e]=this.Form[e].replace(/[^0-9]/g,"")},getDataType:function(e){var t=!0,i=!1,a=void 0;try{for(var l,r=n()(["String","Object","Number","Array","Date"]);!(t=(l=r.next()).done);t=!0){var s=l.value;if(Object.prototype.toString.call(e)==="[object "+s+"]")return s}}catch(e){i=!0,a=e}finally{try{!t&&r.return&&r.return()}finally{if(i)throw a}}}},mounted:function(){var t=this;this.getList(),setTimeout(function(){var i=e("#mainDiv").height(),a=e("#operateBox").height();t.tableHeight=i-a},100)}}}).call(t,i("7t+N"))},mDuL:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("dXms"),n={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"assetDevice"}},[i("div",{staticClass:"table-box"},[i("tableComponent",{attrs:{tableData:e.tableData,tableHeight:e.tableHeight},on:{select:e.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"50",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"equipmentName",label:"类别",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"equipmentNum",label:"数量",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"equipmentCharge",label:"负责人",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{prop:"equipmentContact",label:"负责人联系方式",align:"center"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作",width:"140",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("single-btn-group",{attrs:{isShowDetail:!1},on:{deleteClick:function(i){e.singleDetle(t.row)},updateClick:function(i){e.singleUpdate(t.row)}}})]}}])})],1),e._v(" "),i("div",{staticClass:"table-operate-box",attrs:{id:"operateBox"}},[i("div",{staticClass:"operate-btn"},[i("table-btn-group",{on:{batchDeleteClick:e.batchDelete,addClick:e.addDevice}})],1),e._v(" "),i("div",{staticClass:"operate-pager"},[i("table-pagination",{attrs:{currentPage:e.currentPage,pageSize:e.pageSize,total:e.total},on:{"size-change":e.changeSize,"page-change":e.changePage}})],1)])],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogVisible,"close-on-click-modal":!1,width:"780px",center:!0},on:{"update:visible":function(t){e.dialogVisible=t},open:e.dialogOpen,closed:e.dialogClosed}},[i("div",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[i("span",[e._v(e._s(e.dialogTitle))])]),e._v(" "),i("el-form",{ref:"Form",attrs:{inline:!0,model:e.Form,rules:e.rules}},[i("el-form-item",{attrs:{label:"设备名称","label-width":"130px",prop:"equipmentName"}},[i("el-input",{attrs:{size:"small"},model:{value:e.Form.equipmentName,callback:function(t){e.$set(e.Form,"equipmentName","string"==typeof t?t.trim():t)},expression:"Form.equipmentName"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备数量","label-width":"130px",prop:"equipmentNum"}},[i("el-input",{attrs:{size:"small"},nativeOn:{keyup:function(t){e.limitInt("equipmentNum")}},model:{value:e.Form.equipmentNum,callback:function(t){e.$set(e.Form,"equipmentNum","string"==typeof t?t.trim():t)},expression:"Form.equipmentNum"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"负责人","label-width":"130px",prop:"equipmentCharge"}},[i("el-input",{attrs:{size:"small"},model:{value:e.Form.equipmentCharge,callback:function(t){e.$set(e.Form,"equipmentCharge","string"==typeof t?t.trim():t)},expression:"Form.equipmentCharge"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"负责人联系方式","label-width":"130px",prop:"equipmentContact"}},[i("el-input",{attrs:{size:"small"},model:{value:e.Form.equipmentContact,callback:function(t){e.$set(e.Form,"equipmentContact","string"==typeof t?t.trim():t)},expression:"Form.equipmentContact"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备购入时间","label-width":"130px",prop:"equipmentTime"}},[i("el-date-picker",{staticStyle:{width:"200px"},attrs:{type:"date",placeholder:"选择设备购入时间",size:"small","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.Form.equipmentTime,callback:function(t){e.$set(e.Form,"equipmentTime",t)},expression:"Form.equipmentTime"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备唯一编号","label-width":"130px",prop:"equipmentCode"}},[i("el-input",{attrs:{size:"small"},model:{value:e.Form.equipmentCode,callback:function(t){e.$set(e.Form,"equipmentCode","string"==typeof t?t.trim():t)},expression:"Form.equipmentCode"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备型号","label-width":"130px",prop:"equipmentType"}},[i("el-input",{attrs:{size:"small"},model:{value:e.Form.equipmentType,callback:function(t){e.$set(e.Form,"equipmentType","string"==typeof t?t.trim():t)},expression:"Form.equipmentType"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"设备品牌","label-width":"130px",prop:"equipmentBrand"}},[i("el-input",{attrs:{size:"small"},model:{value:e.Form.equipmentBrand,callback:function(t){e.$set(e.Form,"equipmentBrand","string"==typeof t?t.trim():t)},expression:"Form.equipmentBrand"}})],1),e._v(" "),i("el-form-item",{staticClass:"select-item",attrs:{label:"设备所属院落","label-width":"130px",prop:"yardId"}},[i("el-select",{attrs:{placeholder:"请选择设备所属院落"},on:{change:e.yardSelectChangeHandle},model:{value:e.Form.yardId,callback:function(t){e.$set(e.Form,"yardId",t)},expression:"Form.yardId"}},e._l(e.yardOptions,function(e){return i("el-option",{key:e.yardId,attrs:{label:e.yardName,value:e.yardId}})}))],1),e._v(" "),i("el-form-item",{staticClass:"select-item",attrs:{label:"设备所属楼座","label-width":"130px",prop:"buildIdList"}},[i("el-select",{attrs:{multiple:"",placeholder:"请选择设备所属楼座",disabled:!e.Form.yardId,"no-data-text":"该院落下暂无楼座"},model:{value:e.Form.buildIdList,callback:function(t){e.$set(e.Form,"buildIdList",t)},expression:"Form.buildIdList"}},e._l(e.buildOptions,function(e){return i("el-option",{key:e.buildId,attrs:{label:e.buildName,value:e.buildId}})}))],1),e._v(" "),i("el-form-item",{attrs:{label:"备注","label-width":"130px",prop:"equipmentRemark"}},[i("el-input",{staticStyle:{width:"544px"},attrs:{size:"small",type:"textarea"},model:{value:e.Form.equipmentRemark,callback:function(t){e.$set(e.Form,"equipmentRemark","string"==typeof t?t.trim():t)},expression:"Form.equipmentRemark"}})],1)],1),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:!("detail"===e.operateType),expression:"!(operateType==='detail')"}],staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("cancel-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.dialogVisible=!1}}}),e._v(" "),i("confirm-btn",{attrs:{fontSize:14},on:{clickBtn:function(t){e.submitForm("Form")}}})],1)],1)],1)},staticRenderFns:[]};var l=function(e){i("RiKm")},r=i("VU/8")(a.a,n,!1,l,null,null);t.default=r.exports}});
//# sourceMappingURL=54.7e525e743a90cc0408ab.js.map